<div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a

        href="https://github.com/putaoshu/jdf"

    >jdf (v2.1.40)</a>
</h1>
<h4>京东前端开发集成解决方案</h4>
<div class="apidocSectionDiv"><a
    href="#apidoc.tableOfContents"
    id="apidoc.tableOfContents"
><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.jdf">module jdf</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.init">
            function <span class="apidocSignatureSpan">jdf.</span>init
            <span class="apidocSignatureSpan">(argv)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan"></span>jdf</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">jdf.</span>base</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">jdf.</span>base64</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">jdf.</span>buildByAutoprefixer</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">jdf.</span>buildCss</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">jdf.</span>buildJs</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">jdf.</span>buildWidget</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">jdf.</span>compress</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">jdf.</span>compressScheduler</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">jdf.</span>concat</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">jdf.</span>cssSprite</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">jdf.</span>csslint</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">jdf.</span>file</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">jdf.</span>fileFormat</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">jdf.</span>fileLint</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">jdf.</span>ftp</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">jdf.</span>ftpUpload</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">jdf.</span>livereloadServer</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">jdf.</span>openurl</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">jdf.</span>output</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">jdf.</span>server</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">jdf.</span>vm</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">jdf.</span>widget</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.jdf.base">module jdf.base</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.base.arrayMax">
            function <span class="apidocSignatureSpan">jdf.base.</span>arrayMax
            <span class="apidocSignatureSpan">(arr)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.base.excludeFiles">
            function <span class="apidocSignatureSpan">jdf.base.</span>excludeFiles
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.base.getCssExtname">
            function <span class="apidocSignatureSpan">jdf.base.</span>getCssExtname
            <span class="apidocSignatureSpan">(filename)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.base.getDay">
            function <span class="apidocSignatureSpan">jdf.base.</span>getDay
            <span class="apidocSignatureSpan">(separator)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.base.getJsExtname">
            function <span class="apidocSignatureSpan">jdf.base.</span>getJsExtname
            <span class="apidocSignatureSpan">(filename)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.base.getTime">
            function <span class="apidocSignatureSpan">jdf.base.</span>getTime
            <span class="apidocSignatureSpan">(separator, hasMs)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.base.getTimestamp">
            function <span class="apidocSignatureSpan">jdf.base.</span>getTimestamp
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.base.getUrlParam">
            function <span class="apidocSignatureSpan">jdf.base.</span>getUrlParam
            <span class="apidocSignatureSpan">(url)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.base.getVar">
            function <span class="apidocSignatureSpan">jdf.base.</span>getVar
            <span class="apidocSignatureSpan">(t)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.base.httpget">
            function <span class="apidocSignatureSpan">jdf.base.</span>httpget
            <span class="apidocSignatureSpan">(url, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.base.imageFileType">
            function <span class="apidocSignatureSpan">jdf.base.</span>imageFileType
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.base.inArray">
            function <span class="apidocSignatureSpan">jdf.base.</span>inArray
            <span class="apidocSignatureSpan">(arr, str, include)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.base.isArray">
            function <span class="apidocSignatureSpan">jdf.base.</span>isArray
            <span class="apidocSignatureSpan">(obj)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.base.md5">
            function <span class="apidocSignatureSpan">jdf.base.</span>md5
            <span class="apidocSignatureSpan">(str)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.base.merageObj">
            function <span class="apidocSignatureSpan">jdf.base.</span>merageObj
            <span class="apidocSignatureSpan">(obj1, obj2)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.base.replaceSlash">
            function <span class="apidocSignatureSpan">jdf.base.</span>replaceSlash
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.base.trim">
            function <span class="apidocSignatureSpan">jdf.base.</span>trim
            <span class="apidocSignatureSpan">(str)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.base.uniq">
            function <span class="apidocSignatureSpan">jdf.base.</span>uniq
            <span class="apidocSignatureSpan">(arr)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">jdf.base.</span>is</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">jdf.base.</span>placeholder</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">jdf.base.</span>reg</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.jdf.base64">module jdf.base64</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.base64.init">
            function <span class="apidocSignatureSpan">jdf.base64.</span>init
            <span class="apidocSignatureSpan">(source)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.jdf.buildByAutoprefixer">module jdf.buildByAutoprefixer</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.buildByAutoprefixer.init">
            function <span class="apidocSignatureSpan">jdf.buildByAutoprefixer.</span>init
            <span class="apidocSignatureSpan">(file, options)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.jdf.buildCss">module jdf.buildCss</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.buildCss.init">
            function <span class="apidocSignatureSpan">jdf.buildCss.</span>init
            <span class="apidocSignatureSpan">(rSource, target)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.jdf.buildJs">module jdf.buildJs</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.buildJs.init">
            function <span class="apidocSignatureSpan">jdf.buildJs.</span>init
            <span class="apidocSignatureSpan">(src, dist)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.jdf.buildWidget">module jdf.buildWidget</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.buildWidget.init">
            function <span class="apidocSignatureSpan">jdf.buildWidget.</span>init
            <span class="apidocSignatureSpan">(inputPath, content, type, callback, param)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.buildWidget.insertJs">
            function <span class="apidocSignatureSpan">jdf.buildWidget.</span>insertJs
            <span class="apidocSignatureSpan">(content, jsLink, jsPlace)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.jdf.compress">module jdf.compress</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.compress.addJsDepends">
            function <span class="apidocSignatureSpan">jdf.compress.</span>addJsDepends
            <span class="apidocSignatureSpan">(source)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.compress.appendWebpCSSFIX">
            function <span class="apidocSignatureSpan">jdf.compress.</span>appendWebpCSSFIX
            <span class="apidocSignatureSpan">(source)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.compress.css">
            function <span class="apidocSignatureSpan">jdf.compress.</span>css
            <span class="apidocSignatureSpan">(source, isdebug)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.compress.css2">
            function <span class="apidocSignatureSpan">jdf.compress.</span>css2
            <span class="apidocSignatureSpan">(source, isdebug)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.compress.cssImagesUrlReplace">
            function <span class="apidocSignatureSpan">jdf.compress.</span>cssImagesUrlReplace
            <span class="apidocSignatureSpan">(source, str, cdn, prefix, suffix)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.compress.dir">
            function <span class="apidocSignatureSpan">jdf.compress.</span>dir
            <span class="apidocSignatureSpan">(src, dest)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.compress.html">
            function <span class="apidocSignatureSpan">jdf.compress.</span>html
            <span class="apidocSignatureSpan">(sourceCode)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.compress.imagesSuffix">
            function <span class="apidocSignatureSpan">jdf.compress.</span>imagesSuffix
            <span class="apidocSignatureSpan">(source, str)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.compress.init">
            function <span class="apidocSignatureSpan">jdf.compress.</span>init
            <span class="apidocSignatureSpan">(rSource, isdebug, config, getProject, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.compress.js">
            function <span class="apidocSignatureSpan">jdf.compress.</span>js
            <span class="apidocSignatureSpan">(source, isdebug)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.compress.png">
            function <span class="apidocSignatureSpan">jdf.compress.</span>png
            <span class="apidocSignatureSpan">(source, target, haslog)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.compress.setPrefixBanner">
            function <span class="apidocSignatureSpan">jdf.compress.</span>setPrefixBanner
            <span class="apidocSignatureSpan">(bannerType, source, result)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.compress.webp">
            function <span class="apidocSignatureSpan">jdf.compress.</span>webp
            <span class="apidocSignatureSpan">(source, target, quant, callback, haslog)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.jdf.compressScheduler">module jdf.compressScheduler</a><ol>

        <li>

            <span class="apidocSignatureSpan">boolean <span class="apidocSignatureSpan">jdf.compressScheduler.</span>isdebug</span>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.compressScheduler.init">
            function <span class="apidocSignatureSpan">jdf.compressScheduler.</span>init
            <span class="apidocSignatureSpan">(outputdirName, isdebug, callBack)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.jdf.concat">module jdf.concat</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.concat.init">
            function <span class="apidocSignatureSpan">jdf.concat.</span>init
            <span class="apidocSignatureSpan">(rSource)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.jdf.cssSprite">module jdf.cssSprite</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.cssSprite.init">
            function <span class="apidocSignatureSpan">jdf.cssSprite.</span>init
            <span class="apidocSignatureSpan">(source)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.cssSprite.overall">
            function <span class="apidocSignatureSpan">jdf.cssSprite.</span>overall
            <span class="apidocSignatureSpan">(source)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.cssSprite.scatter">
            function <span class="apidocSignatureSpan">jdf.cssSprite.</span>scatter
            <span class="apidocSignatureSpan">(source, content, sourceOrigin)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.jdf.csslint">module jdf.csslint</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.csslint.init">
            function <span class="apidocSignatureSpan">jdf.csslint.</span>init
            <span class="apidocSignatureSpan">(filename, fileContent)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.jdf.file">module jdf.file</a><ol>

        <li>

            <span class="apidocSignatureSpan">boolean <span class="apidocSignatureSpan">jdf.file.</span>isWin</span>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.file.base64Encode">
            function <span class="apidocSignatureSpan">jdf.file.</span>base64Encode
            <span class="apidocSignatureSpan">(file)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.file.copy">
            function <span class="apidocSignatureSpan">jdf.file.</span>copy
            <span class="apidocSignatureSpan">(source, target, include, exclude, uncover, move , logTag, encoding)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.file.copyBinary">
            function <span class="apidocSignatureSpan">jdf.file.</span>copyBinary
            <span class="apidocSignatureSpan">(srcFile, destFile)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.file.currentDir">
            function <span class="apidocSignatureSpan">jdf.file.</span>currentDir
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.file.del">
            function <span class="apidocSignatureSpan">jdf.file.</span>del
            <span class="apidocSignatureSpan">(source, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.file.delAsync">
            function <span class="apidocSignatureSpan">jdf.file.</span>delAsync
            <span class="apidocSignatureSpan">(target)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.file.download">
            function <span class="apidocSignatureSpan">jdf.file.</span>download
            <span class="apidocSignatureSpan">(source, target, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.file.excludeFiles">
            function <span class="apidocSignatureSpan">jdf.file.</span>excludeFiles
            <span class="apidocSignatureSpan">(filename)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.file.exists">
            function <span class="apidocSignatureSpan">jdf.file.</span>exists
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.file.filter">
            function <span class="apidocSignatureSpan">jdf.file.</span>filter
            <span class="apidocSignatureSpan">(source, include, exclude)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.file.getdirlist">
            function <span class="apidocSignatureSpan">jdf.file.</span>getdirlist
            <span class="apidocSignatureSpan">(source, include, exclude)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.file.isBlankDir">
            function <span class="apidocSignatureSpan">jdf.file.</span>isBlankDir
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.file.isDir">
            function <span class="apidocSignatureSpan">jdf.file.</span>isDir
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.file.isFile">
            function <span class="apidocSignatureSpan">jdf.file.</span>isFile
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.file.mkdir">
            function <span class="apidocSignatureSpan">jdf.file.</span>mkdir
            <span class="apidocSignatureSpan">(p, mode, made)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.file.moveFolderAsync">
            function <span class="apidocSignatureSpan">jdf.file.</span>moveFolderAsync
            <span class="apidocSignatureSpan">(source, target)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.file.pathFormat">
            function <span class="apidocSignatureSpan">jdf.file.</span>pathFormat
            <span class="apidocSignatureSpan">(str)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.file.read">
            function <span class="apidocSignatureSpan">jdf.file.</span>read
            <span class="apidocSignatureSpan">(path, encodeing)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.file.readJSON">
            function <span class="apidocSignatureSpan">jdf.file.</span>readJSON
            <span class="apidocSignatureSpan">(url, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.file.realpath">
            function <span class="apidocSignatureSpan">jdf.file.</span>realpath
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.file.renameFile">
            function <span class="apidocSignatureSpan">jdf.file.</span>renameFile
            <span class="apidocSignatureSpan">(path, dest)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.file.tar">
            function <span class="apidocSignatureSpan">jdf.file.</span>tar
            <span class="apidocSignatureSpan">(source, target, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.file.write">
            function <span class="apidocSignatureSpan">jdf.file.</span>write
            <span class="apidocSignatureSpan">(path, source, encodeing)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.jdf.fileFormat">module jdf.fileFormat</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.fileFormat.init">
            function <span class="apidocSignatureSpan">jdf.fileFormat.</span>init
            <span class="apidocSignatureSpan">(filename)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.jdf.fileLint">module jdf.fileLint</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.fileLint.init">
            function <span class="apidocSignatureSpan">jdf.fileLint.</span>init
            <span class="apidocSignatureSpan">(filename)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.jdf.ftp">module jdf.ftp</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.ftp.download">
            function <span class="apidocSignatureSpan">jdf.ftp.</span>download
            <span class="apidocSignatureSpan">(source, target, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.ftp.downloadMain">
            function <span class="apidocSignatureSpan">jdf.ftp.</span>downloadMain
            <span class="apidocSignatureSpan">(source, target, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.ftp.get">
            function <span class="apidocSignatureSpan">jdf.ftp.</span>get
            <span class="apidocSignatureSpan">(source, target, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.ftp.list">
            function <span class="apidocSignatureSpan">jdf.ftp.</span>list
            <span class="apidocSignatureSpan">(source, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.ftp.listMain">
            function <span class="apidocSignatureSpan">jdf.ftp.</span>listMain
            <span class="apidocSignatureSpan">(source, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.ftp.mkdir">
            function <span class="apidocSignatureSpan">jdf.ftp.</span>mkdir
            <span class="apidocSignatureSpan">(source, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.ftp.put">
            function <span class="apidocSignatureSpan">jdf.ftp.</span>put
            <span class="apidocSignatureSpan">(source, target, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.ftp.tryConnect">
            function <span class="apidocSignatureSpan">jdf.ftp.</span>tryConnect
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.ftp.upload">
            function <span class="apidocSignatureSpan">jdf.ftp.</span>upload
            <span class="apidocSignatureSpan">(source, target, include, exclude, uncover, move, logTag, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.ftp.uploadMain">
            function <span class="apidocSignatureSpan">jdf.ftp.</span>uploadMain
            <span class="apidocSignatureSpan">(source, target, include, exclude, uncover, move, logTag, callback)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">jdf.ftp.</span>client</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.jdf.ftpUpload">module jdf.ftpUpload</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.ftpUpload.init">
            function <span class="apidocSignatureSpan">jdf.ftpUpload.</span>init
            <span class="apidocSignatureSpan">(argv, hasConfig, haslog, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.jdf.jdf">module jdf.jdf</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.jdf.argvInit">
            function <span class="apidocSignatureSpan">jdf.jdf.</span>argvInit
            <span class="apidocSignatureSpan">(runType, argv, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.jdf.bgCopyDir">
            function <span class="apidocSignatureSpan">jdf.jdf.</span>bgCopyDir
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.jdf.bgMkdir">
            function <span class="apidocSignatureSpan">jdf.jdf.</span>bgMkdir
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.jdf.buildCss">
            function <span class="apidocSignatureSpan">jdf.jdf.</span>buildCss
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.jdf.buildMain">
            function <span class="apidocSignatureSpan">jdf.jdf.</span>buildMain
            <span class="apidocSignatureSpan">(type, param)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.jdf.checkProjectDir">
            function <span class="apidocSignatureSpan">jdf.jdf.</span>checkProjectDir
            <span class="apidocSignatureSpan">(filename)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.jdf.clean">
            function <span class="apidocSignatureSpan">jdf.jdf.</span>clean
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.jdf.createStandardDir">
            function <span class="apidocSignatureSpan">jdf.jdf.</span>createStandardDir
            <span class="apidocSignatureSpan">(dir)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.jdf.download">
            function <span class="apidocSignatureSpan">jdf.jdf.</span>download
            <span class="apidocSignatureSpan">(pathItem, targetDir)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.jdf.getConfig">
            function <span class="apidocSignatureSpan">jdf.jdf.</span>getConfig
            <span class="apidocSignatureSpan">(callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.jdf.getIp">
            function <span class="apidocSignatureSpan">jdf.jdf.</span>getIp
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.jdf.getLocalServerPort">
            function <span class="apidocSignatureSpan">jdf.jdf.</span>getLocalServerPort
            <span class="apidocSignatureSpan">(callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.jdf.getProjectPath">
            function <span class="apidocSignatureSpan">jdf.jdf.</span>getProjectPath
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.jdf.help">
            function <span class="apidocSignatureSpan">jdf.jdf.</span>help
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.jdf.init">
            function <span class="apidocSignatureSpan">jdf.jdf.</span>init
            <span class="apidocSignatureSpan">(argv)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.jdf.install">
            function <span class="apidocSignatureSpan">jdf.jdf.</span>install
            <span class="apidocSignatureSpan">(type, dir)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.jdf.scan">
            function <span class="apidocSignatureSpan">jdf.jdf.</span>scan
            <span class="apidocSignatureSpan">(host, start, end, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.jdf.server">
            function <span class="apidocSignatureSpan">jdf.jdf.</span>server
            <span class="apidocSignatureSpan">(currentDir, autoOpenurl, comboDebug, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.jdf.version">
            function <span class="apidocSignatureSpan">jdf.jdf.</span>version
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.jdf.watch">
            function <span class="apidocSignatureSpan">jdf.jdf.</span>watch
            <span class="apidocSignatureSpan">(type, callback, data)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">jdf.jdf.</span>config</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">jdf.jdf.</span>dot</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.jdf.livereloadServer">module jdf.livereloadServer</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.livereloadServer.init">
            function <span class="apidocSignatureSpan">jdf.livereloadServer.</span>init
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.livereloadServer.reloadBrowser">
            function <span class="apidocSignatureSpan">jdf.livereloadServer.</span>reloadBrowser
            <span class="apidocSignatureSpan">(paths)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.livereloadServer.start">
            function <span class="apidocSignatureSpan">jdf.livereloadServer.</span>start
            <span class="apidocSignatureSpan">(callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.livereloadServer.stop">
            function <span class="apidocSignatureSpan">jdf.livereloadServer.</span>stop
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.jdf.openurl">module jdf.openurl</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.openurl.open">
            function <span class="apidocSignatureSpan">jdf.openurl.</span>open
            <span class="apidocSignatureSpan">(url, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.jdf.output">module jdf.output</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.output.init">
            function <span class="apidocSignatureSpan">jdf.output.</span>init
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.jdf.server">module jdf.server</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.server.copyright">
            function <span class="apidocSignatureSpan">jdf.server.</span>copyright
            <span class="apidocSignatureSpan">(port)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.server.getDirList">
            function <span class="apidocSignatureSpan">jdf.server.</span>getDirList
            <span class="apidocSignatureSpan">(realPath, pathname, port)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.server.getIp">
            function <span class="apidocSignatureSpan">jdf.server.</span>getIp
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.server.init">
            function <span class="apidocSignatureSpan">jdf.server.</span>init
            <span class="apidocSignatureSpan">(serverCurrentDir, port, cdn, replacePath, comboDebug, addJsDepends, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.server.joinbuffers">
            function <span class="apidocSignatureSpan">jdf.server.</span>joinbuffers
            <span class="apidocSignatureSpan">(bufferStore)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.jdf.vm">module jdf.vm</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.vm.parse">
            function <span class="apidocSignatureSpan">jdf.vm.</span>parse
            <span class="apidocSignatureSpan">(str, dirname)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.vm.rander">
            function <span class="apidocSignatureSpan">jdf.vm.</span>rander
            <span class="apidocSignatureSpan">(vmSource, dataObj, dirname)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.jdf.widget">module jdf.widget</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.widget.all">
            function <span class="apidocSignatureSpan">jdf.widget.</span>all
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.widget.create">
            function <span class="apidocSignatureSpan">jdf.widget.</span>create
            <span class="apidocSignatureSpan">(name)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.widget.hasWidget">
            function <span class="apidocSignatureSpan">jdf.widget.</span>hasWidget
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.widget.install">
            function <span class="apidocSignatureSpan">jdf.widget.</span>install
            <span class="apidocSignatureSpan">(name, force)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.widget.list">
            function <span class="apidocSignatureSpan">jdf.widget.</span>list
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.widget.pathCheck">
            function <span class="apidocSignatureSpan">jdf.widget.</span>pathCheck
            <span class="apidocSignatureSpan">(name)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.widget.preview">
            function <span class="apidocSignatureSpan">jdf.widget.</span>preview
            <span class="apidocSignatureSpan">(name)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.widget.publish">
            function <span class="apidocSignatureSpan">jdf.widget.</span>publish
            <span class="apidocSignatureSpan">(name, force)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.widget.search">
            function <span class="apidocSignatureSpan">jdf.widget.</span>search
            <span class="apidocSignatureSpan">(name)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.jdf.widget.templete">
            function <span class="apidocSignatureSpan">jdf.widget.</span>templete
            <span class="apidocSignatureSpan">(str, title)</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.jdf" id="apidoc.module.jdf">module jdf</a></h1>


    <h2>
        <a href="#apidoc.element.jdf.init" id="apidoc.element.jdf.init">
        function <span class="apidocSignatureSpan">jdf.</span>init
        <span class="apidocSignatureSpan">(argv)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">init = function (argv) {
		jdf.init(argv);
	}</pre></li>
    <li>example usage<pre class="apidocCodePre">...



var jdf = require(&#x27;./lib/jdf.js&#x27;);

module.exports = {
	init: function(argv) {
		jdf.<span class="apidocCodeKeywordSpan">init</span>(argv);
	}
};
...</pre></li>
    </ul>
















































</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.jdf.base" id="apidoc.module.jdf.base">module jdf.base</a></h1>


    <h2>
        <a href="#apidoc.element.jdf.base.arrayMax" id="apidoc.element.jdf.base.arrayMax">
        function <span class="apidocSignatureSpan">jdf.base.</span>arrayMax
        <span class="apidocSignatureSpan">(arr)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">arrayMax = function (arr) {
    if (util.isArray(arr)) {
        var arrTemp=arr[0];
        for (var i=0; i&#x3c;arr.length; i++){
            if(arr[i]&#x3e;arrTemp){
                arrTemp = arr[i];
            }
        }
        return arrTemp;
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @取localServerPort
 */
jdf.getLocalServerPort = function(callback){
    var localServerPort = jdf.config.localServerPort;
    jdf.scan(&#x27;localhost&#x27;, localServerPort, localServerPort, function(result) {
        if(result.length){
            jdf.scan(&#x27;localhost&#x27;, 3000, 3050, function(result) {
                var r = result.length == 0 ? 3000 : $.<span class="apidocCodeKeywordSpan">arrayMax</span>(result) + 1;
                callback(r);
            });
        }else{
            callback(localServerPort);
        }
    });
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.base.excludeFiles" id="apidoc.element.jdf.base.excludeFiles">
        function <span class="apidocSignatureSpan">jdf.base.</span>excludeFiles
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">excludeFiles = function (){
    return &#x27;\\.svn|Thumbs\\.db|\\.DS_Store|\\.git|\\.eslintrc|\\.gitignore|npm-debug\\.log|\\.npmignore|\\.vm|\\.smarty|\\.tpl|\\.scss|\\.less|\\.psd&#x27;;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			if (!f.exists(target) &#x26;&#x26; f.isDir(source)) {
				f.mkdir(target);
                //fs.chmodSync(target, 666);
			}
			
			if(f.isDir(source)){
				fs.readdirSync(source).forEach(function(name){
					if(name != &#x27;.&#x27; &#x26;&#x26; name != &#x27;..&#x27; &#x26;&#x26; f.<span class="apidocCodeKeywordSpan">excludeFiles
</span>(name)  ) {
						removedAll = f.copy(source + &#x27;/&#x27; + name,target + &#x27;/&#x27; + name, include, exclude, uncover, move , logTag ) &#
x26;&#x26; removedAll;
					}
				});

				//Bug  return binding.rmdir(pathModule._makeLong(path));
				//https://github.com/joyent/node/issues/3051
				//Yes, fs.rmdirSync throw an error, as you see. Because the directory still has a file even after fs.unlinkSync is called to
 remove the file.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.base.getCssExtname" id="apidoc.element.jdf.base.getCssExtname">
        function <span class="apidocSignatureSpan">jdf.base.</span>getCssExtname
        <span class="apidocSignatureSpan">(filename)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getCssExtname = function (filename) {
    return filename.replace(/(scss|less)$/g, &#x27;css&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
				if(jdf.config.build.autoprefixer){
					require(&#x27;./buildByAutoprefixer.js&#x27;).init({contents:file.contents, path:file.path }, jdf.config.build.autoprefixerOptions
)
				}else{
					f.write(file.path, file.contents);
				}
			}	

			target = $.<span class="apidocCodeKeywordSpan">getCssExtname</span>(target);

			if( $.is.less(source) || $.is.sass(source) ) {
				var sourceContent = f.read(source);
				//为空 &#x22;node-sass&#x22;: &#x22;0.9.3&#x22; 编译会报错 https://github.com/sass/node-sass/issues/381
				if(sourceContent==&#x27;&#x27;){
					return;	
				}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.base.getDay" id="apidoc.element.jdf.base.getDay">
        function <span class="apidocSignatureSpan">jdf.base.</span>getDay
        <span class="apidocSignatureSpan">(separator)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getDay = function (separator) {
    if (typeof(separator) == &#x27;undefined&#x27;) {
        separator = &#x27;-&#x27;;
    }
    var myDate = new Date();
    var year = myDate.getFullYear();
    var month = myDate.getMonth() + 1;
    month = month &#x3c; 10 ? &#x27;0&#x27; + month : month;
    var day = myDate.getDate();
    day = day &#x3c; 10 ? &#x27;0&#x27; + day : day;
    return year + separator + month + separator + day;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 */
compress.setPrefixBanner = function(bannerType, source, result) {
var projectPath = jdf.getProjectPath() ? jdf.getProjectPath().replace(&#x27;/&#x27;, &#x27;-&#x27;) + &#x27; &#x27; : &#x27;&#x27
;;
var basename = path.basename(source);
var banner = &#x27;&#x27;;

if (bannerType == 1) {
    banner = &#x27;/* &#x27; + projectPath + basename + &#x27; Date:&#x27; + $.<span class="apidocCodeKeywordSpan">getDay</span>(&#
x27;-&#x27;) + &#x27; &#x27; + $.getTime(&#x27;:&#x27;, false) + &#x27; */\r\n&#x27;;
}

if (bannerType == 2) {
    banner = &#x27;/* &#x27; + projectPath + basename + &#x27; md5:&#x27; + $.md5(result) + &#x27; */\r\n&#x27;;
}

return banner;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.base.getJsExtname" id="apidoc.element.jdf.base.getJsExtname">
        function <span class="apidocSignatureSpan">jdf.base.</span>getJsExtname
        <span class="apidocSignatureSpan">(filename)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getJsExtname = function (filename) {
    return filename.replace(/babel$/, &#x27;js&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.base.getTime" id="apidoc.element.jdf.base.getTime">
        function <span class="apidocSignatureSpan">jdf.base.</span>getTime
        <span class="apidocSignatureSpan">(separator, hasMs)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getTime = function (separator, hasMs) {
    if (typeof(separator) == &#x27;undefined&#x27;) {
        separator = &#x27;:&#x27;;
    }
    var myDate = new Date();
    var hour = myDate.getHours();
    hour = hour &#x3c; 10 ? &#x27;0&#x27; + hour : hour;
    var mint = myDate.getMinutes();
    mint = mint &#x3c; 10 ? &#x27;0&#x27; + mint : mint;
    var seconds = myDate.getSeconds();
    seconds = seconds &#x3c; 10 ? &#x27;0&#x27; + seconds : seconds;
    var ms = myDate.getMilliseconds();
    var result = hour + separator + mint + separator + seconds;
    if (typeof(hasMs) != &#x27;undeinfed&#x27; &#x26;&#x26; hasMs) {
        result += separator + ms;
    }
    return result;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}

/**
* @取当前时间戳
* @return 1439361919265
*/
$.getTimestamp = function() {
   return new Date().<span class="apidocCodeKeywordSpan">getTime</span>();
}

/**
* @name $.isArray
* @param {All} obj 主体
* @return {Boolean} true/false
*/
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.base.getTimestamp" id="apidoc.element.jdf.base.getTimestamp">
        function <span class="apidocSignatureSpan">jdf.base.</span>getTimestamp
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getTimestamp = function () {
    return new Date().getTime();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

/**
 * @总的初始化函数 from ../index.js
 * @commander
 */
jdf.init = function(argv) {
//设置全局时间戳
jdf.config.suffix = $.<span class="apidocCodeKeywordSpan">getTimestamp</span>();

//读取配置文件
jdf.getConfig(function(configData) {
    var cmd2 = argv[2];
    jdf.currentDir = f.currentDir();
    jdf.config.argv=argv;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.base.getUrlParam" id="apidoc.element.jdf.base.getUrlParam">
        function <span class="apidocSignatureSpan">jdf.base.</span>getUrlParam
        <span class="apidocSignatureSpan">(url)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getUrlParam = function (url) {
    var urlParseRE = /^(((([^:\/#\?]+:)?(?:(\/\/)((?:(([^:@\/#\?]+)(?:\:([^:@\/#\?]+))?)@)?(([^:\/#\?\]\[]+|\[[^\/\]@#?]+\])(?:\:([
0-9]+))?))?)?)?((\/?(?:[^\/\?#]+\/+)*)([^\?#]*)))?(\?[^#]+)?)(#.*)?/;
    return urlParseRE.exec(url);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	$.httpget(&#x27;http://www.baidu.com/?tn=sitehao123&#x27;, function (data){
		console.log(data);
	});
 */
$.httpget = function(url, callback) {
var http = require(&#x27;http&#x27;);

var matches = $.<span class="apidocCodeKeywordSpan">getUrlParam</span>(url);
var host = matches[6];
var param = (matches[13] ? matches[13] : &#x27;&#x27;) + (matches[16] ? matches[16] : &#x27;&#x27;) + (matches[17] ? matches[17] : &#
x27;&#x27;);

if (typeof(callback) == &#x27;undefined&#x27;) {
    var callback = null;
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.base.getVar" id="apidoc.element.jdf.base.getVar">
        function <span class="apidocSignatureSpan">jdf.base.</span>getVar
        <span class="apidocSignatureSpan">(t)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getVar = function (t) {
    if (typeof(t) != &#x27;undefined&#x27;) {
        return t;
    }
    return &#x27;&#x27;;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    if(result) {
        console.log(os.EOL+filename+&#x27; is OK.&#x27;);
    }else{
        console.log(colors.yellow(os.EOL + &#x27;jdf jslint: &#x27; + filename));
        Jslint.JSLINT.errors.forEach(function (error, index) {
            if(error){
                console.log(&#x27;#&#x27;+(index+1));
                console.log(colors.red(&#x27;&#x3e; &#x27;), &#x27;line: &#x27; + $.<span class="apidocCodeKeywordSpan">getVar</
span>(error.line) + &#x27;, column: &#x27; + $.getVar(error.character));
                console.log(colors.red(&#x27;&#x3e; &#x27;), &#x27;msg: &#x27; + $.getVar(error.reason));
                console.log(colors.red(&#x27;&#x3e; &#x27;), &#x27;at: &#x27; + $.getVar(error.evidence).replace(/\t/g,&#x27;&#x27
;));
            }
        });
    }
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.base.httpget" id="apidoc.element.jdf.base.httpget">
        function <span class="apidocSignatureSpan">jdf.base.</span>httpget
        <span class="apidocSignatureSpan">(url, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">httpget = function (url, callback) {
    var http = require(&#x27;http&#x27;);

    var matches = $.getUrlParam(url);
    var host = matches[6];
    var param = (matches[13] ? matches[13] : &#x27;&#x27;) + (matches[16] ? matches[16] : &#x27;&#x27;) + (matches[17] ? matches[17] : &#x27;&#x27;);

    if (typeof(callback) == &#x27;undefined&#x27;) {
        var callback = null;
    }

    var options = {
        host: host,
        path: param,
        callback: callback
    };

    var requestCallback = function(response) {
        var str = &#x27;&#x27;;

        response.on(&#x27;data&#x27;, function(chunk) {
            str += chunk;
        });

        response.on(&#x27;end&#x27;, function() {
            if (options.callback) options.callback(str);
        });
    }

    var req = http.request(options, requestCallback);
    req.on(&#x27;error&#x27;, function(e) {
        //console.log(e);
    });
    req.end();

    req.setTimeout(500, function() {
        req.abort();
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}

/**
 * @http get
 * @param {String} url 域名
 * @param {Function} callback 回调
 * @example
	$.<span class="apidocCodeKeywordSpan">httpget</span>(&#x27;http://www.baidu.com/?tn=sitehao123&#x27;, function (data){
		console.log(data);
	});
 */
$.httpget = function(url, callback) {
var http = require(&#x27;http&#x27;);

var matches = $.getUrlParam(url);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.base.imageFileType" id="apidoc.element.jdf.base.imageFileType">
        function <span class="apidocSignatureSpan">jdf.base.</span>imageFileType
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">imageFileType = function () {
    return &#x27;svg|tiff|wbmp|png|bmp|fax|gif|ico|jfif|jpe|jpeg|jpg|cur|eot|ttf|woff&#x27;;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    },
    //含有http,https
    httpLink: function(str) {
        return /^http:\/\/|https:\/\/|\/\/|^\/\//.test(str);
    },
    //是否为图片url
    imageFile: function(str) {
        var reg = new RegExp(&#x27;.&#x27; + &#x27;(&#x27; + $.<span class="apidocCodeKeywordSpan">imageFileType</span>() + &#x27
;)&#x27;);
        return reg.test(str);
    },
    babel: function(pathName) {
        return path.extname(pathName) === &#x27;.babel&#x27;;
    }
},
/**
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.base.inArray" id="apidoc.element.jdf.base.inArray">
        function <span class="apidocSignatureSpan">jdf.base.</span>inArray
        <span class="apidocSignatureSpan">(arr, str, include)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">inArray = function (arr, str, include) {
    if (util.isArray(arr)) {
        var res = false;
        arr.forEach(function(item) {
            if (typeof(include) != &#x27;undefined&#x27; &#x26;&#x26; include) {
                var reg = new RegExp(str, &#x27;gm&#x27;)
                if (reg.test(item)) {
                    res = true;
                }
            } else {
                if (item == str) {
                    res = true;
                }
            }
        });
        return res;
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			//widgetStr中的name
			var widgetName = $.trim(widgetArray[1]);
			var widgetDir = &#x27;/widget/&#x27; +widgetName;
			//widget 目录
			var fileDir = path.normalize(jdf.currentDir + widgetDir);
			var widgetInputName = jdf.config.widgetInputName;

			if(widgetInputName.length &#x3e; 0 &#x26;&#x26; !$.<span class="apidocCodeKeywordSpan">inArray</span>(widgetInputName, widgetName
)){
				return;
			}

			//当前工程不存的jdj和jdm模块从服务端文件复制至当前过来
			/*
			if (isJM &#x26;&#x26; !f.exists(fileDir)){
				var source = path.normalize(jdf[widgetType+&#x27;Dir&#x27;]+ widgetDir);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.base.isArray" id="apidoc.element.jdf.base.isArray">
        function <span class="apidocSignatureSpan">jdf.base.</span>isArray
        <span class="apidocSignatureSpan">(obj)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">isArray = function (obj) {
    return Object.prototype.toString.apply(obj) === &#x27;[object Array]&#x27;;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}

/**
 * @数组去重
 * @算法: 设置成一个对象的属性
 */
$.uniq = function(arr) {
if ($.<span class="apidocCodeKeywordSpan">isArray</span>(arr)) {
    var obj = {};
    for (var i = 0; i &#x3c; arr.length; i++) {
        obj[arr[i]] = i;
    }
    arr = [];
    var j = 0;
    for (var i in obj) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.base.md5" id="apidoc.element.jdf.base.md5">
        function <span class="apidocSignatureSpan">jdf.base.</span>md5
        <span class="apidocSignatureSpan">(str)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">md5 = function (str) {
    return crypto.createHash(&#x27;md5&#x27;).update(str).digest(&#x27;hex&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
   var banner = &#x27;&#x27;;

   if (bannerType == 1) {
       banner = &#x27;/* &#x27; + projectPath + basename + &#x27; Date:&#x27; + $.getDay(&#x27;-&#x27;) + &#x27; &#x27; + $.getTime
(&#x27;:&#x27;, false) + &#x27; */\r\n&#x27;;
   }

   if (bannerType == 2) {
       banner = &#x27;/* &#x27; + projectPath + basename + &#x27; md5:&#x27; + $.<span class="apidocCodeKeywordSpan">md5</span>(
result) + &#x27; */\r\n&#x27;;
   }

   return banner;
}

/**
* @html文件压缩
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.base.merageObj" id="apidoc.element.jdf.base.merageObj">
        function <span class="apidocSignatureSpan">jdf.base.</span>merageObj
        <span class="apidocSignatureSpan">(obj1, obj2)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">merageObj = function (obj1, obj2) {
    for (var p in obj2) {
        try {
            if (obj2[p].constructor == Object) {
                obj1[p] = $.merageObj(obj1[p], obj2[p]);
            } else {
                obj1[p] = obj2[p];
            }
        } catch (e) {
            obj1[p] = obj2[p];
        }
    }
    return obj1;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @对象merage
 * @obj2的权重大
 */
$.merageObj = function(obj1, obj2) {
for (var p in obj2) {
    try {
        if (obj2[p].constructor == Object) {
            obj1[p] = $.<span class="apidocCodeKeywordSpan">merageObj</span>(obj1[p], obj2[p]);
        } else {
            obj1[p] = obj2[p];
        }
    } catch (e) {
        obj1[p] = obj2[p];
    }
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.base.replaceSlash" id="apidoc.element.jdf.base.replaceSlash">
        function <span class="apidocSignatureSpan">jdf.base.</span>replaceSlash
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">replaceSlash = function (path) {
    return path.replace(/\/\//gm, &#x27;/&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			var outputJs = &#x27;/&#x27; + jdf.config.jsDir+&#x27;/&#x27;+pkgName+&#x27;.js&#x27;;

			var cssOutputDir = &#x27;/&#x27; + jdf.config.cssDir.replace(jdf.config.baseDir+&#x27;/&#x27;, &#x27;&#x27;) +&#x27;/&#x27;;
			var jsOutputDir = &#x27;/&#x27; + jdf.config.jsDir.replace(jdf.config.baseDir+&#x27;/&#x27;, &#x27;&#x27;) +&#x27;/&#x27;;
			if (isOutput) {
				if(jdf.config.cdn){
					outputCss = &#x27;/&#x27; +  jdf.getProjectPath() + cssOutputDir+pkgName+&#x27;.css&#x27;;
					outputCss = $.<span class="apidocCodeKeywordSpan">replaceSlash</span>(outputCss);
					outputCss = jdf.config.cdn + outputCss;

					outputJs = &#x27;/&#x27; + jdf.getProjectPath() + jsOutputDir+pkgName+&#x27;.js&#x27;;
					outputJs = $.replaceSlash(outputJs);
					outputJs = jdf.config.cdn + outputJs;
				}else{
					outputCss = addgetProjectPath(cssOutputDir+pkgName+&#x27;.css&#x27;);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.base.trim" id="apidoc.element.jdf.base.trim">
        function <span class="apidocSignatureSpan">jdf.base.</span>trim
        <span class="apidocSignatureSpan">(str)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">trim = function (str) {
    return str.replace(/\s/g, &#x27;&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
					return;
				}
			}

			//{%widget name=&#x22; &#x22;%}
			var widgetStr = widgetArray[0];
			//widgetStr中的name
			var widgetName = $.<span class="apidocCodeKeywordSpan">trim</span>(widgetArray[1]);
			var widgetDir = &#x27;/widget/&#x27; +widgetName;
			//widget 目录
			var fileDir = path.normalize(jdf.currentDir + widgetDir);
			var widgetInputName = jdf.config.widgetInputName;

			if(widgetInputName.length &#x3e; 0 &#x26;&#x26; !$.inArray(widgetInputName, widgetName)){
				return;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.base.uniq" id="apidoc.element.jdf.base.uniq">
        function <span class="apidocSignatureSpan">jdf.base.</span>uniq
        <span class="apidocSignatureSpan">(arr)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">uniq = function (arr) {
    if ($.isArray(arr)) {
        var obj = {};
        for (var i = 0; i &#x3c; arr.length; i++) {
            obj[arr[i]] = i;
        }
        arr = [];
        var j = 0;
        for (var i in obj) {
            arr[j] = i;
            j += 1;
        }
    }
    return arr;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	
			//css链接加前缀
			if(jdf.config.output.combineWidgetCss &#x26;&#x26; cssFile !=&#x27;&#x27;){
				var cssLink = $.placeholder.cssLink(outputCss);
				content = $.placeholder.insertHead(content, cssLink  );
				f.write(path.normalize(outputDir+&#x27;/&#x27; + jdf.config.cssDir+&#x27;/&#x27;+pkgName+&#x27;.css&#x27;) , cssFile);
			}else if(jdf.config.output.cssCombo &#x26;&#x26; cssComboArr.length){
				cssComboArr = $.<span class="apidocCodeKeywordSpan">uniq</span>(cssComboArr);
				var outputCss1 = &#x27;/&#x27; +  jdf.getProjectPath() +&#x27;/widget/??&#x27;+cssComboArr.join(&#x27;,&#x27;);
				outputCss1 = jdf.config.cdn + $.replaceSlash(outputCss1);
				var cssLink1 = $.placeholder.cssLink(outputCss1);
				content = $.placeholder.insertHead(content, cssLink1);
			}

			//js链接加前缀
...</pre></li>
    </ul>








</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.jdf.base64" id="apidoc.module.jdf.base64">module jdf.base64</a></h1>


    <h2>
        <a href="#apidoc.element.jdf.base64.init" id="apidoc.element.jdf.base64.init">
        function <span class="apidocSignatureSpan">jdf.base64.</span>init
        <span class="apidocSignatureSpan">(source)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">init = function (source){
	if(jdf.config.build.hasCmdLog) console.log(&#x27;compress.base64---&#x27;+source);
	var reg_background = /background(?:-image)?:([\s\S]*?)(?:;|$)/gi;
	var reg_img_url = /url\s*\(\s*(&#x22;(?:[^\\&#x22;\r\n\f]|\\[\s\S])*&#x22;|&#x27;(?:[^\\&#x27;\n\r\f]|\\[\s\S])*&#x27;|[^)}]+)\s*\)/i;
	var reg_is_base64 = /[?&#x26;]__base64/i;

	var content = f.read(source);
	var background = content.match(reg_background);

	if(background){
		content = escape(content);
		background.forEach(function(item, index){
			var img_url = item.match(reg_img_url);

			if(img_url &#x26;&#x26; img_url[0].match(reg_is_base64)){
				var base64Encode = f.base64Encode(path.join(path.dirname(source), img_url[1].replace(&#x27;?__base64&#x27;, &#x27;&#x27;)));
				content = content.replace(new RegExp(escape(img_url[1]), &#x27;gi&#x27;), (&#x27;data:image/png;base64,&#x27;+base64Encode));
			}
		});
	}

	return unescape(content);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...



var jdf = require(&#x27;./lib/jdf.js&#x27;);

module.exports = {
	init: function(argv) {
		jdf.<span class="apidocCodeKeywordSpan">init</span>(argv);
	}
};
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.jdf.buildByAutoprefixer" id="apidoc.module.jdf.buildByAutoprefixer">module jdf.buildByAutoprefixer</a></h1>


    <h2>
        <a href="#apidoc.element.jdf.buildByAutoprefixer.init" id="apidoc.element.jdf.buildByAutoprefixer.init">
        function <span class="apidocSignatureSpan">jdf.buildByAutoprefixer.</span>init
        <span class="apidocSignatureSpan">(file, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">init = function (file, options){
	var contents = postcss([autoprefixer(options), cssnext]).process(file.contents).css;
	f.write(file.path, contents);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...



var jdf = require(&#x27;./lib/jdf.js&#x27;);

module.exports = {
	init: function(argv) {
		jdf.<span class="apidocCodeKeywordSpan">init</span>(argv);
	}
};
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.jdf.buildCss" id="apidoc.module.jdf.buildCss">module jdf.buildCss</a></h1>


    <h2>
        <a href="#apidoc.element.jdf.buildCss.init" id="apidoc.element.jdf.buildCss.init">
        function <span class="apidocSignatureSpan">jdf.buildCss.</span>init
        <span class="apidocSignatureSpan">(rSource, target)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">init = function (rSource, target){
	var allTag = true;
	var source = f.realpath(rSource);

	if(source){
		if(f.isDir(source)){
			fs.readdirSync(source).forEach(function(name){
				if(name != &#x27;.&#x27; &#x26;&#x26; name != &#x27;..&#x27; &#x26;&#x26; !(/.svn/.test(name))){
					allTag = buildCss.init(source + &#x27;/&#x27; + name, target + &#x27;/&#x27; + name) &#x26;&#x26; allTag;
				}
			});
		} else if(f.isFile(source) &#x26;&#x26; ($.is.css(source) || $.is.less(source) || $.is.sass(source) ) ){
			if(jdf.config.build.hasCmdLog) console.log(&#x27;buildCss---&#x27;+rSource);

			var autoprefixerFn = function(file){
				if(jdf.config.build.autoprefixer){
					require(&#x27;./buildByAutoprefixer.js&#x27;).init({contents:file.contents, path:file.path }, jdf.config.build.autoprefixerOptions)
				}else{
					f.write(file.path, file.contents);
				}
			}	

			target = $.getCssExtname(target);

			if( $.is.less(source) || $.is.sass(source) ) {
				var sourceContent = f.read(source);
				//为空 &#x22;node-sass&#x22;: &#x22;0.9.3&#x22; 编译会报错 https://github.com/sass/node-sass/issues/381
				if(sourceContent==&#x27;&#x27;){
					return;	
				}

				if($.is.less(source) &#x26;&#x26; jdf.config.build.less){
					try{
						Less.render(sourceContent, {filename: source, syncImport:true}, function(error, output){
							if(error){
								console.log(error);
							}else{
								var targetContent = output.css;
								if(jdf.config.build.csslint) fileLint.init(source);
								autoprefixerFn({contents:targetContent, path:target });
								//f.write(target, targetContent);
							}
						});
					}catch(e){
						console.log(&#x27;jdf error [jdf.buildCss] - less&#x27;);
						console.log(Colors.red(&#x27;&#x3e; &#x27;+source));
						console.log(Colors.red(&#x27;&#x3e;&#x27;), e);
					}
				}

				if($.is.sass(source) &#x26;&#x26; jdf.config.build.sass){
					try{
						var css = Sass.renderSync({
							data: sourceContent,
							includePaths: [path.dirname(source)],
							// outputStyle: &#x27;compressed&#x27;
							outputStyle: &#x27;expanded&#x27;
						});
						if(jdf.config.build.csslint) fileLint.init(source);
						autoprefixerFn({contents:css.css.toString(), path:target });
						// f.write(target, css.css);
					}catch(e){
						console.log(&#x27;jdf error [jdf.buildCss] - sass&#x27;);
						console.log(Colors.red(&#x27;&#x3e; &#x27;+source));
						console.log(Colors.red(&#x27;&#x3e; line: &#x27; + e.line + &#x27;, column: &#x27; + e.column));
						console.log(Colors.red(&#x27;&#x3e;&#x27;), &#x27;message: &#x27; + e.message);
					}
				}
			}

			if($.is.css(source) &#x26;&#x26; jdf.config.build.autoprefixer){
				var sourceContent = f.read(source);
				autoprefixerFn({contents:sourceContent, path:target })
			}
		} else {
			allTag = false;
		}
	} else {
		//console.log(&#x27;error&#x27;);
	}
	return allTag;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...



var jdf = require(&#x27;./lib/jdf.js&#x27;);

module.exports = {
	init: function(argv) {
		jdf.<span class="apidocCodeKeywordSpan">init</span>(argv);
	}
};
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.jdf.buildJs" id="apidoc.module.jdf.buildJs">module jdf.buildJs</a></h1>


    <h2>
        <a href="#apidoc.element.jdf.buildJs.init" id="apidoc.element.jdf.buildJs.init">
        function <span class="apidocSignatureSpan">jdf.buildJs.</span>init
        <span class="apidocSignatureSpan">(src, dist)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">init = function (src, dist){
	if(f.isDir(src)){
       var filelist = f.getdirlist(src,&#x27;(js)$&#x27;,jdf.config.build.isEs6Exclude);
        filelist.forEach(function(item){
            babel(item, dist);
        })
    }else if(f.isFile(src)){
       babel(src, dist);
    }else{
    	console.log(&#x27;jdf buildJs &#x22;&#x27; + src + &#x27;&#x22;&#x22; is not exists&#x27;);
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...



var jdf = require(&#x27;./lib/jdf.js&#x27;);

module.exports = {
	init: function(argv) {
		jdf.<span class="apidocCodeKeywordSpan">init</span>(argv);
	}
};
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.jdf.buildWidget" id="apidoc.module.jdf.buildWidget">module jdf.buildWidget</a></h1>


    <h2>
        <a href="#apidoc.element.jdf.buildWidget.init" id="apidoc.element.jdf.buildWidget.init">
        function <span class="apidocSignatureSpan">jdf.buildWidget.</span>init
        <span class="apidocSignatureSpan">(inputPath, content, type, callback, param)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">init = function (inputPath, content, type, callback, param){
	if(jdf.config.build.hasCmdLog) console.log(&#x27;buildWidget---&#x27;+inputPath);

	var isBuild = type == &#x27;build&#x27;;
	var isRelease = type == &#x27;release&#x27;;
	var isOutput = type == &#x27;output&#x27;;

	var result = content.match($.reg.notCommentWidget());
	var origin = content;
	var isJM = false;
	var cssFile=&#x27;&#x27; , jsFile=&#x27;&#x27;;
	var cssComboArr = [];
	var jsComboArr = [];
	
	//widget
	if (result){
		var filesListObj = {};//去重用
		result.forEach(function(resultItem){

			var widgetArray = $.reg.widget().exec(resultItem);
			var widgetType;
			var widgetTypeArray = $.reg.widgetType().exec(resultItem);
			
			//jdj jdm 特殊处理
			if (widgetTypeArray) widgetType = widgetTypeArray[1];
			isJM = (widgetType == &#x27;jdj&#x27; || widgetType == &#x27;jdm&#x27;);
			//if (isJM){ writeJMOnce = true; }
			
			//取widget数据 {%widget data=&#x22; &#x22;%}
			var widgetData;
			var widgetDataArray = $.reg.widgetData().exec(resultItem);
			if (widgetDataArray) widgetData = widgetDataArray[1];
			
			//取widget是否注释tag {%widget comment=&#x22; &#x22;%}
			var widgetComment;
			var widgetCommentArray = $.reg.widgetComment().exec(resultItem);
			if (widgetCommentArray) widgetComment = widgetCommentArray[1];

			//如果type为js或者css则只引用不处理tpl
			var buildTag = {
				tpl:true,
				vm:true,
				smarty: true,
				js:true,
				css:true
			}

			if (widgetType) {
				if (widgetType ==&#x27;tpl&#x27;|| widgetType ==&#x27;vm&#x27;|| widgetType ==&#x27;css&#x27;|| widgetType ==&#x27;js&#x27; || widgetType == &#x27;smarty&#x27;){
					for(var i in buildTag ){
						if(i != widgetType ) buildTag[i] = false;
					}
				}else {
					console.log(inputPath +&#x27; &#x27;+ resultItem);
					console.log(&#x22;jdf warnning [widget type - &#x22;+widgetType +&#x27;] is not approve, please try &#x22;tpl,vm,js,css&#x22; again &#x27;);
					return;
				}
			}

			//{%widget name=&#x22; &#x22;%}
			var widgetStr = widgetArray[0];
			//widgetStr中的name
			var widgetName = $.trim(widgetArray[1]);
			var widgetDir = &#x27;/widget/&#x27; +widgetName;
			//widget 目录
			var fileDir = path.normalize(jdf.currentDir + widgetDir);
			var widgetInputName = jdf.config.widgetInputName;

			if(widgetInputName.length &#x3e; 0 &#x26;&#x26; !$.inArray(widgetInputName, widgetName)){
				return;
			}

			//当前工程不存的jdj和jdm模块从服务端文件复制至当前过来
			<span class="apidocCodeCommentSpan">/*
			if (isJM &#x26;&#x26; !f.exists(fileDir)){
				var source = path.normalize(jdf[widgetType+&#x27;Dir&#x27;]+ widgetDir);
				var target = jdf.currentDir + &#x27;/widget/&#x27; +widgetName;
				f.copy(source,target);
			}*/
</span>			var placeholder=&#x27;&#x27;;
			var dirExists = f.exists(fileDir);
			if (dirExists){
				var files = fs.readdirSync(fileDir);
				files.forEach(function(item){
					//less,scss文件转换成css文件
					var itemOrgin = item;
					item = $.getCssExtname(item);

					//tpl,css,js路径中含有widgetName前缀的才引用 ---&#x3e; 名字完全一样才引用
				
					//单个文件
					var fileUrl = path.join(fileDir, item);
					var staticUrl = &#x27;&#x27;+widgetDir +&#x27;/&#x27;+ item;

					if (param &#x26;&#x26; param.plain) {
						staticUrl = &#x27;..&#x27;+widgetDir +&#x27;/&#x27;+ item;
					}

					//css Compile &#x26;&#x26; innsertCSS link
					var cssCompileFn = function(staticUrl){
						var cssLink = $.placeholder.cssLink(staticUrl);
						if (isBuild){
							content = $.placeholder.insertHead(content,cssLink);
						}else if(isRelease || isOutput){
							if(jdf.config.output.combineWidgetCss){
								//less,sass文件从编译后的bgCurrent读取
								if ($.is.less(itemOrgin) || $.is.sass(itemOrgin)) {
									var fileUrlTemp = jdf.bgCurrentDir + staticUrl;
									cssFile +=  f.read(fileUrlTemp) + &#x27;\n\r&#x27;;
								}else{
									cssFile +=  f.read(jdf.bgCurrentDir+staticUrl) + &#x27;\n\r&#x27;;
								}
							}else{
								if(jdf.config.output.cssCombo &#x26;&#x26; jdf.config.cdn){
									cssComboArr.push(staticUrl.replace(&#x27;/widget/&#x27;, &#x27;&#x27;));
								}else{
									content = $.placeholder.insertHead(content,cssLink);
								}
							}
						}

						/*
						if (isJM){
							origin = $.placeholder.insertHead(origin,cssLink);
						}*/
						filesListObj[staticUrl] = 1;
					}

					//js Compile
					var jsCompileFn = function(staticUrl){
						var jsLink = $.placeholder.jsLink(staticUrl);
						if (isBuild){
							content = buildWidget.insertJs(content,jsLink, jdf.config.build.jsPlace);
						}else if (isRelease || isOutput){
							if( ...</pre></li>
    <li>example usage<pre class="apidocCodePre">...



var jdf = require(&#x27;./lib/jdf.js&#x27;);

module.exports = {
	init: function(argv) {
		jdf.<span class="apidocCodeKeywordSpan">init</span>(argv);
	}
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.buildWidget.insertJs" id="apidoc.element.jdf.buildWidget.insertJs">
        function <span class="apidocSignatureSpan">jdf.buildWidget.</span>insertJs
        <span class="apidocSignatureSpan">(content, jsLink, jsPlace)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">insertJs = function (content, jsLink, jsPlace){
	if(jsPlace == &#x27;insertHead&#x27;){
		content = $.placeholder.insertHead(content, jsLink);
	}else if(jsPlace == &#x27;insertBody&#x27;){
		content = $.placeholder.insertBody(content, jsLink);
	}
	return content;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
						filesListObj[staticUrl] = 1;
					}

					//js Compile
					var jsCompileFn = function(staticUrl){
						var jsLink = $.placeholder.jsLink(staticUrl);
						if (isBuild){
							content = buildWidget.<span class="apidocCodeKeywordSpan">insertJs</span>(content,jsLink, jdf.config.build.jsPlace);
						}else if (isRelease || isOutput){
							if(jdf.config.output.combineWidgetJs){
								//合并所有widget中的js文件至widgetOutputName
								jsFile += f.read(jdf.currentDir+staticUrl) + &#x27;\n\r&#x27;;
							}else{
								if(jdf.config.output.jsCombo &#x26;&#x26; jdf.config.cdn){
									jsComboArr.push(staticUrl.replace(&#x27;/widget/&#x27;, &#x27;&#x27;));
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.jdf.compress" id="apidoc.module.jdf.compress">module jdf.compress</a></h1>


    <h2>
        <a href="#apidoc.element.jdf.compress.addJsDepends" id="apidoc.element.jdf.compress.addJsDepends">
        function <span class="apidocSignatureSpan">jdf.compress.</span>addJsDepends
        <span class="apidocSignatureSpan">(source)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addJsDepends = function (source) {
    var sourceCode = f.read(source);
    var cdn = jdf.config.cdn;
    var configBaseDir = jdf.config.baseDir ? jdf.config.baseDir + &#x27;/&#x27; : &#x27;&#x27;;
    var dependenceArray = [];
    var arr = sourceCode.match(/require\s*\(\s*(&#x22;|&#x27;)(.*?)(&#x22;|&#x27;)\s*\)/gmi);

    //js文件的id和dependences是否添加cdn前缀 默认是不添加的
    if(jdf.config.output.jsUrlReplace == false){
        cdn = &#x22;&#x22;;
    }

    if (arr) {
        for (var i = 0; i &#x3c; arr.length; i++) {
            var temp = arr[i].match(/require\((.*?)\)/);
            if (temp) {
                temp[1] = temp[1].replace(/&#x27;|&#x22;/g, &#x27;&#x27;);
                var match = temp[1];
                //无.js缀和不含有.css的url加.js
                if (!(/\.js$/i.test(match)) &#x26;&#x26; !/\.css/i.test(match)) {
                    match += &#x27;.js&#x27;;
                }
                //add prefix
                if (/^\//.test(match) &#x26;&#x26; !$.is.httpLink(match)) {
                    match = match.replace(configBaseDir, &#x27;&#x27;);
                    match = jdf.getProjectPath() + match;
                }

                if (cdn &#x26;&#x26; !$.is.httpLink(match)) {
                    match = (cdn + &#x27;/&#x27; + match);
                }

                //source content require add prefix
                //var a=require(&#x27;a.js&#x27;) ==&#x3e; var a=require(&#x27;projectPath/a.js&#x27;)
                sourceCode = sourceCode.replace(arr[i], &#x27;require(&#x22;&#x27; + match + &#x27;&#x22;)&#x27;);
                dependenceArray.push(&#x27;&#x22;&#x27; + match + &#x27;&#x22;&#x27;);
            }
        }
    }
    dependenceArray = dependenceArray.join(&#x27;,&#x27;);

<span class="apidocCodeCommentSpan">    /**
     * @has file id add dependenceArray
     * @example
     *   define(&#x27;/a.js&#x27;,function(require, exports) {});  ==&#x3e;
     *   define(&#x27;projectPath/a.js&#x27;, [&#x27;projectPath/b.js&#x27;], function(require, exports) {});
     */
</span>    if (dependenceArray.length &#x3e; 0) {
        //insert
        var arrTemp = /(define\(.*?[&#x22;|&#x27;].*?[&#x22;|&#x27;]).*?,function/m.exec(sourceCode);
        var strTemp = arrTemp ? arrTemp[1] : null;
        if (strTemp) {
            // source = source.replace(strTemp, strTemp+&#x27;,&#x27;+&#x27;[&#x27;+dependenceArray+&#x27;]&#x27;);
        }
    }

    /**
     * @add files id and dependenceArray
     * @example
     *  define(function(require, exports)) ==&#x3e;
     *  define(&#x27;projectPath/a.js&#x27;,[&#x27;projectPath/b.js&#x27;],function(require, exports))
     */
    if (/define\(function/gm.exec(sourceCode)) {
        //getProjectPath
        var filepath = source.split(jdf.config.outputDirName + &#x27;/&#x27; + jdf.getProjectPath());
        var filename = null;
        if (filepath &#x26;&#x26; filepath.length &#x3e; 1) {
            filename = filepath[1].replace(configBaseDir, &#x27;&#x27;);

            var getProjectPath = jdf.getProjectPath() ? jdf.getProjectPath() + &#x27;/&#x27; : &#x27;&#x27;;
            if(jdf.config.output.jsUrlReplace == false || jdf.config.cdn){
                filename = getProjectPath + filename;
            }else{
                //不加cdn前缀 也不加projectPath 即保持默认的路径
                filename = &#x27;..&#x27;  + filename;
            }

        };

        if (!filename) {
            filename = path.basename(source);
        }

        //del // prefix
        filename = filename.replace(/\/\//g, &#x27;/&#x27;);
        if (dependenceArray.length == 0) {
            dependenceArray = &#x27;&#x27;;
        }

        if (cdn &#x26;&#x26; !($.is.httpLink(filename))) {
            filename = cdn + &#x27;/&#x27; + filename;
        }

        sourceCode = sourceCode.replace(&#x27;define(function&#x27;, &#x27;define(&#x22;&#x27; + filename + &#x27;&#x22;,[&#x27; + dependenceArray + &#x27;],function&#x27;);
    }

    /**
     * @seajs.use add prefix
     * @example
     *  seajs.use([&#x27;/a.js&#x27;, &#x27;/b.js&#x27;],function(){}) ==&#x3e;
     *  seajs.use([&#x27;projectPath/a.js&#x27;, &#x27;projectPath/b.js&#x27;],function(){})
     */
    var hasSeajs = sourceCode.match(/seajs\.use\((.*?),\s*function/gim);
    if (hasSeajs) {
        //去重obj
        var tempObj = {};

        for (var i = 0, j = hasSeajs.length; i &#x3c; j; i++) {
            var t = hasSeajs[i].replace(/seajs.use\(|\[|\]|,function/gim, &#x27;&#x27;);
            var t1 = t.split(&#x27;,&#x27;);
            if (t1) {
                for (var m = 0; m &#x3c; t1.length; m++) {
                    //get origin source
                    var t2 = t1[m].replace(/[\&#x22;\&#x27;\s]/g, &#x27;&#x27;);
                    var ...</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}, function() {}, function(error) {})
                } else {
if (jdf.config.output.compressJs) {
    var sourceCode = compress.js(source, isdebug);
    f.write(source, sourceCode);
}

var sourceCode = compress.<span class="apidocCodeKeywordSpan">addJsDepends</span>(source);
f.write(source, sourceCode);

//jsContentReplace
if (jdf.config.output.jsContentReplace ||
    jdf.config.output.jsContentReplaceInProduce ||
    jdf.config.output.jsContentReplaceInPublish
) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.compress.appendWebpCSSFIX" id="apidoc.element.jdf.compress.appendWebpCSSFIX">
        function <span class="apidocSignatureSpan">jdf.compress.</span>appendWebpCSSFIX
        <span class="apidocSignatureSpan">(source)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">appendWebpCSSFIX = function (source) {
    var AST_result = [];
    var sourceCode = compress.css(source, false);
    //remove comment
    sourceCode = sourceCode.replace(/\/\*.*?\*\//ig, function(match) {
        return &#x22;&#x22;
    });
    var rules = sourceCode.match(/.*?\{.*?\}/ig);
    if (!rules) {
        return;
    }
    for (var i = 0; i &#x3c; rules.length; i++) {
        var rule = rules[i];
        if (rule.match(/\{/g).length != rule.match(/\}/g).length) {
            continue;
        }
        var cssBodyStr = rule.match(/\{.*?\}/ig)[0];
        var cssHead = rule.replace(cssBodyStr, &#x22;&#x22;);
        cssHead = cssHead.split(&#x27;;&#x27;);
        cssHead = cssHead[cssHead.length - 1];
        cssBodyStr = cssBodyStr.replace(&#x27;{&#x27;, &#x27;&#x27;).replace(&#x27;}&#x27;, &#x27;&#x27;);
        var cssBodyProperties = cssBodyStr.split(&#x27;;&#x27;);
        var astCssRule = {};
        astCssRule.selector = cssHead;
        astCssRule.values = [];
        for (var j in cssBodyProperties) {
            var cssObj = cssBodyProperties[j].split(&#x22;:&#x22;);
            var cssPropertyName = cssObj[0];
            var cssPropertyValue = cssBodyProperties[j].replace(cssPropertyName + &#x22;:&#x22;, &#x22;&#x22;);
            if (cssPropertyValue.match(/.*?url.*?\.(png|jpg)/ig)) {
                var _c = {
                    k: cssPropertyName,
                    v: cssPropertyValue.replace(/.*?url.*?\.(png|jpg)/ig, function(match) {
                        return match + &#x22;.webp&#x22;;
                    })
                };
                astCssRule.values.push(_c);
            }
        }
        if (astCssRule.values.length) {
            AST_result.push(astCssRule);
        }
    }

    var resultCss = [&#x22;/* webp css prefix */&#x22;];
    for (var i in AST_result) {
        var webpCssRule = AST_result[i];
        var rootClass = jdf.config.output.webpRootClass ? &#x27;.&#x27; + jdf.config.output.webpRootClass + &#x22; &#x22; : &#x22;.root-webp &#x22;;

        var cssValues = [];
        for (var j in webpCssRule.values) {
            var cssV = webpCssRule.values[j];
            cssValues.push(cssV.k + &#x22;:&#x22; + cssV.v);
        }
        var css = rootClass + webpCssRule.selector + &#x22;{&#x22; + cssValues.join(&#x27;;&#x27;) + &#x22;}&#x22;;
        resultCss.push(css);
    }

    var raw = f.read(source);
    f.write(source, raw + &#x22;\n&#x22; + resultCss.join(&#x22;\n&#x22;));


}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
f.write(source, sourceCode);
            }

            //图片webp
            if (jdf.config.output.webp) {
//css webp样式追加
if ($.is.css(source)) {
    compress.<span class="apidocCodeKeywordSpan">appendWebpCSSFIX</span>(source);
}

//图片格式转换
if ($.is.jpg(source) || $.is.png(source)) {
    compress.webp(
        source,
        source + &#x22;.webp&#x22;,
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.compress.css" id="apidoc.element.jdf.compress.css">
        function <span class="apidocSignatureSpan">jdf.compress.</span>css
        <span class="apidocSignatureSpan">(source, isdebug)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">css = function (source, isdebug) {
    var isdebug = isdebug || false;

    if (!f.exists(source)) {
        return;
    }
   if(jdf.config.build.hasCmdLog) console.log(&#x27;compress.css---&#x27;+source);

    var sourceCode = f.read(source);
    var result = sourceCode;
    if (!isdebug) {
        result = new CleanCSS({
            aggressiveMerging: false, //disable aggressive merging of properties.
            keepBreaks: false, //是否有空格
            processImport: false, //是否替换@import
            compatibility: &#x27;*&#x27;
        }).minify(sourceCode);
    }

    if (jdf.config.output.imagesSuffix) {
        result = compress.imagesSuffix(source, result);
    }

    //增加前缀banner
    result = compress.setPrefixBanner(jdf.config.output.hasBanner, source, result) + result + &#x27;\r\n&#x27;;

    return result;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	if(source){
		if(f.isDir(source)){
			fs.readdirSync(source).forEach(function(name){
				if(name != &#x27;.&#x27; &#x26;&#x26; name != &#x27;..&#x27; &#x26;&#x26; !(/.svn/.test(name))){
					allTag = buildCss.init(source + &#x27;/&#x27; + name, target + &#x27;/&#x27; + name) &#x26;&#x26; allTag;
				}
			});
		} else if(f.isFile(source) &#x26;&#x26; ($.is.<span class="apidocCodeKeywordSpan">css</span>(source) || $.is.less(source) || $.
is.sass(source) ) ){
			if(jdf.config.build.hasCmdLog) console.log(&#x27;buildCss---&#x27;+rSource);

			var autoprefixerFn = function(file){
				if(jdf.config.build.autoprefixer){
					require(&#x27;./buildByAutoprefixer.js&#x27;).init({contents:file.contents, path:file.path }, jdf.config.build.autoprefixerOptions
)
				}else{
					f.write(file.path, file.contents);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.compress.css2" id="apidoc.element.jdf.compress.css2">
        function <span class="apidocSignatureSpan">jdf.compress.</span>css2
        <span class="apidocSignatureSpan">(source, isdebug)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">css2 = function (source, isdebug) {
   if(jdf.config.build.hasCmdLog) console.log(&#x27;compress.css2---&#x27;+source);

    var isdebug = isdebug || false;

    if (!f.exists(source)) {
        return;
    }
    var sourceCode = f.read(source);
    var result = sourceCode;
    if (jdf.config.output.imagesSuffix) { //替换imagesSuffix情况下的image名称
        result = compress.imagesSuffix(source, result);
    }
    return result;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}

//css CleanCSS
if ($.is.css(source) &#x26;&#x26; jdf.config.output.compressCss) {
    var sourceCode = compress.css(source, isdebug);
    f.write(source, sourceCode);
} else if ($.is.css(source)) {
    var sourceCode = compress.<span class="apidocCodeKeywordSpan">css2</span>(source, isdebug);
    f.write(source, sourceCode);
}

//png optimize
if ($.is.png(source) &#x26;&#x26; !isdebug &#x26;&#x26; jdf.config.output.compressPng) {
    compress.png(source, source);
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.compress.cssImagesUrlReplace" id="apidoc.element.jdf.compress.cssImagesUrlReplace">
        function <span class="apidocSignatureSpan">jdf.compress.</span>cssImagesUrlReplace
        <span class="apidocSignatureSpan">(source, str, cdn, prefix, suffix)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">cssImagesUrlReplace = function (source, str, cdn, prefix, suffix) {

    //是否为widget中的css文件
    var isWidgetCssFileReg = new RegExp(&#x22;/&#x22; + jdf.config.widgetDir + &#x22;/&#x22;, &#x22;igm&#x22;);
    var isWidgetCssFile = isWidgetCssFileReg.test(source);

    var suffix = jdf.config.suffix;

    var imagesSuffix = jdf.config.output.imagesSuffix;

    var cssImagesUrlReg = new RegExp(&#x22;url\\(.*?\\)&#x22;, &#x22;igm&#x22;);
    var temp = str.match(cssImagesUrlReg);

    var sourcedir = path.normalize(path.dirname(source));
    var outputdir = path.normalize(f.currentDir() + &#x27;/&#x27; + jdf.config.outputDirName);

    var prefix = sourcedir.replace(outputdir, &#x27;&#x27;);
    //项目在C盘,build在D盘
    prefix = prefix.replace(path.normalize(jdf.config.outputDirName), &#x27;&#x27;);

    // \替换成/
    prefix = prefix.replace(/\\/g, &#x27;/&#x27;);
    prefix = &#x27;/&#x27; + prefix + &#x27;/&#x27;;
    // //替换成/
    prefix = prefix.replace(/\/\//gim, &#x27;/&#x27;);

    if(!jdf.config.cdn){
        prefix = &#x27;&#x27;;
    }

    if (temp) {
        var tempObj = {};
        //去重
        for (var i = temp.length - 1; i &#x3e;= 0; i--) {
            if ($.is.imageFile(temp[i])) {
                tempObj[temp[i]] = 1;
            }
        }

        for (var i in tempObj) {
            var b = i;
            b = b.replace(&#x27;url(&#x27;, &#x27;&#x27;);
            b = b.replace(&#x27;)&#x27;, &#x27;&#x27;);
            b = b.replace(/\s/g, &#x27;&#x27;);
            b = b.replace(/\&#x22;/g, &#x27;&#x27;);
            b = b.replace(/\&#x27;/g, &#x27;&#x27;);

            if (b != &#x27;about:blank&#x27; &#x26;&#x26; !$.is.httpLink(b) &#x26;&#x26; !/data:image/.test(b)) {

                var bOrigin = b;

                var c = b.replace(/\.\.\//g, &#x22;&#x22;);
                c = c.replace(/(^\.\/)/, &#x22;&#x22;);

                var hasWidget = new RegExp(&#x22;^/&#x22; + jdf.config.widgetDir, &#x22;igm&#x22;);
                if (hasWidget.test(b)) {
                    // /widget/aaa 替换
                    c = cdn + &#x27;/&#x27; + jdf.getProjectPath() + &#x27;/&#x27; + c;
                } else {
                    if (jdf.config.baseDir) {
                        // /css/ replace其中的/app/
                        c = c.replace(&#x27;/&#x27; + jdf.config.baseDir + &#x27;/&#x27;, &#x22;&#x22;);
                        // /css/ replace其中的 app/
                        c = c.replace(jdf.config.baseDir + &#x27;/&#x27;, &#x27;&#x27;);
                    }

                    if (isWidgetCssFile) {
                        var hasCss = new RegExp(jdf.config.cssDir, &#x22;igm&#x22;);
                        //widget中样式引用css中的图片
                        if (hasCss.test(c) &#x26;&#x26; c.indexOf(&#x27;/&#x27;) == 0) {
                            c = cdn + &#x27;/&#x27; + $.replaceSlash(jdf.getProjectPath() + &#x27;/&#x27; + c);
                        } else {
                            c = cdn + $.replaceSlash(prefix + c);
                        }
                    } else {
                        c = c.replace(jdf.config.cssDir + &#x27;/&#x27;, &#x22;&#x22;);
                        c = cdn + $.replaceSlash(prefix + c);
                    }
                }

                bOrigin = bOrigin.replace(&#x27;/&#x27;, &#x27;\\\/&#x27;).replace(&#x27;?__sprite&#x27;, &#x27;\\?__sprite&#x27;).replace(/\?/g, &#x27;\\?&#x27;);
                var sReg = new RegExp(&#x27;url\\(&#x22;{0,1}&#x27; + bOrigin + &#x27;&#x22;{0,1}\\)&#x27;, &#x27;gim&#x27;);
                str = str.replace(sReg, &#x27;url(&#x27; + c + &#x27;)&#x27;);
            }
        };
    };

    return str;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
//png optimize
if ($.is.png(source) &#x26;&#x26; !isdebug &#x26;&#x26; jdf.config.output.compressPng) {
    compress.png(source, source);
}

//css中图片url增加域名前缀
if (jdf.config.output.cssImagesUrlReplace &#x26;&#x26; $.is.css(source)) {
    var sourceCode = compress.<span class="apidocCodeKeywordSpan">cssImagesUrlReplace</span>(source, sourceCode, jdf.config.cdn);
    f.write(source, sourceCode);
}

//图片base64
if (jdf.config.output.base64 &#x26;&#x26; ($.is.sass(source) || $.is.less(source) || $.is.css(source))) {
    var sourceCode = base64.init(source);
    f.write(source, sourceCode);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.compress.dir" id="apidoc.element.jdf.compress.dir">
        function <span class="apidocSignatureSpan">jdf.compress.</span>dir
        <span class="apidocSignatureSpan">(src, dest)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">dir = function (src, dest) {
    if (typeof(src) == &#x27;undefined&#x27;) {
        console.log(&#x27;jdf warning no src folder&#x27;);
        return;
    }

    var srcPath = path.normalize(f.currentDir() + &#x27;/&#x27; + src);
    var destPath;

    if (typeof(dest) == &#x27;undefined&#x27;) {
        destPath = srcPath;
    } else {
        destPath = path.normalize(f.currentDir() + &#x27;/&#x27; + dest);
        f.copy(srcPath, destPath);
    }

    compress.init(destPath);

    console.log(&#x27;jdf compress success!&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    default:
        console.log(&#x27;You can &#x22;jdf install demo or &#x22;jdf install init&#x22;&#x27;);
}

        } else if (cmd2 === &#x27;c&#x27; || cmd2 === &#x27;compress&#x27;) {
var Compress = require(&#x27;./compress.js&#x27;);
Log.send(&#x27;compress&#x27;);
Compress.<span class="apidocCodeKeywordSpan">dir</span>(argv[3], argv[4]);

//widget
        } else if (cmd2 === &#x27;w&#x27; || cmd2 === &#x27;widget&#x27;) {
var Widget = require(&#x22;./widget.js&#x22;);

var cmd3 = argv[3],
    cmd4 = argv[4],
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.compress.html" id="apidoc.element.jdf.compress.html">
        function <span class="apidocSignatureSpan">jdf.compress.</span>html
        <span class="apidocSignatureSpan">(sourceCode)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">html = function (sourceCode) {
    if(sourceCode){
        sourceCode = Htmlminify(sourceCode, {
            removeComments: true, //移除注释
            collapseWhitespace: true, //合并多余的空格
            minifyJS: true, //压缩文件中的js代码
            minifyCSS: true //压缩文件中的css代码
        });
    }
    return sourceCode;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
if (name != &#x27;.&#x27; &#x26;&#x26; name != &#x27;..&#x27; &#x26;&#x26; !(/.svn/.test(name))) {
    allTag = compress.init(source + &#x27;/&#x27; + name, isdebug) &#x26;&#x26; allTag;
}
            });
        } else if (f.isFile(source)) {

            //html minify
            if ($.is.<span class="apidocCodeKeywordSpan">html</span>(source) &#x26;&#x26; (jdf.config.output.compresshtml||!jdf.
config.output.comment||jdf.config.output.htmlContentReplace) ){
if(jdf.config.build.hasCmdLog) console.log(&#x27;compress.html---&#x27;+source);
var sourceCode = f.read(source);

//html remove comment
if (!jdf.config.output.comment) {
    var htmlComment = $.reg.htmlComment();
    sourceCode = sourceCode.replace(htmlComment, &#x27;&#x27;).replace(/\n\s*\r/g, &#x27;&#x27;);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.compress.imagesSuffix" id="apidoc.element.jdf.compress.imagesSuffix">
        function <span class="apidocSignatureSpan">jdf.compress.</span>imagesSuffix
        <span class="apidocSignatureSpan">(source, str)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">imagesSuffix = function (source, str) {
    var imagesSuffix = jdf.config.output.imagesSuffix;
    var suffix = jdf.config.suffix;

    if (imagesSuffix == 1) {
        str = str.replace(new RegExp(&#x27;\\.png\\?__sprite&#x27;, &#x27;gmi&#x27;), &#x27;.png?__sprite&#x27; + suffix);
    } else if (imagesSuffix == 2) {
        str = str.replace(/\.png\?__sprite/gmi, suffix + &#x27;.png?__sprite&#x27;);
    }

    return str;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
            keepBreaks: false, //是否有空格
            processImport: false, //是否替换@import
            compatibility: &#x27;*&#x27;
        }).minify(sourceCode);
    }

    if (jdf.config.output.imagesSuffix) {
        result = compress.<span class="apidocCodeKeywordSpan">imagesSuffix</span>(source, result);
    }

    //增加前缀banner
    result = compress.setPrefixBanner(jdf.config.output.hasBanner, source, result) + result + &#x27;\r\n&#x27;;

    return result;
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.compress.init" id="apidoc.element.jdf.compress.init">
        function <span class="apidocSignatureSpan">jdf.compress.</span>init
        <span class="apidocSignatureSpan">(rSource, isdebug, config, getProject, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">init = function (rSource, isdebug, config, getProject, callback) {
    if (typeof(config) != &#x27;undefined&#x27;) jdf.config = config;
    if (typeof(getProject) != &#x27;undefined&#x27;) jdf.getProject = getProject;

    var isdebug = isdebug || false;
    var allTag = true;
    var source = f.realpath(rSource);
    if (source) {
        if (f.isDir(source)) {
            fs.readdirSync(source).forEach(function(name) {
                if (name != &#x27;.&#x27; &#x26;&#x26; name != &#x27;..&#x27; &#x26;&#x26; !(/.svn/.test(name))) {
                    allTag = compress.init(source + &#x27;/&#x27; + name, isdebug) &#x26;&#x26; allTag;
                }
            });
        } else if (f.isFile(source)) {

            //html minify
            if ($.is.html(source) &#x26;&#x26; (jdf.config.output.compresshtml||!jdf.config.output.comment||jdf.config.output.htmlContentReplace
) ){
                if(jdf.config.build.hasCmdLog) console.log(&#x27;compress.html---&#x27;+source);
                var sourceCode = f.read(source);

                //html remove comment
                if (!jdf.config.output.comment) {
                    var htmlComment = $.reg.htmlComment();
                    sourceCode = sourceCode.replace(htmlComment, &#x27;&#x27;).replace(/\n\s*\r/g, &#x27;&#x27;);
                }

                //html contentReplace
                if (jdf.config.output.htmlContentReplace ||
                    jdf.config.output.htmlContentReplaceInProduce ||
                    jdf.config.output.htmlContentReplaceInPublish
                ) {
                    var r = jdf.config.output.htmlContentReplace;
                    if(jdf.config.outputType == &#x27;prod&#x27; &#x26;&#x26; jdf.config.output.htmlContentReplaceInProduce) r = jdf.config.output.htmlContentReplaceInProduce
                    if(jdf.config.outputType == &#x27;pub&#x27; &#x26;&#x26; jdf.config.output.htmlContentReplaceInPublish)r = jdf.config.output.htmlContentReplaceInPublish

                    for (var i=0; i&#x3c;r.length; i++){
                        var ri = new RegExp(r[i].from, &#x27;gm&#x27;);
                        sourceCode = sourceCode.replace(ri, r[i].to);
                    }
                }

                //html compress
                if (jdf.config.output.compresshtml &#x26;&#x26; !isdebug) {
                    sourceCode = compress.html(sourceCode, isdebug);
                }

                f.write(source, sourceCode);
            }

            //js UglifyJS
            if ($.is.js(source) &#x26;&#x26; !jdf.config.build.es6Entry ) {
                if (jdf.config.output.rjs) {
                    var outputdir = path.normalize(f.currentDir() + &#x27;/&#x27; + jdf.config.outputDirName + &#x27;/&#x27; + jdf.getProjectPath());
                    requirejs.optimize({
                        appDir: outputdir,
                        allowSourceOverwrites: true,
                        keepBuildDir: true,
                        dir: outputdir
                    }, function() {}, function(error) {})
                } else {
                    if (jdf.config.output.compressJs) {
                        var sourceCode = compress.js(source, isdebug);
                        f.write(source, sourceCode);
                    }

                    var sourceCode = compress.addJsDepends(source);
                    f.write(source, sourceCode);

                    //jsContentReplace
                    if (jdf.config.output.jsContentReplace ||
                        jdf.config.output.jsContentReplaceInProduce ||
                        jdf.config.output.jsContentReplaceInPublish
                    ) {
                        var r = jdf.config.output.jsContentReplace;
                        if(jdf.config.outputType == &#x27;prod&#x27; &#x26;&#x26; jdf.config.output.jsContentReplaceInProduce) r = jdf.config.output
.jsContentReplaceInProduce
                        if(jdf.config.outputType == &#x27;pub&#x27; &#x26;&#x26; jdf.config.output.jsContentReplaceInPublish)r = jdf.config.output.jsContentReplaceInPublish
                        var sourceCode = f.read(source);
                        for (var i=0; i&#x3c;r.length; i++){
                            var ri = new RegExp(r[i].from, &#x27;gm&#x27;);
                            sourceCode = sourceCode.replace(ri, r[i].to ...</pre></li>
    <li>example usage<pre class="apidocCodePre">...



var jdf = require(&#x27;./lib/jdf.js&#x27;);

module.exports = {
	init: function(argv) {
		jdf.<span class="apidocCodeKeywordSpan">init</span>(argv);
	}
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.compress.js" id="apidoc.element.jdf.compress.js">
        function <span class="apidocSignatureSpan">jdf.compress.</span>js
        <span class="apidocSignatureSpan">(source, isdebug)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">js = function (source, isdebug) {
    if(jdf.config.build.hasCmdLog) console.log(&#x27;compress.js---&#x27;+source);

    var isdebug = isdebug || false;
    if (!f.exists(source)) {
        return;
    }
    var sourceContent = f.read(source);
    //sourceContent = compress.addJsDepends(sourceContent);

    var options = {
        remove: [], //
        except: [&#x27;require&#x27;, &#x27;define&#x27;], //不压缩的字符名
        ascii_only: true, //输出Unicode characters
        beautify: false, //美化代码
        warnings: false //显示压缩报错
            //,mangle: false//是否压缩 失效的参数
    };

    if (jdf.config.output.jsRemove) {
        options.remove = jdf.config.output.jsRemove;
    }

    var result = sourceContent;

    try {
        if (!isdebug) {
            //parse
            UglifyJS.base54.reset();
            var toplevel = UglifyJS.parse(sourceContent);
            toplevel.figure_out_scope();
            var compressorOption = {
                hoist_funs: false, //函数声明至顶端
                //fromString: true,  //说明代码源的格式是否为字符串
                //mangle: true,      //是否压缩,只要配置就不压缩了
                warnings: false, //显示压缩报错
                join_vars: false
            }
            if (options.warnings) {
                compressorOption.warnings = options.warnings;
            }

            //remove console.log
            var matchRemoveOption = function(host, method) {
                return !options.remove.every(function(element) {
                    if (element.indexOf(&#x22;.&#x22;) == -1) {
                        return element != host;
                    }
                    return element != host + &#x27;.&#x27; + method;
                });
            }
            var removeConsoleTransformer = new UglifyJS.TreeTransformer(function(node, descend) {
                if (node instanceof UglifyJS.AST_Call) {
                    var host, method;
                    try {
                        host = node.expression.start.value;
                        method = node.expression.end.value;
                    } catch (err) {

                    }

                    if (host &#x26;&#x26; method) {
                        if (matchRemoveOption(host, method)) {
                            return new UglifyJS.AST_Atom();
                        }
                    }
                }
                descend(node, this);
                return node;
            });
            toplevel = toplevel.transform(removeConsoleTransformer);

            var compressor = UglifyJS.Compressor(compressorOption);
            toplevel = toplevel.transform(compressor);
            toplevel.mangle_names({ except: options.except });

            //output, has /*$ */ comments
            var stream = UglifyJS.OutputStream({
                comments: function(scope, comment) {
                    if (isdebug) {
                        return true;
                    } else {
                        if (comment.type == &#x27;comment2&#x27; &#x26;&#x26; comment.value.charAt(0) === &#x27;$&#x27; &#x26;&#x26; options.copyright) {
                            return comment;
                        }
                        return false;
                    }
                },
                space_colon: false,
                //quote_keys: true, object keys加引号
                beautify: options.beautify,
                ascii_only: options.ascii_only
            });

            toplevel.print(stream);
            result = stream.get();
        }

        //增加前缀banner
        if (!isdebug) {
            result = compress.setPrefixBanner(jdf.config.output.hasBanner, source, result) + result + &#x27;\r\n&#x27;;
        }
    } catch (e) {
        if (e &#x26;&#x26; e.message) {
            console.log(&#x27;jdf error [compress.js] - &#x27; + source + &#x27; , line:&#x27; + e.line + &#x27;, &#x27; + e.message);
        }
    }
    return result;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
					if ($.is.css(item) &#x26;&#x26; !filesListObj[staticUrl] &#x26;&#x26; buildTag.css &#x26;&#x26; item == widgetName+$.is.cssSuffix
 ){
						cssCompileFn(staticUrl);
					}

					/**
					 * @build widget js
					 */
					if ($.is.<span class="apidocCodeKeywordSpan">js</span>(item) &#x26;&#x26; !filesListObj[staticUrl] &#x26;&#x26; buildTag.js
 &#x26;&#x26; item == widgetName+$.is.jsSuffix){
						jsCompileFn(staticUrl);
					}
				});
				/*
				if (isJM){
					origin = origin.replace(widgetStr,placeholder);
				}*/
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.compress.png" id="apidoc.element.jdf.compress.png">
        function <span class="apidocSignatureSpan">jdf.compress.</span>png
        <span class="apidocSignatureSpan">(source, target, haslog)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">png = function (source, target, haslog) {
   if(jdf.config.build.hasCmdLog) console.log(&#x27;compress.png---&#x27;+source);

    var compressPngReg = jdf.config.output.compressPngReg;
    if (f.filter(source, false, compressPngReg)) {
        var buffer = fs.readFileSync(source);
        var options = {};
        if (typeof(haslog) != &#x27;undefined&#x27;) {
            options.params = &#x27;-v --iebug&#x27;;
        }
        buffer = Pngquant.option(options).compress(buffer);
        fs.writeFileSync(target,buffer);
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    f.write(source, sourceCode);
} else if ($.is.css(source)) {
    var sourceCode = compress.css2(source, isdebug);
    f.write(source, sourceCode);
}

//png optimize
if ($.is.<span class="apidocCodeKeywordSpan">png</span>(source) &#x26;&#x26; !isdebug &#x26;&#x26; jdf.config.output.compressPng
) {
    compress.png(source, source);
}

//css中图片url增加域名前缀
if (jdf.config.output.cssImagesUrlReplace &#x26;&#x26; $.is.css(source)) {
    var sourceCode = compress.cssImagesUrlReplace(source, sourceCode, jdf.config.cdn);
    f.write(source, sourceCode);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.compress.setPrefixBanner" id="apidoc.element.jdf.compress.setPrefixBanner">
        function <span class="apidocSignatureSpan">jdf.compress.</span>setPrefixBanner
        <span class="apidocSignatureSpan">(bannerType, source, result)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setPrefixBanner = function (bannerType, source, result) {
    var projectPath = jdf.getProjectPath() ? jdf.getProjectPath().replace(&#x27;/&#x27;, &#x27;-&#x27;) + &#x27; &#x27; : &#x27;&#x27;;
    var basename = path.basename(source);
    var banner = &#x27;&#x27;;

    if (bannerType == 1) {
        banner = &#x27;/* &#x27; + projectPath + basename + &#x27; Date:&#x27; + $.getDay(&#x27;-&#x27;) + &#x27; &#x27; + $.getTime(&#x27;:&#x27;, false) + &#x27; */\r\n&#x27;;
    }

    if (bannerType == 2) {
        banner = &#x27;/* &#x27; + projectPath + basename + &#x27; md5:&#x27; + $.md5(result) + &#x27; */\r\n&#x27;;
    }

    return banner;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

        toplevel.print(stream);
        result = stream.get();
    }

    //增加前缀banner
    if (!isdebug) {
        result = compress.<span class="apidocCodeKeywordSpan">setPrefixBanner</span>(jdf.config.output.hasBanner, source, result
) + result + &#x27;\r\n&#x27;;
    }
} catch (e) {
    if (e &#x26;&#x26; e.message) {
        console.log(&#x27;jdf error [compress.js] - &#x27; + source + &#x27; , line:&#x27; + e.line + &#x27;, &#x27; + e.message
);
    }
}
return result;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.compress.webp" id="apidoc.element.jdf.compress.webp">
        function <span class="apidocSignatureSpan">jdf.compress.</span>webp
        <span class="apidocSignatureSpan">(source, target, quant, callback, haslog)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">webp = function (source, target, quant, callback, haslog) {
   if(jdf.config.build.hasCmdLog) console.log( &#x27;compress.webp---&#x27;+source);

    var webp = require(&#x27;webp-converter&#x27;);
    webp.cwebp(source, target, &#x22;-q &#x22; + quant ? quant : quant, function(status) {
        //if conversion successfull status will be &#x27;100&#x27;
        //if conversion unsuccessfull status will be &#x27;101&#x27;
        if (callback) {
            callback(status);
        }
    });

}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
//css webp样式追加
if ($.is.css(source)) {
    compress.appendWebpCSSFIX(source);
}

//图片格式转换
if ($.is.jpg(source) || $.is.png(source)) {
    compress.<span class="apidocCodeKeywordSpan">webp</span>(
        source,
        source + &#x22;.webp&#x22;,
        jdf.config.output.webpQuality ? jdf.config.output.webpQuality : 80,
        function(status) {
            if (callback) {
                callback(status);
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.jdf.compressScheduler" id="apidoc.module.jdf.compressScheduler">module jdf.compressScheduler</a></h1>




    <h2>
        <a href="#apidoc.element.jdf.compressScheduler.init" id="apidoc.element.jdf.compressScheduler.init">
        function <span class="apidocSignatureSpan">jdf.compressScheduler.</span>init
        <span class="apidocSignatureSpan">(outputdirName, isdebug, callBack)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">init = function (outputdirName, isdebug, callBack) {
    initFilesArray(outputdirName);
    CompressScheduler.isdebug = isdebug;

    //webp wrapper 只在单线程下最稳定
    if (jdf.config.threads === 0 || (jdf.config.output &#x26;&#x26; jdf.config.output.webp)) {
        var Compress = require(&#x27;./compress.js&#x27;);
        var task = arr.pop();
        while (task) {

            Compress.init(
                task,
                isdebug,
                jdf.config
            );
            task = arr.pop();
        }
        callBack();
    } else {
        //多进程
        var fork = require(&#x27;child_process&#x27;).fork;
        var childPath = __dirname + &#x22;/compressWorker.js&#x22;;
        childPath = path.normalize(childPath);
        var threadCount = jdf.config.threads || cpus.length;
        for (var i = 0; i &#x3c; threadCount; i++) {
            var subProc = fork(childPath);
            subProc.on(&#x27;message&#x27;, function(data) {
                var task = arr.pop();
                if (!task) {
                    this.disconnect();
                    _execOnceFlag++;
                    if (_execOnceFlag &#x3e;= threadCount) {
                        callBack();
                    }
                    return;
                }
                this.send({
                    task: task,
                    isdebug: isdebug,
                    config: jdf.config,
                    getProject: jdf.getProject
                });
            });
        }
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...



var jdf = require(&#x27;./lib/jdf.js&#x27;);

module.exports = {
	init: function(argv) {
		jdf.<span class="apidocCodeKeywordSpan">init</span>(argv);
	}
};
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.jdf.concat" id="apidoc.module.jdf.concat">module jdf.concat</a></h1>


    <h2>
        <a href="#apidoc.element.jdf.concat.init" id="apidoc.element.jdf.concat.init">
        function <span class="apidocSignatureSpan">jdf.concat.</span>init
        <span class="apidocSignatureSpan">(rSource)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">init = function (rSource){
	var concatFiles = jdf.config.output.concat;

	Object.size = function(obj) {
		var size = 0, key;
		for (key in obj) {
			if (obj.hasOwnProperty(key)) size++;
		}
		return size;
	};
	var source = f.realpath(rSource)+&#x27;/&#x27;+jdf.getProjectPath();
	
	if ( Object.size(concatFiles)) {
		for (var i in concatFiles  ){
			var res = &#x27;&#x27;;
			concatFiles[i].forEach(function(j){
				var m = $.getCssExtname(source+&#x27;/&#x27;+j);
				if (f.exists(m)) {
					res += f.read(m);
					//f.del(source+&#x27;/&#x27;+j);
				}else {
					console.log(&#x27;jdf warnning &#x22;&#x27;+j+&#x27;&#x22; is not exists&#x27;);
				}
			});
			if (res != &#x27;&#x27;) {
				f.write(source+&#x27;/&#x27;+i, res);
			}
		}
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...



var jdf = require(&#x27;./lib/jdf.js&#x27;);

module.exports = {
	init: function(argv) {
		jdf.<span class="apidocCodeKeywordSpan">init</span>(argv);
	}
};
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.jdf.cssSprite" id="apidoc.module.jdf.cssSprite">module jdf.cssSprite</a></h1>


    <h2>
        <a href="#apidoc.element.jdf.cssSprite.init" id="apidoc.element.jdf.cssSprite.init">
        function <span class="apidocSignatureSpan">jdf.cssSprite.</span>init
        <span class="apidocSignatureSpan">(source)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">init = function (source){
	if(jdf.config.output.cssSpriteMode == 0){
		cssSprite.overall(source);
	}

	if(jdf.config.output.cssSpriteMode == 1){
		var list = f.getdirlist(source, &#x27;.css$&#x27;);
		list.forEach(function(item){
			try{
				var cssContent = cssSprite.scatter(item, f.read(item), source);
				f.write(item, cssContent);
			}catch(e){
			}
		});
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...



var jdf = require(&#x27;./lib/jdf.js&#x27;);

module.exports = {
	init: function(argv) {
		jdf.<span class="apidocCodeKeywordSpan">init</span>(argv);
	}
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.cssSprite.overall" id="apidoc.element.jdf.cssSprite.overall">
        function <span class="apidocSignatureSpan">jdf.cssSprite.</span>overall
        <span class="apidocSignatureSpan">(source)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">overall = function (source){
   	var reg_background = /background(?:-image)?:([\s\S]*?)(?:;|$)/gi;
   	var reg_img_url = /url\s*\(\s*(&#x22;(?:[^\\&#x22;\r\n\f]|\\[\s\S])*&#x22;|&#x27;(?:[^\\&#x27;\n\r\f]|\\[\s\S])*&#x27;|[^)}]+)\s*\)/i;
	var reg_position = /(0|[+-]?(?:\d*\.|)\d+px|left|right)\s*(0|[+-]?(?:\d*\.|)\d+px|top)/i;
	var reg_repeat = /\brepeat-(x|y)/i;
	var reg_is_sprite = /[?&#x26;]__sprite/i;

	
	var result = [];
	var resultNew = [];

	var maxWidth = 0;
	var heightTotal = 0;
	var maxHeight = 0;
	var widthTotal = 0;

	var margin = jdf.config.output.cssSpriteMargin;//高度阈值
	var suffix = jdf.config.suffix;
	var imagesSuffix = jdf.config.output.imagesSuffix;
	var cssSpriteDirection = jdf.config.output.cssSpriteDirection;

	var cssFiles = f.getdirlist(source, &#x27;.css$&#x27;);
	var background = [];

	cssFiles.forEach(function(file, index){
		var content = f.read(file);
		var cssBg = content.match(reg_background);
		var dir = path.dirname(file);

		if(cssBg){
			cssBg.forEach(function(bg, index){
				background.push({
					bg: bg,
					dir: dir
				});
			});
		}
	});
	
	if(background){
		var resultTemp = {};
		background.forEach(function(item, index){
			var img_url = item.bg.match(reg_img_url);

			if(img_url &#x26;&#x26; reg_is_sprite.test(img_url[0]) ){
				var res = {
					content:null,
					url:null,
					position:null,
					repeat:null
				};

				var url = img_url[0].replace(/url\(|\)|\&#x27;|\&#x22;/gi,&#x27;&#x27;);

				res.urlOrigin = url;
				url = url.replace(reg_is_sprite, &#x27;&#x27;);

				var sprite_rem = img_url[0].match(new RegExp(&#x27;__rem\\d+&#x27;, &#x27;g&#x27;));
				if(sprite_rem){
					res.rem = parseFloat(sprite_rem[0].replace(&#x27;__rem&#x27;, &#x27;&#x27;));
					url = url.replace(/__rem\d+/g, &#x27;&#x27;);
				}

				res.url = path.join(item.dir, url);

				if(f.exists(res.url)){
					res.content = Images(res.url);
				
					//去重
					if(!resultTemp[res.url]){
						res.item = item.bg;
						res.width = res.content.size().width;
						res.height = res.content.size().height;

						if(cssSpriteDirection == &#x27;vertical&#x27;){
							if(res.width&#x3e;maxWidth){
								maxWidth = res.width;
							}
							heightTotal += res.height + margin;
						}else{
							if(res.height&#x3e;maxHeight){
								maxHeight = res.height;
							}
							widthTotal += res.width + margin;
						}

						if(item.bg.match(reg_position)){
							res.position = item.bg.match(reg_position)[0];
						}
						if(item.bg.match(reg_repeat)){
							res.repeat = item.bg.match(reg_repeat)[0];
						}
						result.push(res);
					}
					resultTemp[res.url] = res.url;
					
				}else{
					console.log(&#x27;jdf warning: [&#x27; + res.url + &#x27;] may be not exist.&#x27;);
				}
			}
		});
	}

	if(result.length&#x3e;0){

		var outputName = jdf.getProjectPath().replace(/\//g, &#x27;_&#x27;);
		var outputExtname = &#x27;.png&#x27;;

		var imagesOutput = null;
		if(cssSpriteDirection == &#x27;vertical&#x27;){
			imagesOutput = Images(maxWidth, heightTotal);
		}else{
			imagesOutput = Images(widthTotal, maxHeight);
		}

		var w = 0;
		var h = 0;
		result.forEach(function(item, i){
			if(!item.repeat){
				var positonArray = [];
				var x = 0, y = h, y2 = -h;

				if(cssSpriteDirection == &#x27;vertical&#x27;){
					var x = 0, y = h, y2 = -h;
					if(item.position){
						var position = item.position.split(&#x27; &#x27;);
						var x1 = parseInt(position[0], 10)
						if(x1){
							x += x1;
						}
						var y1 = parseInt(position[1], 10)
						if(y1){
							y += y1;
							y2 -= y1;
						}
					}

					//画小图片
					imagesOutput.draw(item.content, 0, y);
				}else{
					var y = 0, x = w, x2 = -w;
					if(item.position){
						var position = item.position.split(&#x27; &#x27;);
						var x1 = parseInt(position[0], 10)
						if(x1){
							x += x1;
							x2 -= x1;
						}
						var y1 = parseInt(position[1], 10)
						if(y1){
							y += y1;
						}
					}

					//画小图片
					imagesOutput.draw(item.content, x, 0);
				}

				var urlOrigin = item.urlOrigin;

				//将需要合并的图片名称替换为合并后的新图片名称
				var urlOriginNew = urlOrigin.replace(path.basename(item.url, path.extname(item.url)), outputName);
				
				//将图片的存放目录统一替换为css/i
				urlOriginNew = urlOriginNew.replace(path.dirname(urlOriginNew), &#x27;/css/i&#x27;);

				//给图片添加cdn
				urlOriginNew = imagesUrlAddCdn(&#x27;/&#x27; + jdf. ...</pre></li>
    <li>example usage<pre class="apidocCodePre">...

/**
 * @init
 * @param {String} source css路径文件夹
 */
cssSprite.init = function(source){
	if(jdf.config.output.cssSpriteMode == 0){
		cssSprite.<span class="apidocCodeKeywordSpan">overall</span>(source);
	}

	if(jdf.config.output.cssSpriteMode == 1){
		var list = f.getdirlist(source, &#x27;.css$&#x27;);
		list.forEach(function(item){
			try{
				var cssContent = cssSprite.scatter(item, f.read(item), source);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.cssSprite.scatter" id="apidoc.element.jdf.cssSprite.scatter">
        function <span class="apidocSignatureSpan">jdf.cssSprite.</span>scatter
        <span class="apidocSignatureSpan">(source, content, sourceOrigin)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">scatter = function (source, content, sourceOrigin){
   	var reg_background = /background(?:-image)?:([\s\S]*?)(?:;|$)/gi;
   	var reg_img_url = /url\s*\(\s*(&#x22;(?:[^\\&#x22;\r\n\f]|\\[\s\S])*&#x22;|&#x27;(?:[^\\&#x27;\n\r\f]|\\[\s\S])*&#x27;|[^)}]+)\s*\)/i;
	var reg_position = /(0|[+-]?(?:\d*\.|)\d+px|left|right)\s*(0|[+-]?(?:\d*\.|)\d+px|top)/i;
	var reg_repeat = /\brepeat-(x|y)/i;
	var reg_is_sprite = /[?&#x26;]__sprite/i;

	var background = content.match(reg_background);
	var result = [];

	var maxWidth = 0;
	var heightTotal = 0;
	var maxHeight = 0;
	var widthTotal = 0;

	var margin = jdf.config.output.cssSpriteMargin;//高度阈值
	var suffix = jdf.config.suffix;
	var imagesSuffix = jdf.config.output.imagesSuffix;
	var cssSpriteDirection = jdf.config.output.cssSpriteDirection;

	if(background){
		var resultTemp = {};
		background.forEach(function(item){
			var img_url = item.match(reg_img_url);
			if(img_url &#x26;&#x26; reg_is_sprite.test(img_url[0]) ){
				var res = {
					content:null,
					url:null,
					position:null,
					repeat:null
				};

				var url = img_url[0].replace(/url\(|\)|\&#x27;|\&#x22;/gi,&#x27;&#x27;);
				res.urlOrigin = url;
				url = url.replace(reg_is_sprite, &#x27;&#x27;);

				var sprite_rem = img_url[0].match(new RegExp(&#x27;__rem\\d+&#x27;, &#x27;g&#x27;));
				if(sprite_rem){
					res.rem = parseFloat(sprite_rem[0].replace(&#x27;__rem&#x27;, &#x27;&#x27;));
					url = url.replace(/__rem\d+/g, &#x27;&#x27;);
				}

				if(/^\/\w/.test(url)){
					res.url = path.join(jdf.config.outputDirName, jdf.getProjectPath(), url)
				}else{
					res.url = path.join(path.dirname(source),url);
				}
				res.content = Images(res.url);
				
				//去重
				if(!resultTemp[url]){
					res.item = item;
					res.width = res.content.size().width;
					res.height = res.content.size().height;

					if(cssSpriteDirection == &#x27;vertical&#x27;){
						if(res.width&#x3e;maxWidth){
							maxWidth = res.width;
						}
						heightTotal += res.height + margin;
					}else{
						if(res.height&#x3e;maxHeight){
							maxHeight = res.height;
						}
						widthTotal += res.width + margin;
					}

					if(item.match(reg_position)){
						res.position = item.match(reg_position)[0];
					}
					if(item.match(reg_repeat)){
						res.repeat = item.match(reg_repeat)[0];
					}
					result.push(res);
				}
				resultTemp[url] = url;
			}
		});
	}

	if(result.length&#x3e;0){

		var outputName = path.basename(source, path.extname(source));
		var outputExtname = &#x27;.png&#x27;;

		var imagesOutput = null;
		if(cssSpriteDirection == &#x27;vertical&#x27;){
			imagesOutput = Images(maxWidth, heightTotal);
		}else{
			imagesOutput = Images(widthTotal, maxHeight);
		}
		
		var w = 0;
		var h = 0;
		result.forEach(function(item, i){
			if(!item.repeat){
				outputExtname = path.extname(item.url);

				if(cssSpriteDirection == &#x27;vertical&#x27;){
					var x = 0, y = h, y2 = -h;
					if(item.position){
						var position = item.position.split(&#x27; &#x27;);
						var x1 = parseInt(position[0], 10)
						if(x1){
							x += x1;
						}
						var y1 = parseInt(position[1], 10)
						if(y1){
							y += y1;
							y2 -= y1;
						}
					}

					//画小图片
					imagesOutput.draw(item.content, 0, y);
				}else{
					var y = 0, x = w, x2 = -w;
					if(item.position){
						var position = item.position.split(&#x27; &#x27;);
						var x1 = parseInt(position[0], 10)
						if(x1){
							x += x1;
							x2 -= x1;
						}
						var y1 = parseInt(position[1], 10)
						if(y1){
							y += y1;
						}
					}

					//画小图片
					imagesOutput.draw(item.content, x, 0);
				}

				//样式替换
				var urlOrigin = item.urlOrigin;
				var urlOriginNew = urlOrigin.replace(path.basename(item.url, path.extname(item.url)) , outputName);
				urlOriginNew = urlOriginNew.replace(/^\//, &#x27;&#x27;);
				if(jdf.config.cdn &#x26;&#x26; jdf.config.output.cssImagesUrlReplace){
					urlOriginNew = imagesUrlAddCdn(path.dirname(source).replace(sourceOrigin, &#x27;&#x27;) +&#x27;/&#x27;+ urlOriginNew);
				}
				urlOriginNew = urlOriginNew.replace(/\.\/|\.\.\//gi, &#x27;&#x27;);
				
				var backgroundNew = item.item.replace(urlOrigin, urlOriginNew);

				if(cssSpriteDirection == &#x27;vertical&#x27;){
					if(item.rem){
						backgroundNew += &#x27;background-position:&#x27;+(x/item.rem)+&#x27;rem &#x27;+(y2/item.rem)+&#x27;rem;&#x27;;
						backgroundNew += &#x27;backgroun ...</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		cssSprite.overall(source);
	}

	if(jdf.config.output.cssSpriteMode == 1){
		var list = f.getdirlist(source, &#x27;.css$&#x27;);
		list.forEach(function(item){
			try{
				var cssContent = cssSprite.<span class="apidocCodeKeywordSpan">scatter</span>(item, f.read(item), source);
				f.write(item, cssContent);
			}catch(e){
			}
		});
	}
}
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.jdf.csslint" id="apidoc.module.jdf.csslint">module jdf.csslint</a></h1>


    <h2>
        <a href="#apidoc.element.jdf.csslint.init" id="apidoc.element.jdf.csslint.init">
        function <span class="apidocSignatureSpan">jdf.csslint.</span>init
        <span class="apidocSignatureSpan">(filename, fileContent)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">init = function (filename, fileContent){
	if(typeof(fileContent) == &#x27;undefined&#x27;){
		if(f.isDir(filename)){
	        var filelist = f.getdirlist(filename, &#x27;(css|scss|less)$&#x27;);
	        filelist.forEach(function(item){
	            csslintInit(item);
	        })
	    }else if(f.isFile(filename) &#x26;&#x26; ($.is.css(filename) || $.is.less(filename) || $.is.sass(filename) ) ){
	       csslintInit(filename);
	    }else{
	    	console.log(&#x27;jdf csslint &#x27; + filename + &#x27; is not exists&#x27;);
	    }
	}else{
		csslintInit(filename, fileContent);
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...



var jdf = require(&#x27;./lib/jdf.js&#x27;);

module.exports = {
	init: function(argv) {
		jdf.<span class="apidocCodeKeywordSpan">init</span>(argv);
	}
};
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.jdf.file" id="apidoc.module.jdf.file">module jdf.file</a></h1>




    <h2>
        <a href="#apidoc.element.jdf.file.base64Encode" id="apidoc.element.jdf.file.base64Encode">
        function <span class="apidocSignatureSpan">jdf.file.</span>base64Encode
        <span class="apidocSignatureSpan">(file)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">base64Encode = function (file) {
    var bitmap = fs.readFileSync(file);
    return new Buffer(bitmap).toString(&#x27;base64&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

	if(background){
		content = escape(content);
		background.forEach(function(item, index){
			var img_url = item.match(reg_img_url);

			if(img_url &#x26;&#x26; img_url[0].match(reg_is_base64)){
				var base64Encode = f.<span class="apidocCodeKeywordSpan">base64Encode</span>(path.join(path.dirname(source), img_url[1].replace
(&#x27;?__base64&#x27;, &#x27;&#x27;)));
				content = content.replace(new RegExp(escape(img_url[1]), &#x27;gi&#x27;), (&#x27;data:image/png;base64,&#x27;+base64Encode));
			}
		});
	}

	return unescape(content);
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.file.copy" id="apidoc.element.jdf.file.copy">
        function <span class="apidocSignatureSpan">jdf.file.</span>copy
        <span class="apidocSignatureSpan">(source, target, include, exclude, uncover, move , logTag, encoding)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">copy = function (source, target, include, exclude, uncover, move , logTag, encoding){
		var removedAll = true;
		var source = f.realpath(source);

		if(source &#x26;&#x26; f.filter(source, null, exclude)){
			if (!f.exists(target) &#x26;&#x26; f.isDir(source)) {
				f.mkdir(target);
                //fs.chmodSync(target, 666);
			}
			
			if(f.isDir(source)){
				fs.readdirSync(source).forEach(function(name){
					if(name != &#x27;.&#x27; &#x26;&#x26; name != &#x27;..&#x27; &#x26;&#x26; f.excludeFiles(name)  ) {
						removedAll = f.copy(source + &#x27;/&#x27; + name,target + &#x27;/&#x27; + name, include, exclude, uncover, move , logTag ) &#x26;&#x26; removedAll;
					}
				});

				//Bug  return binding.rmdir(pathModule._makeLong(path));
				//https://github.com/joyent/node/issues/3051
				//Yes, fs.rmdirSync throw an error, as you see. Because the directory still has a file even after fs.unlinkSync is called to
 remove the file.
				if(move &#x26;&#x26; removedAll) {
					fs.rmdirSync(source);
				}
			} else if(f.isFile(source) &#x26;&#x26; f.filter(source, include, exclude)){
				if(uncover &#x26;&#x26; f.exists(target)){
					//uncover
					removedAll = false;
				} else {
					//中文会报错
					f.write(target,fs.readFileSync(source), encoding);
                    //f.copyBinary(source,target)
					if(move) {
						fs.unlinkSync(source);
					}
				}
			} else {
				removedAll = false;
			}
		} else {
			if (typeof(logTag) != &#x27;undefined&#x27; &#x26;&#x26; logTag) {
				console.log(&#x27;jdf error : [ &#x27;+source+&#x27; ] --- no such file or dir&#x27;);
			}
		}
		return removedAll;
	}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			}

			//当前工程不存的jdj和jdm模块从服务端文件复制至当前过来
			/*
			if (isJM &#x26;&#x26; !f.exists(fileDir)){
				var source = path.normalize(jdf[widgetType+&#x27;Dir&#x27;]+ widgetDir);
				var target = jdf.currentDir + &#x27;/widget/&#x27; +widgetName;
				f.<span class="apidocCodeKeywordSpan">copy</span>(source,target);
			}*/
			var placeholder=&#x27;&#x27;;
			var dirExists = f.exists(fileDir);
			if (dirExists){
				var files = fs.readdirSync(fileDir);
				files.forEach(function(item){
					//less,scss文件转换成css文件
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.file.copyBinary" id="apidoc.element.jdf.file.copyBinary">
        function <span class="apidocSignatureSpan">jdf.file.</span>copyBinary
        <span class="apidocSignatureSpan">(srcFile, destFile)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">copyBinary = function (srcFile, destFile){
	var BUF_LENGTH = 64 * 1024;
		var _buff = new Buffer(BUF_LENGTH);
		
    try {
        var fdr = fs.openSync(srcFile, &#x27;r&#x27;)
        var stat = fs.fstatSync(fdr)
        var fdw = fs.openSync(destFile, &#x27;w&#x27;, stat.mode)
        var bytesRead = 1
        var pos = 0

        while (bytesRead &#x3e; 0) {
            bytesRead = fs.readSync(fdr, _buff, 0, BUF_LENGTH, pos)
            fs.writeSync(fdw, _buff, 0, bytesRead)
            pos += bytesRead
        }

        fs.closeSync(fdr)
        fs.closeSync(fdw)
    } catch (e) {
        console.log(&#x22;jdf error [f.copyBinary] &#x22; + srcFile);
        console.log(e);
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			} else if(f.isFile(source) &#x26;&#x26; f.filter(source, include, exclude)){
				if(uncover &#x26;&#x26; f.exists(target)){
					//uncover
					removedAll = false;
				} else {
					//中文会报错
					f.write(target,fs.readFileSync(source), encoding);
                    //f.<span class="apidocCodeKeywordSpan">copyBinary</span>(source,target)
					if(move) {
						fs.unlinkSync(source);
					}
				}
			} else {
				removedAll = false;
			}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.file.currentDir" id="apidoc.element.jdf.file.currentDir">
        function <span class="apidocSignatureSpan">jdf.file.</span>currentDir
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">currentDir = function (){
		return fs.realpathSync(&#x27;.&#x27;);
	}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 */
compress.dir = function(src, dest) {
if (typeof(src) == &#x27;undefined&#x27;) {
    console.log(&#x27;jdf warning no src folder&#x27;);
    return;
}

var srcPath = path.normalize(f.<span class="apidocCodeKeywordSpan">currentDir</span>() + &#x27;/&#x27; + src);
var destPath;

if (typeof(dest) == &#x27;undefined&#x27;) {
    destPath = srcPath;
} else {
    destPath = path.normalize(f.currentDir() + &#x27;/&#x27; + dest);
    f.copy(srcPath, destPath);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.file.del" id="apidoc.element.jdf.file.del">
        function <span class="apidocSignatureSpan">jdf.file.</span>del
        <span class="apidocSignatureSpan">(source, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">del = function (source, callback){
		var removedAll = true;
		var source = f.realpath(source);

		if(source){
			if(f.isDir(source)){
				var files;
				try {
					files = fs.readdirSync(source);
				} catch (err) {
					console.log(err);
				}
				
				files.forEach(function(name){
					if(name != &#x27;.&#x27; &#x26;&#x26; name != &#x27;..&#x27;) {
						removedAll = f.del(source + &#x27;/&#x27; + name) &#x26;&#x26; removedAll;
					}
				});

				if(removedAll) {
					if(fs.existsSync(source)){
						fs.rmdirSync(source);	
					}
					
					if(callback) callback();
				}
			} else if(f.isFile(source)){
				if (f.isWin &#x26;&#x26; f.exists(source)) {
					fs.chmodSync(source, 666);
				}
				fs.unlinkSync(source);
			} else {
				removedAll = false;
			}
		}

		return removedAll;
	}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	if ( Object.size(concatFiles)) {
		for (var i in concatFiles  ){
			var res = &#x27;&#x27;;
			concatFiles[i].forEach(function(j){
				var m = $.getCssExtname(source+&#x27;/&#x27;+j);
				if (f.exists(m)) {
					res += f.read(m);
					//f.<span class="apidocCodeKeywordSpan">del</span>(source+&#x27;/&#x27;+j);
				}else {
					console.log(&#x27;jdf warnning &#x22;&#x27;+j+&#x27;&#x22; is not exists&#x27;);
				}
			});
			if (res != &#x27;&#x27;) {
				f.write(source+&#x27;/&#x27;+i, res);
			}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.file.delAsync" id="apidoc.element.jdf.file.delAsync">
        function <span class="apidocSignatureSpan">jdf.file.</span>delAsync
        <span class="apidocSignatureSpan">(target)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">delAsync = function (target){
    var fork = require(&#x27;child_process&#x27;).fork;
    var childPath=__dirname+&#x22;/fileWorker.js&#x22;;
    childPath=path.normalize(childPath);

    var subProc =  fork(childPath);
    subProc.on(&#x27;message&#x27;, function(data) {
        this.disconnect();
    });

    subProc.send({
        target:target,
        route:&#x27;del&#x27;
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    }
}
    } else if (runType == &#x27;output&#x27;) {
// jdf.bgMkdir();
// var _bgdir=jdf.bgCurrentDir+&#x22;_&#x22;+Math.random();
// f.renameFile(jdf.bgCurrentDir,_bgdir);
// console.log(_bgdir);
// f.<span class="apidocCodeKeywordSpan">delAsync</span>(_bgdir);
// f.mkdir(jdf.bgCurrentDir);

jdf.bgMkdir();
f.del(jdf.bgCurrentDir, function() {
    jdf.bgCopyDir();
    jdf.buildMain(runType);
    //默认
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.file.download" id="apidoc.element.jdf.file.download">
        function <span class="apidocSignatureSpan">jdf.file.</span>download
        <span class="apidocSignatureSpan">(source, target, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">download = function (source, target, callback){
		var http = require(&#x27;http&#x27;);
		var fs = require(&#x27;fs&#x27;);

		var file = fs.createWriteStream(target);
		var request = http.get(source,function(response) {
			var status = response.statusCode;
			response.pipe(file);

			response.on(&#x27;end&#x27;,function(){
				if(status &#x3e;= 200 &#x26;&#x26; status &#x3c; 300 || status === 304){
					if(callback) callback(&#x27;ok&#x27;);
				}
				
				if(status === 404){
					console.log(&#x27;jdf download error &#x27;+source+ &#x27; not exist.&#x27;);
					if(callback) callback(&#x27;error&#x27;);
				}
			});

			response.on(&#x27;error&#x27;,function(err){
				 var msg = typeof err === &#x27;object&#x27; ? err.message : err;
				 console.log(err);
			})
		});
	}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
jdf.download = function(pathItem, targetDir) {
var url = jdf.config[pathItem];
var cacheDir = path.normalize(jdf.cacheDir + &#x27;/&#x27; + pathItem + &#x27;.tar&#x27;);

console.log(&#x27;jdf downloading&#x27;);
jdf.dot.begin();

f.<span class="apidocCodeKeywordSpan">download</span>(url, cacheDir, function(data) {
    if (data == &#x27;ok&#x27;) {
        f.tar(cacheDir, targetDir, function() {
            console.log(&#x27;\r\njdf [&#x27; + pathItem + &#x27;] install done&#x27;);
            jdf.dot.end(false);
        });
    } else if (data == &#x27;error&#x27;) {
        jdf.dot.end(false);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.file.excludeFiles" id="apidoc.element.jdf.file.excludeFiles">
        function <span class="apidocSignatureSpan">jdf.file.</span>excludeFiles
        <span class="apidocSignatureSpan">(filename)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">excludeFiles = function (filename){
		 return !(/.svn|Thumbs.db|.DS_Store/.test(filename));
	}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			if (!f.exists(target) &#x26;&#x26; f.isDir(source)) {
				f.mkdir(target);
                //fs.chmodSync(target, 666);
			}
			
			if(f.isDir(source)){
				fs.readdirSync(source).forEach(function(name){
					if(name != &#x27;.&#x27; &#x26;&#x26; name != &#x27;..&#x27; &#x26;&#x26; f.<span class="apidocCodeKeywordSpan">excludeFiles
</span>(name)  ) {
						removedAll = f.copy(source + &#x27;/&#x27; + name,target + &#x27;/&#x27; + name, include, exclude, uncover, move , logTag ) &#
x26;&#x26; removedAll;
					}
				});

				//Bug  return binding.rmdir(pathModule._makeLong(path));
				//https://github.com/joyent/node/issues/3051
				//Yes, fs.rmdirSync throw an error, as you see. Because the directory still has a file even after fs.unlinkSync is called to
 remove the file.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.file.exists" id="apidoc.element.jdf.file.exists">
        function <span class="apidocSignatureSpan">jdf.file.</span>exists
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">exists = function (path) {
  try {
    nullCheck(path);
    binding.stat(pathModule._makeLong(path), statValues);
    return true;
  } catch (e) {
    return false;
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

			if(widgetInputName.length &#x3e; 0 &#x26;&#x26; !$.inArray(widgetInputName, widgetName)){
				return;
			}

			//当前工程不存的jdj和jdm模块从服务端文件复制至当前过来
			/*
			if (isJM &#x26;&#x26; !f.<span class="apidocCodeKeywordSpan">exists</span>(fileDir)){
				var source = path.normalize(jdf[widgetType+&#x27;Dir&#x27;]+ widgetDir);
				var target = jdf.currentDir + &#x27;/widget/&#x27; +widgetName;
				f.copy(source,target);
			}*/
			var placeholder=&#x27;&#x27;;
			var dirExists = f.exists(fileDir);
			if (dirExists){
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.file.filter" id="apidoc.element.jdf.file.filter">
        function <span class="apidocSignatureSpan">jdf.file.</span>filter
        <span class="apidocSignatureSpan">(source, include, exclude)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">filter = function (source, include, exclude){
		var filterTag = true;
		if (include) {
			var reg = new RegExp(include, &#x27;gm&#x27;);
			var regResult = reg.exec(source);
			if (!regResult) {
				filterTag = false;
			}
		}

		if (exclude) {
			var reg = new RegExp(exclude, &#x27;gm&#x27;);
			var regResult = reg.exec(source);
			if (regResult) {
				filterTag = false;
			}
		}

		return filterTag;
	}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
@option {String} target 输出文件路径
@option {Boolse} false 是否显示log
**/
compress.png = function(source, target, haslog) {
   if(jdf.config.build.hasCmdLog) console.log(&#x27;compress.png---&#x27;+source);

var compressPngReg = jdf.config.output.compressPngReg;
if (f.<span class="apidocCodeKeywordSpan">filter</span>(source, false, compressPngReg)) {
    var buffer = fs.readFileSync(source);
    var options = {};
    if (typeof(haslog) != &#x27;undefined&#x27;) {
        options.params = &#x27;-v --iebug&#x27;;
    }
    buffer = Pngquant.option(options).compress(buffer);
    fs.writeFileSync(target,buffer);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.file.getdirlist" id="apidoc.element.jdf.file.getdirlist">
        function <span class="apidocSignatureSpan">jdf.file.</span>getdirlist
        <span class="apidocSignatureSpan">(source, include, exclude)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getdirlist = function (source, include, exclude){
	var _this = this;
	var result = [];
	//var source = f.realpath(source);
	if(source){
		if(f.isDir(source)){
			fs.readdirSync(source).forEach(function(name){
				result = result.concat( _this.getdirlist(source + &#x27;/&#x27; + name, include, exclude) );
			});
		} else if(f.isFile(source) &#x26;&#x26; f.filter(source, include, exclude)){
			result.push(source.replace(&#x22;//&#x22;,&#x22;/&#x22;));
		}
	}
	return result;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @param src 输入文件/文件夹相对路径
 * @param dist 输出文件/文件夹相对路径
 * @doc http://babeljs.io/docs/usage/api/
 */

exports.init = function(src, dist){
	if(f.isDir(src)){
   var filelist = f.<span class="apidocCodeKeywordSpan">getdirlist</span>(src,&#x27;(js)$&#x27;,jdf.config.build.isEs6Exclude);
    filelist.forEach(function(item){
        babel(item, dist);
    })
}else if(f.isFile(src)){
   babel(src, dist);
}else{
	console.log(&#x27;jdf buildJs &#x22;&#x27; + src + &#x27;&#x22;&#x22; is not exists&#x27;);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.file.isBlankDir" id="apidoc.element.jdf.file.isBlankDir">
        function <span class="apidocSignatureSpan">jdf.file.</span>isBlankDir
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">isBlankDir = function (path){
		return f.getdirlist(path).length == 0;
	}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

ftp.uploadMain = function(source, target, include, exclude, uncover, move, logTag, callback) {
var removedAll = true;
var source = f.realpath(source);
if (source) {
    var core = function() {
        if (f.isDir(source)) {
            if (!f.<span class="apidocCodeKeywordSpan">isBlankDir</span>(source)) {
                ftp.client.mkdir(target, false, function() {});
                fs.readdirSync(source).forEach(function(name) {
                        if (name != &#x27;.&#x27; &#x26;&#x26; name != &#x27;..&#x27; &#x26;&#x26; !(/.svn/.test(name))) {
                            removedAll = ftp.uploadMain(source + &#x27;/&#x27; + name, target + &#x27;/&#x27; + name, include, exclude
, uncover, move, logTag, callback) &#x26;&#x26; removedAll;
                        }
                    });
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.file.isDir" id="apidoc.element.jdf.file.isDir">
        function <span class="apidocSignatureSpan">jdf.file.</span>isDir
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">isDir = function (path){
		return this.exists(path) &#x26;&#x26; fs.statSync(path).isDirectory();
	}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @init
 */
buildCss.init = function(rSource, target){
	var allTag = true;
	var source = f.realpath(rSource);

	if(source){
		if(f.<span class="apidocCodeKeywordSpan">isDir</span>(source)){
			fs.readdirSync(source).forEach(function(name){
				if(name != &#x27;.&#x27; &#x26;&#x26; name != &#x27;..&#x27; &#x26;&#x26; !(/.svn/.test(name))){
					allTag = buildCss.init(source + &#x27;/&#x27; + name, target + &#x27;/&#x27; + name) &#x26;&#x26; allTag;
				}
			});
		} else if(f.isFile(source) &#x26;&#x26; ($.is.css(source) || $.is.less(source) || $.is.sass(source) ) ){
			if(jdf.config.build.hasCmdLog) console.log(&#x27;buildCss---&#x27;+rSource);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.file.isFile" id="apidoc.element.jdf.file.isFile">
        function <span class="apidocSignatureSpan">jdf.file.</span>isFile
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">isFile = function (path){
		return this.exists(path) &#x26;&#x26; fs.statSync(path).isFile();
	}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	if(source){
		if(f.isDir(source)){
			fs.readdirSync(source).forEach(function(name){
				if(name != &#x27;.&#x27; &#x26;&#x26; name != &#x27;..&#x27; &#x26;&#x26; !(/.svn/.test(name))){
					allTag = buildCss.init(source + &#x27;/&#x27; + name, target + &#x27;/&#x27; + name) &#x26;&#x26; allTag;
				}
			});
		} else if(f.<span class="apidocCodeKeywordSpan">isFile</span>(source) &#x26;&#x26; ($.is.css(source) || $.is.less(source) || $.
is.sass(source) ) ){
			if(jdf.config.build.hasCmdLog) console.log(&#x27;buildCss---&#x27;+rSource);

			var autoprefixerFn = function(file){
				if(jdf.config.build.autoprefixer){
					require(&#x27;./buildByAutoprefixer.js&#x27;).init({contents:file.contents, path:file.path }, jdf.config.build.autoprefixerOptions
)
				}else{
					f.write(file.path, file.contents);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.file.mkdir" id="apidoc.element.jdf.file.mkdir">
        function <span class="apidocSignatureSpan">jdf.file.</span>mkdir
        <span class="apidocSignatureSpan">(p, mode, made)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">mkdir = function (p, mode, made) {
    if (mode === undefined) {
        mode = 0777 &#x26; (~process.umask());
    }
    if (!made) made = null;

    if (typeof mode === &#x27;string&#x27;) mode = parseInt(mode, 8);
    p = path.resolve(p);

	if ( !f.exists(p) ) {
		try {
			fs.mkdirSync(p, mode);
			made = made || p;
		}
		catch (err0) {
			switch (err0.code) {
				case &#x27;ENOENT&#x27; :
					made = f.mkdir(path.dirname(p), mode, made);
					f.mkdir(p, mode, made);
					break;
				default:
					var stat;
					try {
						stat = fs.statSync(p);
					}
					catch (err1) {
						throw err0;
					}
					if (!stat.isDirectory()) throw err0;
					break;
			}
		}
		return made;
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
				// console.log(unescape(content))
			}
			f.write(file, unescape(content));
		});
		
		//保存合并完成的cssSprite图片
		var outputDirName = jdf.config.outputDirName + &#x27;/&#x27; + jdf.getProjectPath() + &#x27;/css/i/&#x27;;
		f.<span class="apidocCodeKeywordSpan">mkdir</span>(outputDirName);
		try{
			if(imagesSuffix == 2){
				outputName = outputName + suffix;
			}
			imagesOutput.save(outputDirName + outputName + outputExtname);
		}catch(e){
			console.log(e);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.file.moveFolderAsync" id="apidoc.element.jdf.file.moveFolderAsync">
        function <span class="apidocSignatureSpan">jdf.file.</span>moveFolderAsync
        <span class="apidocSignatureSpan">(source, target)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">moveFolderAsync = function (source, target){
    var fork = require(&#x27;child_process&#x27;).fork;
    var childPath=__dirname+&#x22;/fileWorker.js&#x22;;
    childPath=path.normalize(childPath);

    var subProc =  fork(childPath);
    subProc.on(&#x27;message&#x27;, function(data) {
        this.disconnect();
    });

    subProc.send({
        source:source,
        target:target,
        route:&#x27;copy&#x27;
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.file.pathFormat" id="apidoc.element.jdf.file.pathFormat">
        function <span class="apidocSignatureSpan">jdf.file.</span>pathFormat
        <span class="apidocSignatureSpan">(str)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">pathFormat = function (str){
		return str.replace(/\\/g,&#x27;\/&#x27;);
	}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
							var smartyCompiled = new jSmart(placeholder);

							if(smartyCompiled &#x26;&#x26; smartyJSON){
								placeholder = smartyCompiled.fetch(JSON.parse(smartyJSON));
							}
						}

						fileUrl = f.<span class="apidocCodeKeywordSpan">pathFormat</span>(path.join(widgetDir, item));
						
						var typeHtml=&#x27;&#x27;;
						if (widgetType) typeHtml=&#x27;[&#x27;+widgetType+&#x27;]&#x27;;
						//insert comment
						if ( jdf.config.build.widgetIncludeComment){
							if(widgetComment === &#x27;false&#x27;) return;
							if(/&#x3c;\!DOCTYPE/.test(placeholder)){
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.file.read" id="apidoc.element.jdf.file.read">
        function <span class="apidocSignatureSpan">jdf.file.</span>read
        <span class="apidocSignatureSpan">(path, encodeing)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">read = function (path, encodeing){
		if (this.exists(path)){
			try {
				if(typeof(encodeing) != &#x27;undefined&#x27; &#x26;&#x26; encodeing == null){
					return fs.readFileSync(path);
				}else{
					var encodeing = encodeing || &#x27;utf8&#x27;;
					return fs.readFileSync(path, encodeing);
				}
			} catch (e) {
				console.log(&#x22;jdf error [f.read]&#x22;);
				console.log(path);
				console.log(e);
			}		
		}
	}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

base64.init = function(source){
	if(jdf.config.build.hasCmdLog) console.log(&#x27;compress.base64---&#x27;+source);
	var reg_background = /background(?:-image)?:([\s\S]*?)(?:;|$)/gi;
	var reg_img_url = /url\s*\(\s*(&#x22;(?:[^\\&#x22;\r\n\f]|\\[\s\S])*&#x22;|&#x27;(?:[^\\&#x27;\n\r\f]|\\[\s\S])*&#x27;|[^)}]+)\
s*\)/i;
	var reg_is_base64 = /[?&#x26;]__base64/i;

	var content = f.<span class="apidocCodeKeywordSpan">read</span>(source);
	var background = content.match(reg_background);

	if(background){
		content = escape(content);
		background.forEach(function(item, index){
			var img_url = item.match(reg_img_url);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.file.readJSON" id="apidoc.element.jdf.file.readJSON">
        function <span class="apidocSignatureSpan">jdf.file.</span>readJSON
        <span class="apidocSignatureSpan">(url, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">readJSON = function (url, callback){
	var res = null;
	if (f.exists(url)) {
		try{
			var data = f.read(url);
			if (data) {
				data = JSON.parse(data);
				res = data;
			}
			if(callback) callback(res);
		}catch(e){
			console.log(&#x27;jdf error [f.readJSON] &#x22;&#x27;+url+&#x27;&#x22; format error&#x27; );
			console.log(e);
			//if(callback) callback(res);
		}
	}else{
		console.log(&#x27;jdf error [f.readJSON] &#x22;&#x27;+url+&#x27;&#x22; is not exists&#x27; );
		//if(callback) callback(res);
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

    downloadMain(source + &#x27;/&#x27; + version, target, function(data) {
        if (data == &#x27;error&#x27;) {
            console.log(&#x27;jdf warnning widget [&#x27; + widgetNameVersion + &#x27;] is not exists on server &#x27;);
        } else {
            console.log(&#x27;jdf widget [&#x27; + widgetNameVersion + &#x27;] install done from server &#x27;);
        }
        f.<span class="apidocCodeKeywordSpan">readJSON</span>(target + &#x27;/component.json&#x27;, function(data) {
            for (name in data.dependencies) {
                download(name, force);
            }
            ftp.client.end();
        });
    });
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.file.realpath" id="apidoc.element.jdf.file.realpath">
        function <span class="apidocSignatureSpan">jdf.file.</span>realpath
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">realpath = function (path){
		if(path &#x26;&#x26; f.exists(path)){
			path = fs.realpathSync(path);
			if(this.isWin){
				path = path.replace(/\\/g, &#x27;/&#x27;);
			}
			if(path !== &#x27;/&#x27;){
				path = path.replace(/\/$/, &#x27;&#x27;);
			}
			return path;
		} else {
			return false;
		}
	}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var buildCss = module.exports = {};

/**
 * @init
 */
buildCss.init = function(rSource, target){
	var allTag = true;
	var source = f.<span class="apidocCodeKeywordSpan">realpath</span>(rSource);

	if(source){
		if(f.isDir(source)){
			fs.readdirSync(source).forEach(function(name){
				if(name != &#x27;.&#x27; &#x26;&#x26; name != &#x27;..&#x27; &#x26;&#x26; !(/.svn/.test(name))){
					allTag = buildCss.init(source + &#x27;/&#x27; + name, target + &#x27;/&#x27; + name) &#x26;&#x26; allTag;
				}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.file.renameFile" id="apidoc.element.jdf.file.renameFile">
        function <span class="apidocSignatureSpan">jdf.file.</span>renameFile
        <span class="apidocSignatureSpan">(path, dest)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">renameFile = function (path, dest){
	fs.renameSync(path,dest);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
            jdf.watch(runType, callback, data);
        });
    }
}
    } else if (runType == &#x27;output&#x27;) {
// jdf.bgMkdir();
// var _bgdir=jdf.bgCurrentDir+&#x22;_&#x22;+Math.random();
// f.<span class="apidocCodeKeywordSpan">renameFile</span>(jdf.bgCurrentDir,_bgdir);
// console.log(_bgdir);
// f.delAsync(_bgdir);
// f.mkdir(jdf.bgCurrentDir);

jdf.bgMkdir();
f.del(jdf.bgCurrentDir, function() {
    jdf.bgCopyDir();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.file.tar" id="apidoc.element.jdf.file.tar">
        function <span class="apidocSignatureSpan">jdf.file.</span>tar
        <span class="apidocSignatureSpan">(source, target, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">tar = function (source, target, callback){
		//引用的组件
		var tar = require(&#x22;tar&#x22;);
		fs.createReadStream(source)
		.pipe(tar.Extract({ path:target }))
		.on(&#x22;error&#x22;,function (err) {
			console.error(&#x22;jdf [file.tar] error &#x22;+source)
		})
		.on(&#x22;end&#x22;, function () {
			if(callback) callback();
		})
	}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var cacheDir = path.normalize(jdf.cacheDir + &#x27;/&#x27; + pathItem + &#x27;.tar&#x27;);

console.log(&#x27;jdf downloading&#x27;);
jdf.dot.begin();

f.download(url, cacheDir, function(data) {
    if (data == &#x27;ok&#x27;) {
        f.<span class="apidocCodeKeywordSpan">tar</span>(cacheDir, targetDir, function() {
            console.log(&#x27;\r\njdf [&#x27; + pathItem + &#x27;] install done&#x27;);
            jdf.dot.end(false);
        });
    } else if (data == &#x27;error&#x27;) {
        jdf.dot.end(false);
    }
})
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.file.write" id="apidoc.element.jdf.file.write">
        function <span class="apidocSignatureSpan">jdf.file.</span>write
        <span class="apidocSignatureSpan">(path, source, encodeing)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">write = function (path, source, encodeing){
		try {
			var encodeing = encodeing || &#x27;utf8&#x27;;

			if(encodeing == &#x27;gbk&#x27;){
				var s = iconv.decode(source, &#x27;gbk&#x27;);
    			source = iconv.encode(s, &#x27;gbk&#x27;);
    		}

			fs.writeFileSync(path , source, encodeing);
		} catch (e) {
			console.log(&#x22;jdf error [f.write] &#x22; + path);
			console.log(e);
		}
	}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var postcss      = require(&#x27;postcss&#x27;);
var cssnext      = require(&#x27;cssnext&#x27;);
var f      		 = require(&#x27;./file&#x27;);

var doAutoprefixer = module.exports = {};
doAutoprefixer.init = function(file, options){
	var contents = postcss([autoprefixer(options), cssnext]).process(file.contents).css;
	f.<span class="apidocCodeKeywordSpan">write</span>(file.path, contents);
}
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.jdf.fileFormat" id="apidoc.module.jdf.fileFormat">module jdf.fileFormat</a></h1>


    <h2>
        <a href="#apidoc.element.jdf.fileFormat.init" id="apidoc.element.jdf.fileFormat.init">
        function <span class="apidocSignatureSpan">jdf.fileFormat.</span>init
        <span class="apidocSignatureSpan">(filename)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">init = function (filename){
	if(!typeof(filename) !== &#x27;undefined&#x27;){
		if(f.isDir(filename)){
			var filelist = f.getdirlist(filename, &#x27;(html|vm|tpl|css|scss|less|js)$&#x27;);

			filelist.forEach(function(file){
				route(file);
			});

		}else{
			route(filename);
		}
	}

	function route(file){
		var exists = f.exists(file);
		
		if(exists){
			if($.is.html(file) || $.is.vm(file) || $.is.tpl(file)){
				htmlFormat(file);

			}else if($.is.css(file) || $.is.less(file) || $.is.sass(file)){
				cssFormat(file);

			}else if($.is.js(file)){
				jsFormat(file);

			}else{
				console.log(&#x27;jdf warning: can not format the [&#x27; + file + &#x27;].\n&#x27;);
			}
		}else{
			console.log(&#x27;jdf error: the [&#x27; + file + &#x27;] may be not exist.&#x27;);
		}
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...



var jdf = require(&#x27;./lib/jdf.js&#x27;);

module.exports = {
	init: function(argv) {
		jdf.<span class="apidocCodeKeywordSpan">init</span>(argv);
	}
};
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.jdf.fileLint" id="apidoc.module.jdf.fileLint">module jdf.fileLint</a></h1>


    <h2>
        <a href="#apidoc.element.jdf.fileLint.init" id="apidoc.element.jdf.fileLint.init">
        function <span class="apidocSignatureSpan">jdf.fileLint.</span>init
        <span class="apidocSignatureSpan">(filename)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">init = function (filename){
	if(!typeof(filename) !== &#x27;undefined&#x27;){
		if(f.isDir(filename)){
			var filelist = f.getdirlist(filename, &#x27;(html|vm|tpl|css|scss|less|js)$&#x27;);

			filelist.forEach(function(file){
				route(file);
			});

		}else{
			route(filename);
		}
	}

	function route(file){
		var exists = f.exists(file);

		if($.is.httpLink(file)){
			httpLinkLint(file);
			return;
		}

		if(exists){
			if($.is.html(file) || $.is.vm(file) || $.is.tpl(file)){
				htmlLint(file);

			}else if($.is.css(file) || $.is.less(file) || $.is.sass(file)){
				cssLint(file);

			}else if($.is.js(file)){
				jsLint(file);

			}else{
				console.log(&#x27;jdf warning: can not lint the [&#x27; + file + &#x27;].\n&#x27;);
			}
		}else{
			console.log(&#x27;jdf error: the [&#x27; + file + &#x27;] may be not exist.&#x27;);
		}
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...



var jdf = require(&#x27;./lib/jdf.js&#x27;);

module.exports = {
	init: function(argv) {
		jdf.<span class="apidocCodeKeywordSpan">init</span>(argv);
	}
};
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.jdf.ftp" id="apidoc.module.jdf.ftp">module jdf.ftp</a></h1>


    <h2>
        <a href="#apidoc.element.jdf.ftp.download" id="apidoc.element.jdf.ftp.download">
        function <span class="apidocSignatureSpan">jdf.ftp.</span>download
        <span class="apidocSignatureSpan">(source, target, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">download = function (source, target, callback) {

    ftp.tryConnect().done(function() {
        ftp.downloadMain(source, target, callback);
    }).err(function(err) {

    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
jdf.download = function(pathItem, targetDir) {
var url = jdf.config[pathItem];
var cacheDir = path.normalize(jdf.cacheDir + &#x27;/&#x27; + pathItem + &#x27;.tar&#x27;);

console.log(&#x27;jdf downloading&#x27;);
jdf.dot.begin();

f.<span class="apidocCodeKeywordSpan">download</span>(url, cacheDir, function(data) {
    if (data == &#x27;ok&#x27;) {
        f.tar(cacheDir, targetDir, function() {
            console.log(&#x27;\r\njdf [&#x27; + pathItem + &#x27;] install done&#x27;);
            jdf.dot.end(false);
        });
    } else if (data == &#x27;error&#x27;) {
        jdf.dot.end(false);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.ftp.downloadMain" id="apidoc.element.jdf.ftp.downloadMain">
        function <span class="apidocSignatureSpan">jdf.ftp.</span>downloadMain
        <span class="apidocSignatureSpan">(source, target, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">downloadMain = function (source, target, callback) {

    ftp.listMain(source, function(data) {
        if (data != &#x27;error&#x27;) {
            f.mkdir(target);
            var serverNum = 0,
                localNum = 0;
            data.forEach(function(item) {
                if (item.type == &#x27;file&#x27;) {
                    serverNum += 1;
                    var sourcePut = source + &#x27;/&#x27; + item.name;
                    var targetPut = target + &#x27;/&#x27; + item.name;

                    ftp.get(sourcePut, targetPut, function() {
                        localNum += 1;
                        if (serverNum == localNum) {
                            ftp.client.end();
                            if (callback) callback();
                        }
                    });
                }
            })
        } else {
            if (callback) callback(data);
        };
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
* @download
* @param {String} source 远端机器目标文件夹/文件路径
* @param {String} target 本地文件夹/文件路径
*/
ftp.download = function(source, target, callback) {

   ftp.tryConnect().done(function() {
       ftp.<span class="apidocCodeKeywordSpan">downloadMain</span>(source, target, callback);
   }).err(function(err) {

   });
}

/**
* @downloadMain
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.ftp.get" id="apidoc.element.jdf.ftp.get">
        function <span class="apidocSignatureSpan">jdf.ftp.</span>get
        <span class="apidocSignatureSpan">(source, target, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">get = function (source, target, callback) {
    ftp.client.get(source, function(err, stream) {
        if (err) {
            console.log(&#x27;jdf error [ftp.get] - &#x27; + target + &#x27; - &#x27; + err);
            if (callback) callback(err);
            ftp.client.end();
        } else {
            stream.once(&#x27;close&#x27;, function() {
                // ftp.client.end();
            });
            stream.pipe(fs.createWriteStream(target));
            if (callback) callback();
        }
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
            space_colon: false,
            //quote_keys: true, object keys加引号
            beautify: options.beautify,
            ascii_only: options.ascii_only
        });

        toplevel.print(stream);
        result = stream.<span class="apidocCodeKeywordSpan">get</span>();
    }

    //增加前缀banner
    if (!isdebug) {
        result = compress.setPrefixBanner(jdf.config.output.hasBanner, source, result) + result + &#x27;\r\n&#x27;;
    }
} catch (e) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.ftp.list" id="apidoc.element.jdf.ftp.list">
        function <span class="apidocSignatureSpan">jdf.ftp.</span>list
        <span class="apidocSignatureSpan">(source, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">list = function (source, callback) {
    if (typeof(source) == &#x27;undefined&#x27;) {
        var source = &#x27;./&#x27;;
    }

    ftp.tryConnect().done(function() {
        ftp.listMain(source, callback);
    }).err(function(err) {

    });


}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

}

/**
 * @get server files list main
 */
ftp.listMain = function(source, callback) {
    ftp.client.<span class="apidocCodeKeywordSpan">list</span>(source, function(err, list) {
        if (err) {
console.log(&#x27;jdf error [ftp.list] - &#x27; + err);
ftp.client.end();
        } else {

if (list &#x26;&#x26; list.length &#x3e; 0) {
    var filesList = [];
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.ftp.listMain" id="apidoc.element.jdf.ftp.listMain">
        function <span class="apidocSignatureSpan">jdf.ftp.</span>listMain
        <span class="apidocSignatureSpan">(source, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">listMain = function (source, callback) {
    ftp.client.list(source, function(err, list) {
        if (err) {
            console.log(&#x27;jdf error [ftp.list] - &#x27; + err);
            ftp.client.end();
        } else {

            if (list &#x26;&#x26; list.length &#x3e; 0) {
                var filesList = [];
                list.forEach(function(data) {
                    var fileType = &#x27;&#x27;;
                    if (data.type == &#x27;-&#x27;) {
                        fileType = &#x27;file&#x27;;
                    } else if (data.type == &#x27;d&#x27;) {
                        fileType = &#x27;dir&#x27;;
                    }

                    filesList.push({
                        name: data.name,
                        type: fileType
                    })
                })
                if (callback) callback(filesList);
                //ftp.client.end();
                //console.log(&#x22;end at 274&#x22;);
            } else {
                if (callback) {
                    callback(&#x27;error&#x27;);
                } else {
                    console.log(&#x27;jdf warnning : &#x22;&#x27; + source + &#x27;&#x22; is not exists&#x27;);
                };
                //ftp.client.end();
                //console.log(&#x22;end at 282&#x22;);
            }

            if (!callback) {
                //ftp.client.end();
                //console.log(&#x22;end at 287&#x22;);
            }
        }
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}

/**
 * @downloadMain
 */
ftp.downloadMain = function(source, target, callback) {

ftp.<span class="apidocCodeKeywordSpan">listMain</span>(source, function(data) {
    if (data != &#x27;error&#x27;) {
        f.mkdir(target);
        var serverNum = 0,
            localNum = 0;
        data.forEach(function(item) {
            if (item.type == &#x27;file&#x27;) {
                serverNum += 1;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.ftp.mkdir" id="apidoc.element.jdf.ftp.mkdir">
        function <span class="apidocSignatureSpan">jdf.ftp.</span>mkdir
        <span class="apidocSignatureSpan">(source, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">mkdir = function (source, callback) {
    if (typeof(source) == &#x27;undefined&#x27;) {
        console.log(&#x27;jdf error [ftp.mkdir] source is not exists&#x27;);
        return;
    }

    ftp.tryConnect().done(function() {
        ftp.client.mkdir(source, false, function(err) {
            if (callback) callback(err);
        });
    }).err(function(err) {

    });

}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
				// console.log(unescape(content))
			}
			f.write(file, unescape(content));
		});
		
		//保存合并完成的cssSprite图片
		var outputDirName = jdf.config.outputDirName + &#x27;/&#x27; + jdf.getProjectPath() + &#x27;/css/i/&#x27;;
		f.<span class="apidocCodeKeywordSpan">mkdir</span>(outputDirName);
		try{
			if(imagesSuffix == 2){
				outputName = outputName + suffix;
			}
			imagesOutput.save(outputDirName + outputName + outputExtname);
		}catch(e){
			console.log(e);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.ftp.put" id="apidoc.element.jdf.ftp.put">
        function <span class="apidocSignatureSpan">jdf.ftp.</span>put
        <span class="apidocSignatureSpan">(source, target, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">put = function (source, target, callback) {
    ftp.client.put(source, target, function(err) {
        if (err) {
            console.log(&#x27;jdf error [ftp.put] - &#x27; + target + &#x27; - &#x27; + err);
            if (callback) callback(err);
            ftp.client.end();
        } else {
            if (callback) callback();
        }
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
uploadLocalNum += 1;


if (uncover /*&#x26;&#x26; f.exists(target)*/ ) {
    //uncover
    removedAll = false;
} else {
    ftp.<span class="apidocCodeKeywordSpan">put</span>(source, target, function(err) {
        uploadRemoteNum += 1;
        if (uploadLocalNum == uploadRemoteNum) {
            if (callback){

                callback(err);
            }
            //关闭进程
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.ftp.tryConnect" id="apidoc.element.jdf.ftp.tryConnect">
        function <span class="apidocSignatureSpan">jdf.ftp.</span>tryConnect
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">tryConnect = function () {
    var _promise = {};
    _promise.done = function(cb) {
        _promise._done = cb;
        return _promise;
    };
    _promise.err = function(cb) {
        _promise._err = function(){
            ftp.client.end();
            cb();
        }
        return _promise;
    };


    if (ftp.client.connected) {
        _promise._done();
    } else {
        ftp.client.on(&#x27;ready&#x27;, function(err) {
            _promise._done();
        }).on(&#x27;error&#x27;, function(err) {
            try{
                _promise._err(err);
            }catch(e){
                console.log(&#x27;jdf error [ftp.tryConnect] ftp配置错误&#x27;);
            }
        });
        ftp.client.connect(options);

    }
    return _promise;

}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @param {Boole} move false 移动
 * @example ftp.upload(&#x27;../test&#x27;,&#x27;test&#x27;, null, null, false, false, false, function(){});
 */

ftp.upload = function(source, target, include, exclude, uncover, move, logTag, callback) {
    //打开进程

    ftp.<span class="apidocCodeKeywordSpan">tryConnect</span>().done(function() {
        ftp.uploadMain(source, target, include, exclude, uncover, move, logTag, callback);
    }).err(function(err) {
        console.log(&#x27;jdf error [ftp.upload] - &#x27; + err);

    });
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.ftp.upload" id="apidoc.element.jdf.ftp.upload">
        function <span class="apidocSignatureSpan">jdf.ftp.</span>upload
        <span class="apidocSignatureSpan">(source, target, include, exclude, uncover, move, logTag, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">upload = function (source, target, include, exclude, uncover, move, logTag, callback) {
    //打开进程

    ftp.tryConnect().done(function() {
        ftp.uploadMain(source, target, include, exclude, uncover, move, logTag, callback);
    }).err(function(err) {
        console.log(&#x27;jdf error [ftp.upload] - &#x27; + err);

    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

/**
 * @上传文件夹/文件
 * @param {String} source 原始文件夹/文件路径
 * @param {String} target 远端机器目标文件夹/文件路径
 * @param {Boole} uncover false
 * @param {Boole} move false 移动
 * @example ftp.<span class="apidocCodeKeywordSpan">upload</span>(&#x27;../test&#x27;,&#x27;test&#x27;, null, null, false, false
, false, function(){});
 */

ftp.upload = function(source, target, include, exclude, uncover, move, logTag, callback) {
//打开进程

ftp.tryConnect().done(function() {
    ftp.uploadMain(source, target, include, exclude, uncover, move, logTag, callback);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.ftp.uploadMain" id="apidoc.element.jdf.ftp.uploadMain">
        function <span class="apidocSignatureSpan">jdf.ftp.</span>uploadMain
        <span class="apidocSignatureSpan">(source, target, include, exclude, uncover, move, logTag, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">uploadMain = function (source, target, include, exclude, uncover, move, logTag, callback) {
    var removedAll = true;
    var source = f.realpath(source);
    if (source) {
        var core = function() {
            if (f.isDir(source)) {
                if (!f.isBlankDir(source)) {
                    ftp.client.mkdir(target, false, function() {});
                    fs.readdirSync(source).forEach(function(name) {
                            if (name != &#x27;.&#x27; &#x26;&#x26; name != &#x27;..&#x27; &#x26;&#x26; !(/.svn/.test(name))) {
                                removedAll = ftp.uploadMain(source + &#x27;/&#x27; + name, target + &#x27;/&#x27; + name, include, exclude, uncover,
move, logTag, callback) &#x26;&#x26; removedAll;
                            }
                        });

                        if (move &#x26;&#x26; removedAll) {
                            fs.rmdirSync(source);
                        }
                }
            } else if (f.isFile(source) &#x26;&#x26; f.filter(source, include, exclude)) {
                uploadLocalNum += 1;


                if (uncover /*&#x26;&#x26; f.exists(target)*/ ) {
                    //uncover
                    removedAll = false;
                } else {
                    ftp.put(source, target, function(err) {
                        uploadRemoteNum += 1;
                        if (uploadLocalNum == uploadRemoteNum) {
                            if (callback){

                                callback(err);
                            }
                            //关闭进程
                            ftp.client.end();
                        }

                    });

                    if (move) {
                        fs.unlinkSync(source);
                    }
                }
            } else {
                removedAll = false;
            }
        }
        core();
    } else {
        if (typeof(logTag) != &#x27;undefined&#x27; &#x26;&#x26; !logTag) {
            return;
        }
        console.log(&#x27;[ &#x27; + source + &#x27; ] --- no such file or dir&#x27;);
    }
    return removedAll;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @example ftp.upload(&#x27;../test&#x27;,&#x27;test&#x27;, null, null, false, false, false, function(){});
 */

ftp.upload = function(source, target, include, exclude, uncover, move, logTag, callback) {
    //打开进程

    ftp.tryConnect().done(function() {
        ftp.<span class="apidocCodeKeywordSpan">uploadMain</span>(source, target, include, exclude, uncover, move, logTag, callback
);
    }).err(function(err) {
        console.log(&#x27;jdf error [ftp.upload] - &#x27; + err);

    });
}

/**
...</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.jdf.ftpUpload" id="apidoc.module.jdf.ftpUpload">module jdf.ftpUpload</a></h1>


    <h2>
        <a href="#apidoc.element.jdf.ftpUpload.init" id="apidoc.element.jdf.ftpUpload.init">
        function <span class="apidocSignatureSpan">jdf.ftpUpload.</span>init
        <span class="apidocSignatureSpan">(argv, hasConfig, haslog, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">init = function (argv, hasConfig, haslog, callback){
	var haslog = typeof(haslog) == &#x27;undefined&#x27; ? true : haslog;
	var hasConfig = typeof(hasConfig) == &#x27;undefined&#x27; ? true : hasConfig;
	var ftp = {};
	var uploadSource = path.normalize(f.currentDir()+&#x27;/&#x27; + jdf.config.outputDirName);
	var uploadTarget = jdf.config.serverDir;

	//core function
	var ftpFn = function(source, target){
		//jdf u -c ./dist /export/App/xxx 172.xxx
		if(jdf.config.serverType  == &#x22;linux&#x22; || argv[6]){

			var fileUpload = require(&#x27;./fileUpload.js&#x27;);
			var sourceFilse = f.getdirlist(source, null, &#x27;.svn|Thumbs.db|.DS_Store&#x27; );
			var target = jdf.config.serverDir;
			var host = jdf.config.host;
			if(argv[5]) target = argv[5];
			if(argv[6]) host = argv[6];

			fileUpload(sourceFilse, target, host, argv, function(){
				jdf.dot.end(haslog);
				if(haslog) console.log(&#x27;jdf upload &#x22;&#x27;+host+&#x27; &#x27;+target+ &#x27;&#x22; success!&#x27;);
				if(callback) callback();
			});
		}else if(jdf.config.serverType  == &#x22;ftp&#x22; ){
			//console.log(&#x27;jdf process: uploading [&#x27; + source + &#x27;].&#x27;);
			ftp = require(&#x27;./ftp.js&#x27;);
			ftp.upload(source, target, null, null, null, null, null, function(err){
				jdf.dot.end(haslog);
				if(haslog) console.log(&#x27;jdf upload [&#x27;+jdf.config.host +&#x27;/&#x27;+ target+&#x27;] success!&#x27;);
				if(callback) callback();
			});
		}else{
			console.log(&#x27;jdf error [jdf.upload] - server host no setup&#x27;);
		}
	}
	
	//default upload,do &#x22;jdf output -html&#x22; first
	var outputFnOnce = function(){
		if (typeof(argv[3]) == &#x27;undefined&#x27;) {
			//argv[3] = &#x27;-html&#x27;;
		}
		jdf.argvInit(&#x27;output&#x27;, argv, function(){
			ftpFn(uploadSource, uploadTarget);
		});
	}

	//watch upload
	var outputFnWatch = function(){
		ftp.quit();
		jdf.buildMain(&#x27;output&#x27;);
		Output.init({
			//type:&#x27;hashtml&#x27;,
			callback:function(){
				ftpFn(uploadSource, uploadTarget);
			}
		});
	}
	
	if( (argv[3] == &#x27;-custom&#x27;||argv[3] == &#x27;-c&#x27;) &#x26;&#x26; argv[4] ){
		//custom upload	
		if ( f.exists(argv[4]) ) {
			var serverdir = argv[5] ? argv[5] : argv[4];
			console.log(&#x27;jdf uploading&#x27;);
			jdf.dot.begin();
			ftpFn(argv[4], serverdir);
		} else{
			console.log(&#x27;jdf warning [jdf.upload] - &#x22;&#x27;+argv[4]+&#x27;&#x22; not exists&#x27;);
		};
	}else{
		if(!hasConfig){
			console.log(&#x27;jdf error: &#x22;config.json&#x22; is not exists&#x27;);
			return;
		}

		if(jdf.config.host == JSON.parse(jdf.config.configJsonFileContent).host){
			console.log(&#x27;jdf error: config.json &#x22;host&#x22; is empty&#x27;);
			return;
		}
	
		//entrance
		if (argv[3] == &#x27;-watch&#x27;) {
			//watch upload
			outputFnOnce();
			Node_watch(f.currentDir(), function(filename) {
				console.log(filename);
				outputFnWatch();
			});
		}else if( (argv[3]==&#x27;-preview&#x27; || argv[3]==&#x27;-p&#x27; || argv[4]==&#x27;-preview&#x27; || argv[4]==&#x27;-p&#x27;) &#x26;&#x26; jdf.config.previewServerDir ){
			//preview
			if(argv[3] == &#x27;-preview&#x27; || argv[3] == &#x27;-p&#x27;){
				argv[3] = jdf.config.buildDirName;
			}
			
			jdf.argvInit(&#x27;output&#x27;, argv, function(){
				ftpFn(uploadSource, jdf.config.previewServerDir);
			});
		}else if( argv[3] == &#x27;-nc&#x27; &#x26;&#x26; jdf.config.newcdn ){
			//newcdn css/js/widget
			if (typeof(argv[4]) != &#x27;undefined&#x27;){
				argv[3] = argv[4];
				delete argv[4];
			}else{
				delete argv[3];
			}

			jdf.config.cdn = jdf.config.newcdn;
			outputFnOnce();
		}else if( argv[3] == &#x27;-nh&#x27; &#x26;&#x26; jdf.config.newcdn){
			//newcdn html
			argv[3] = jdf.config.buildDirName;
			//内链link src替换
			jdf.config.cdnDefalut = jdf.config.cdn;
			jdf.config.cdn = jdf.config.newcdn;
			jdf.argvInit(&#x27;output&#x27;, argv, function(){
				ftpFn(uploadSource, jdf.config.previewServerDir);
			});
		}else if(argv[3] == &#x27;-list&#x27; &#x26;&#x26; jdf.config.uploadList){
			// 根据config.json配置上传
			argv[3] = jdf.config.uploadList;
			jdf.argvInit(&#x27;output&#x27;, argv, function(){
				ftpFn(uploadSource, uploadTarget);
			});
		}else {
			//default upload
			outputFnOnce();
		}
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...



var jdf = require(&#x27;./lib/jdf.js&#x27;);

module.exports = {
	init: function(argv) {
		jdf.<span class="apidocCodeKeywordSpan">init</span>(argv);
	}
};
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.jdf.jdf" id="apidoc.module.jdf.jdf">module jdf.jdf</a></h1>


    <h2>
        <a href="#apidoc.element.jdf.jdf.argvInit" id="apidoc.element.jdf.jdf.argvInit">
        function <span class="apidocSignatureSpan">jdf.jdf.</span>argvInit
        <span class="apidocSignatureSpan">(runType, argv, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">argvInit = function (runType, argv, callback) {
    if (runType == &#x27;build&#x27; || runType == &#x27;release&#x27;) {
        if (runType == &#x27;build&#x27; &#x26;&#x26; typeof(argv[3]) != &#x27;undefined&#x27; &#x26;&#x26; argv[3] == &#x27;-css&#x27;) {
            jdf.buildCss();
        } else {
            var autoOpenurl = false,
                comboDebug = false;
            if (typeof(argv[3]) != &#x27;undefined&#x27;) {
                if (argv[3] == &#x27;-open&#x27; || argv[3] == &#x27;-o&#x27;) autoOpenurl = true;
                if (argv[3] == &#x27;-combo&#x27; || argv[3] == &#x27;-c&#x27;) comboDebug = true;
            }

            jdf.bgMkdir();
            jdf.bgCopyDir();
            jdf.buildMain(runType, argv[3] || argv[4]);

            //plain mode
            if(argv[3] == &#x27;-plain&#x27; || argv[4] == &#x27;-plain&#x27;){
                var outputdirName = jdf.config.outputDirName;
                var outputdir = outputdirName+&#x27;/&#x27;+jdf.getProjectPath();
                f.copy(jdf.bgCurrentDir, outputdir);

                console.log(&#x27;jdf build plain success!&#x27;);
            }else{
                console.log(&#x22;at precess:&#x3c;&#x3c;&#x22;+process.pid+&#x22;&#x3e;&#x3e;&#x22;);

                jdf.server(jdf.bgCurrentDir, autoOpenurl, comboDebug, function(data) {
                    jdf.watch(runType, callback, data);
                });
            }
        }
    } else if (runType == &#x27;output&#x27;) {
        // jdf.bgMkdir();
        // var _bgdir=jdf.bgCurrentDir+&#x22;_&#x22;+Math.random();
        // f.renameFile(jdf.bgCurrentDir,_bgdir);
        // console.log(_bgdir);
        // f.delAsync(_bgdir);
        // f.mkdir(jdf.bgCurrentDir);

        jdf.bgMkdir();
        f.del(jdf.bgCurrentDir, function() {
            jdf.bgCopyDir();
            jdf.buildMain(runType);
            //默认
            var outputType = &#x27;default&#x27;,
                projectPath = null,
                outputList, isbackup = false,
                isdebug = false;

            if (typeof(argv[3]) != &#x27;undefined&#x27;) {
                var cmd3 = argv[3];
                var cmd4 = argv[4];

                //custom自定义
                outputType = &#x27;custom&#x27;;
                outputList = cmd3;

                //projectPath自定义
                if (cmd3 == &#x27;-path&#x27;) {
                    projectPath = cmd4;
                    outputType = &#x27;default&#x27;;
                }

                //debug(不压缩)
                if (cmd3 == &#x27;-debug&#x27; || cmd4 == &#x27;-debug&#x27;) {
                    isdebug = true;
                    if (!cmd4) outputType = &#x27;default&#x27;;

                    //按配置项来输出
                    if (jdf.config.outputCustom) {
                        outputType = &#x27;custom&#x27;;
                        outputList = jdf.config.outputCustom;
                    }
                }

                //hashtml
                //if (cmd3 == &#x27;-html&#x27; || cmd4 == &#x27;-html&#x27;||cmd3 == &#x27;-h&#x27; || cmd4 == &#x27;-h&#x27;) {
                //    outputType = &#x27;hashtml&#x27;;
                //    outputList = null;
                //}

                //backup
                if (cmd3 == &#x27;-backup&#x27; || cmd4 == &#x27;-backup&#x27;) {
                    outputType = &#x27;backup&#x27;;
                    isbackup = true;
                    if (cmd4 == &#x27;-backup&#x27;) {
                        outputType = &#x27;custom&#x27;;
                        outputList = cmd3;
                    }
                }

                //prod(produce)预发布
                if (cmd3 == &#x27;-prod&#x27; || cmd4 == &#x27;-prod&#x27;) {
                    outputType = &#x27;prod&#x27;;
                    if (cmd4 == &#x27;-prod&#x27;) {
                        outputType = &#x27;prod&#x27;;
                        outputList = cmd3;
                    }
                }

                //pub(publish)正式发布
                if (cmd3 == &#x27;-pub&#x27; || cmd4 == &#x27;-pub&#x27;) {
                    outputType = &#x27;pub&#x27;;
                    if (cmd4 == &#x27;-pub&#x27;) {
                        outputType = &#x27;pub&#x27;;
                        outputList = cmd3;
                    }
                }

                //r.js
                if(cmd3 == &#x27;-rjs&#x27; || cmd4 == &#x27;-rjs&#x27;){
                    outputType = &#x27;default&#x27;;
                    jdf.config.output.rjs = true;
                }

            } else {
                //按配置项来输出
                if (jdf.config.outputCustom) { ...</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	}
	
	//default upload,do &#x22;jdf output -html&#x22; first
	var outputFnOnce = function(){
		if (typeof(argv[3]) == &#x27;undefined&#x27;) {
			//argv[3] = &#x27;-html&#x27;;
		}
		jdf.<span class="apidocCodeKeywordSpan">argvInit</span>(&#x27;output&#x27;, argv, function(){
			ftpFn(uploadSource, uploadTarget);
		});
	}

	//watch upload
	var outputFnWatch = function(){
		ftp.quit();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.jdf.bgCopyDir" id="apidoc.element.jdf.jdf.bgCopyDir">
        function <span class="apidocSignatureSpan">jdf.jdf.</span>bgCopyDir
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">bgCopyDir = function () {
    var excludeFiles = $.excludeFiles();

    if(jdf.config.build.excludeFiles){
        excludeFiles += &#x27;|&#x27; + jdf.config.build.excludeFiles;
    }

    excludeFiles = excludeFiles.replace(&#x27;||&#x27;,&#x27;|&#x27;)

    if (jdf.config.baseDir != &#x27;&#x27; || jdf.config.outputCustom) {
        f.copy(jdf.currentDir + &#x27;/&#x27; + jdf.config.baseDir, jdf.bgCurrentDir + &#x27;/&#x27; + jdf.config.baseDir, null, excludeFiles);
    }else{
        f.copy(jdf.currentDir + &#x27;/&#x27; + jdf.config.cssDir, jdf.bgCurrentDir + &#x27;/&#x27; + jdf.config.cssDir, null, excludeFiles);
        f.copy(jdf.currentDir + &#x27;/&#x27; + jdf.config.imagesDir, jdf.bgCurrentDir + &#x27;/&#x27; + jdf.config.imagesDir, null, excludeFiles);
        f.copy(jdf.currentDir + &#x27;/&#x27; + jdf.config.jsDir, jdf.bgCurrentDir + &#x27;/&#x27; + jdf.config.jsDir, null, excludeFiles);
        f.copy(jdf.currentDir + &#x27;/&#x27; + jdf.config.htmlDir, jdf.bgCurrentDir + &#x27;/&#x27; + jdf.config.htmlDir, null, excludeFiles);
        f.copy(jdf.currentDir + &#x27;/&#x27; + jdf.config.widgetDir, jdf.bgCurrentDir + &#x27;/&#x27; + jdf.config.widgetDir, null, excludeFiles);
        f.copy(jdf.currentDir + &#x27;/&#x27; + jdf.config.configFileName, jdf.bgCurrentDir + &#x27;/&#x27; + jdf.config.configFileName, null, excludeFiles
);
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    comboDebug = false;
if (typeof(argv[3]) != &#x27;undefined&#x27;) {
    if (argv[3] == &#x27;-open&#x27; || argv[3] == &#x27;-o&#x27;) autoOpenurl = true;
    if (argv[3] == &#x27;-combo&#x27; || argv[3] == &#x27;-c&#x27;) comboDebug = true;
}

jdf.bgMkdir();
jdf.<span class="apidocCodeKeywordSpan">bgCopyDir</span>();
jdf.buildMain(runType, argv[3] || argv[4]);

//plain mode
if(argv[3] == &#x27;-plain&#x27; || argv[4] == &#x27;-plain&#x27;){
    var outputdirName = jdf.config.outputDirName;
    var outputdir = outputdirName+&#x27;/&#x27;+jdf.getProjectPath();
    f.copy(jdf.bgCurrentDir, outputdir);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.jdf.bgMkdir" id="apidoc.element.jdf.jdf.bgMkdir">
        function <span class="apidocSignatureSpan">jdf.jdf.</span>bgMkdir
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">bgMkdir = function () {
    var list = [&#x27;LOCALAPPDATA&#x27;, &#x27;HOME&#x27;, &#x27;APPDATA&#x27;];
    var temp;
    for (var i = 0, len = list.length; i &#x3c; len; i++) {
        if (temp = process.env[list[i]]) {
            break;
        }
    }
    if (temp) {
        temp = temp || __dirname + &#x27;/../&#x27;;
        temp += &#x27;/.jdf-temp/&#x27;;
        temp = path.normalize(temp);
        f.mkdir(temp);

        //创建文件夹
        var creatDir = function(filename) {
            var dir = path.normalize(temp + &#x27;/&#x27; + filename + &#x27;/&#x27;);
            f.mkdir(dir);
            jdf[filename + &#x27;Dir&#x27;] = dir;
        };

        //项目缓存文件夹
        creatDir(&#x27;cache&#x27;);
        //项目temp文件夹
        creatDir(&#x27;temp&#x27;);
        //项目lib文件夹
        //todo:自动从服务器下载最新版的jdj和jdm,现在是需要install手动下载
        creatDir(&#x27;lib&#x27;);
        //creatDir(&#x27;jdj&#x27;);
        //creatDir(&#x27;jdm&#x27;);

        creatDir(&#x27;backup&#x27;);

        //复制当前项目至temp文件夹(除outputdir)
        //取得当前工程名
        var currentDirName = path.basename(jdf.currentDir);
        jdf.bgCurrentDir = path.normalize(jdf.tempDir + &#x27;/&#x27; + currentDirName);

        jdf.bgCurrentDirName = currentDirName;
        f.mkdir(jdf.bgCurrentDir);
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var autoOpenurl = false,
    comboDebug = false;
if (typeof(argv[3]) != &#x27;undefined&#x27;) {
    if (argv[3] == &#x27;-open&#x27; || argv[3] == &#x27;-o&#x27;) autoOpenurl = true;
    if (argv[3] == &#x27;-combo&#x27; || argv[3] == &#x27;-c&#x27;) comboDebug = true;
}

jdf.<span class="apidocCodeKeywordSpan">bgMkdir</span>();
jdf.bgCopyDir();
jdf.buildMain(runType, argv[3] || argv[4]);

//plain mode
if(argv[3] == &#x27;-plain&#x27; || argv[4] == &#x27;-plain&#x27;){
    var outputdirName = jdf.config.outputDirName;
    var outputdir = outputdirName+&#x27;/&#x27;+jdf.getProjectPath();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.jdf.buildCss" id="apidoc.element.jdf.jdf.buildCss">
        function <span class="apidocSignatureSpan">jdf.jdf.</span>buildCss
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">buildCss = function () {
    var BuildCss = require(&#x22;./buildCss.js&#x22;);
    var Node_watch = require(&#x27;node-watch&#x27;);

    console.log(&#x27;jdf buildCss ...&#x27;);
    var currentDir = jdf.currentDir;
    BuildCss.init(currentDir, currentDir);

    var regStr = &#x27;\\.(less|sass|scss)$&#x27;;
    var reg = new RegExp(regStr);

    Node_watch(currentDir, function(filename) {
        if (f.isFile(filename)) {
            if (!reg.test(filename)) return;
        }

        console.log(filename.replace(currentDir, &#x27;&#x27;));
        BuildCss.init(currentDir, currentDir);
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

/**
 * @输入命令的初始化 build, release, output
 */
jdf.argvInit = function(runType, argv, callback) {
if (runType == &#x27;build&#x27; || runType == &#x27;release&#x27;) {
    if (runType == &#x27;build&#x27; &#x26;&#x26; typeof(argv[3]) != &#x27;undefined&#x27; &#x26;&#x26; argv[3] == &#x27;-css&#x27
;) {
        jdf.<span class="apidocCodeKeywordSpan">buildCss</span>();
    } else {
        var autoOpenurl = false,
            comboDebug = false;
        if (typeof(argv[3]) != &#x27;undefined&#x27;) {
            if (argv[3] == &#x27;-open&#x27; || argv[3] == &#x27;-o&#x27;) autoOpenurl = true;
            if (argv[3] == &#x27;-combo&#x27; || argv[3] == &#x27;-c&#x27;) comboDebug = true;
        }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.jdf.buildMain" id="apidoc.element.jdf.jdf.buildMain">
        function <span class="apidocSignatureSpan">jdf.jdf.</span>buildMain
        <span class="apidocSignatureSpan">(type, param)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">buildMain = function (type, param) {
    if(jdf.config.build.hasCmdLog) console.log(&#x27;jdf build ...&#x27;);
    //console.log(&#x27;[&#x27;+$.getTime(&#x27;:&#x27;, false)+&#x27;] build ...&#x27;);

    //build css
    if(jdf.config.build.hasCmdLog) console.log(&#x27;jdf build css ...&#x27;);

    var BuildCss = require(&#x22;./buildCss.js&#x22;);
    if(jdf.config.outputCustom){
        var list = jdf.config.outputCustom;
        var listArray = list.split(&#x27;,&#x27;);
        for (var i=0; i&#x3c;listArray.length; i++ ){
            var item = listArray[i];
            if ( f.exists(item) ) {
                BuildCss.init(item, jdf.bgCurrentDir + &#x27;/&#x27; + item);
            }
        }
    }else{
        BuildCss.init(jdf.config.cssDir, jdf.bgCurrentDir + &#x27;/&#x27; + jdf.config.cssDir);
        BuildCss.init(jdf.config.widgetDir, jdf.bgCurrentDir + &#x27;/&#x27; + jdf.config.widgetDir);
    }

    //build es6 js
    if(jdf.config.build.isEs6){
        if(jdf.config.build.hasCmdLog) console.log(&#x27;jdf build js ...&#x27;);

        if(jdf.config.build.es6Entry){
            //config.json
            // &#x22;build&#x22;:{
            //     &#x22;isEs6&#x22;: true,
            //     &#x22;es6Entry&#x22;: {
            //         &#x22;index&#x22;: [&#x22;./js/index.js&#x22;],
            //         &#x22;list&#x22;: [&#x22;./js/list.js&#x22;]
            //     }
            // }

            // //unify entrance
            // var dist = type == &#x22;output&#x22;
            //     ? jdf.currentDir+ &#x27;/&#x27;+jdf.config.outputDirName+&#x27;/&#x27;+jdf.getProjectPath() + &#x27;/&#x27; + jdf.config.jsDir
            //     : jdf.bgCurrentDir + &#x27;/&#x27; + jdf.config.jsDir ;

            // // use webpack &#x26;&#x26; babel build es6
            // var BuildByWebpack = require(&#x27;./buildByWebpack.js&#x27;);
            // BuildByWebpack.init(
            //     jdf.currentDir + &#x27;/&#x27; ,
            //     jdf.config.build.es6Entry,
            //     dist,
            //     type == &#x22;output&#x22;
            // );
        }else{
            var BuildJs = require(&#x27;./BuildJs.js&#x27;);

            if(jdf.config.outputCustom) {
                var list = jdf.config.outputCustom;
                var listArray = list.split(&#x27;,&#x27;);
                for (var i=0; i&#x3c;listArray.length; i++ ){
                    var item = listArray[i];
                    if ( f.exists(item) ) {
                        BuildJs.init(item, jdf.bgCurrentDir);
                    }
                }
            }else{
                BuildJs.init(jdf.config.jsDir, jdf.bgCurrentDir);
                BuildJs.init(jdf.config.widgetDir, jdf.bgCurrentDir);
            }
        }
    }

    //build html (todo jdf.config.outputCustom)
    var buildHtmlDir = &#x27;/&#x27; + jdf.config.buildDirName + &#x27;/&#x27;;
    var buildHtmlDirFull = jdf.currentDir + buildHtmlDir;
    if (f.exists(buildHtmlDirFull)) {
        var BuildWidget = require(&#x22;./buildWidget.js&#x22;);
        if(jdf.config.build.hasCmdLog) console.log(&#x27;jdf build html...&#x27;);
        var encoding = jdf.config.output.encoding;
        var basedirlist = f.getdirlist(buildHtmlDirFull, &#x27;.html$&#x27;);
        basedirlist.forEach(function(source) {
            var target = path.normalize(jdf.bgCurrentDir + buildHtmlDir + source.replace(buildHtmlDirFull, &#x27;&#x27;));
            BuildWidget.init(source, f.read(source), type, function(data) {
                if(f.excludeFiles(target)){
                    f.write(target, data.tpl, encoding);
                }
                return &#x27;ok&#x27;;
            }, param);
            //require(&#x27;./buildByNunjucks&#x27;).init(source);
        });
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			ftpFn(uploadSource, uploadTarget);
		});
	}

	//watch upload
	var outputFnWatch = function(){
		ftp.quit();
		jdf.<span class="apidocCodeKeywordSpan">buildMain</span>(&#x27;output&#x27;);
		Output.init({
			//type:&#x27;hashtml&#x27;,
			callback:function(){
				ftpFn(uploadSource, uploadTarget);
			}
		});
	}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.jdf.checkProjectDir" id="apidoc.element.jdf.jdf.checkProjectDir">
        function <span class="apidocSignatureSpan">jdf.jdf.</span>checkProjectDir
        <span class="apidocSignatureSpan">(filename)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">checkProjectDir = function (filename) {
    var dirname = filename.replace(jdf.currentDir, &#x27;&#x27;);
    dirname = dirname.replace(/\\/, &#x27;&#x27;);
    if (/^\//.test(dirname)) dirname = dirname.replace(/\//, &#x27;&#x27;);

    var checkTag = false;
    var checkProjectDir = function(i, j) {
        var reg = new RegExp(&#x27;^&#x27; + i);
        if (reg.test(j)) {
            return true;
        } else {
            return false;
        }
    }

    if (checkProjectDir(jdf.config.baseDir, dirname) || checkProjectDir(jdf.config.htmlDir, dirname) || checkProjectDir(jdf.config
.widgetDir, dirname) || checkProjectDir(jdf.config.configFileName, dirname)) {
        checkTag = true;
    }
    return checkTag;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    Node_watch(jdf.currentDir, function(filename) {
//文件过滤
if (f.isFile(filename)) {
    if (!reg.test(filename)) return;
}

var target = jdf.bgCurrentDir + filename.replace(jdf.currentDir, &#x27;&#x27;);
if (jdf.<span class="apidocCodeKeywordSpan">checkProjectDir</span>(filename)) {
    if (f.exists(filename)) {
        f.copy(filename, target, regStr);
        //build
        jdf.buildMain(type);
        //livereload
        if (jdf.config.build.livereload) Livereload.reloadBrowser([target]);
        if (callback) callback(filename);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.jdf.clean" id="apidoc.element.jdf.jdf.clean">
        function <span class="apidocSignatureSpan">jdf.jdf.</span>clean
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">clean = function () {
    jdf.bgMkdir();
    f.del(jdf.tempDir, function() {
        console.log(&#x27;jdf cache dir clean done&#x27;);
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
            Log.send(&#x27;file format&#x27;);
            var FileFormat = require(&#x27;./fileFormat&#x27;);
            FileFormat.init(filename);

            //clean
        } else if (cmd2 === &#x27;clean&#x27;) {
            Log.send(&#x27;clean&#x27;);
            jdf.<span class="apidocCodeKeywordSpan">clean</span>();

            //todo: beautiful/jsbin/
        } else {
            console.log(&#x27;jdf error [jdf.init] invalid option: &#x27; + cmd2 + &#x27; \rType &#x22;jdf -h&#x22; for usage.&#
x27;);
        }
    });
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.jdf.createStandardDir" id="apidoc.element.jdf.jdf.createStandardDir">
        function <span class="apidocSignatureSpan">jdf.jdf.</span>createStandardDir
        <span class="apidocSignatureSpan">(dir)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">createStandardDir = function (dir) {
    var dirArray = [];
    dirArray[0] = jdf.config.baseDir;
    dirArray[1] = jdf.config.cssDir;
    dirArray[2] = jdf.config.imagesDir;
    dirArray[3] = jdf.config.jsDir;
    dirArray[4] = jdf.config.htmlDir;
    dirArray[5] = jdf.config.widgetDir;

    if(dir){
        dir += &#x27;/&#x27;;
    }else{
        dir = &#x27;jdf_init/&#x27;;
    }

    for (var i = 0; i &#x3c; dirArray.length; i++) {
        f.mkdir(dir+dirArray[i]);
    }

    var fileArray = [];
    fileArray[0] = jdf.config.configFileName;
    fileArray[1] = jdf.config.htmlDir + &#x27;/index.html&#x27;;

    var templateDir = path.resolve(__dirname, &#x27;../template/&#x27;);

    for (var i = 0; i &#x3c; fileArray.length; i++) {
        if (!f.exists(fileArray[i])) f.write(dir+&#x27;/&#x27;+fileArray[i], f.read(templateDir + &#x27;/&#x27; + fileArray[i]));
    }
    console.log(&#x27;jdf project directory &#x22;&#x27;+dir.replace(&#x27;/&#x27;,&#x27;&#x27;)+&#x27;&#x22; init done!&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    console.log(&#x27;jdf downloading&#x27;);
    jdf.download(&#x27;jdj&#x27;, jdf.libDir);
    jdf.download(&#x27;jdm&#x27;, jdf.libDir);
    */
    if (type == &#x27;demo&#x27;) {
        jdf.download(&#x27;demo&#x27;, jdf.currentDir, dir);
    } else if (type == &#x27;init&#x27;) {
        jdf.<span class="apidocCodeKeywordSpan">createStandardDir</span>(dir);
    }
}

/**
* @getIp
*/
jdf.getIp = function(){
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.jdf.download" id="apidoc.element.jdf.jdf.download">
        function <span class="apidocSignatureSpan">jdf.jdf.</span>download
        <span class="apidocSignatureSpan">(pathItem, targetDir)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">download = function (pathItem, targetDir) {
    var url = jdf.config[pathItem];
    var cacheDir = path.normalize(jdf.cacheDir + &#x27;/&#x27; + pathItem + &#x27;.tar&#x27;);

    console.log(&#x27;jdf downloading&#x27;);
    jdf.dot.begin();

    f.download(url, cacheDir, function(data) {
        if (data == &#x27;ok&#x27;) {
            f.tar(cacheDir, targetDir, function() {
                console.log(&#x27;\r\njdf [&#x27; + pathItem + &#x27;] install done&#x27;);
                jdf.dot.end(false);
            });
        } else if (data == &#x27;error&#x27;) {
            jdf.dot.end(false);
        }
    })
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
jdf.download = function(pathItem, targetDir) {
var url = jdf.config[pathItem];
var cacheDir = path.normalize(jdf.cacheDir + &#x27;/&#x27; + pathItem + &#x27;.tar&#x27;);

console.log(&#x27;jdf downloading&#x27;);
jdf.dot.begin();

f.<span class="apidocCodeKeywordSpan">download</span>(url, cacheDir, function(data) {
    if (data == &#x27;ok&#x27;) {
        f.tar(cacheDir, targetDir, function() {
            console.log(&#x27;\r\njdf [&#x27; + pathItem + &#x27;] install done&#x27;);
            jdf.dot.end(false);
        });
    } else if (data == &#x27;error&#x27;) {
        jdf.dot.end(false);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.jdf.getConfig" id="apidoc.element.jdf.jdf.getConfig">
        function <span class="apidocSignatureSpan">jdf.jdf.</span>getConfig
        <span class="apidocSignatureSpan">(callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getConfig = function (callback) {
    var res = null;
    var url = f.currentDir() + &#x27;/&#x27; + jdf.config.configFileName;
    if (f.exists(url)) {
        try {
            var data = f.read(url);
            if (data) {
                data = JSON.parse(data);
                if (typeof(data) == &#x27;object&#x27;) {
                    data = $.merageObj(jdf.config, data);
                }
                //console.log(data);
                res = data;
            }
            if (callback) callback(res);
        } catch (e) {
            console.log(&#x27;jdf error [jdf.getConfig] - config.json format error&#x27;);
            console.log(e);
            if (callback) callback(res);
        }
    } else {
        if (callback) callback(res);
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @commander
 */
jdf.init = function(argv) {
    //设置全局时间戳
    jdf.config.suffix = $.getTimestamp();

    //读取配置文件
    jdf.<span class="apidocCodeKeywordSpan">getConfig</span>(function(configData) {
var cmd2 = argv[2];
jdf.currentDir = f.currentDir();
jdf.config.argv=argv;

if (argv.length &#x3c; 3 || cmd2 === &#x27;-h&#x27; || cmd2 === &#x27;--help&#x27;) {
    Log.send(&#x27;help&#x27;);
    jdf.help();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.jdf.getIp" id="apidoc.element.jdf.jdf.getIp">
        function <span class="apidocSignatureSpan">jdf.jdf.</span>getIp
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getIp = function (){
    var net = require(&#x27;os&#x27;).networkInterfaces();
    for(var key in net){
        if(net.hasOwnProperty(key)){
            var items = net[key];
            if(items &#x26;&#x26; items.length){
                for(var i = 0; i &#x3c; items.length; i++){
                    var ip = String(items[i].address).trim();
                    if(ip &#x26;&#x26; /^\d+(?:\.\d+){3}$/.test(ip) &#x26;&#x26; ip !== &#x27;127.0.0.1&#x27;){
                        return ip;
                    }
                }
            }
        }
    }
    return &#x27;127.0.0.1&#x27;;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        homepage = &#x27;&#x27;;
    }
    require(&#x22;./openurl.js&#x22;).open(&#x27;http://localhost:&#x27; + localServerPort);
}
console.log(&#x27;jdf server : running at &#x27;+ localServerPort);
console.log(Colors.gray(&#x27;----------------------------------------&#x27;));
console.log(&#x27;   Local: &#x27;+Colors.magenta(&#x27;http://localhost:&#x27; + localServerPort + &#x27;/&#x27;));
var externalIp = &#x27;http://&#x27;+jdf.<span class="apidocCodeKeywordSpan">getIp</span>()+&#x27;:&#x27; + localServerPort + &#
x27;/&#x27;;
console.log(&#x27;External: &#x27;+Colors.magenta(externalIp));
console.log(Colors.gray(&#x27;----------------------------------------&#x27;));

if(jdf.config.build.qrcode != false){
    require(&#x22;qrcode-terminal&#x22;).generate(externalIp, { small: false }, function(qrcode){
        console.log(Colors.gray(qrcode));
        console.log(Colors.gray(&#x27;----------------------------------------&#x27;));
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.jdf.getLocalServerPort" id="apidoc.element.jdf.jdf.getLocalServerPort">
        function <span class="apidocSignatureSpan">jdf.jdf.</span>getLocalServerPort
        <span class="apidocSignatureSpan">(callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getLocalServerPort = function (callback){
    var localServerPort = jdf.config.localServerPort;
    jdf.scan(&#x27;localhost&#x27;, localServerPort, localServerPort, function(result) {
        if(result.length){
            jdf.scan(&#x27;localhost&#x27;, 3000, 3050, function(result) {
                var r = result.length == 0 ? 3000 : $.arrayMax(result) + 1;
                callback(r);
            });
        }else{
            callback(localServerPort);
        }
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
* @param {Boolse}  comboDebug 联调/线上调试模式
*/
jdf.server = function(currentDir, autoOpenurl, comboDebug, callback) {
var Server = require(&#x27;./server.js&#x27;);
// var FindPort = require(&#x27;./findPort&#x27;);
var Colors = require(&#x27;colors&#x27;);

jdf.<span class="apidocCodeKeywordSpan">getLocalServerPort</span>(function(localServerPort){
    if(jdf.config.build.hasBrowserSync){
        //use &#x22;browser-sync&#x22; server
        //doc https://browsersync.io/docs/options
        var bs = require(&#x22;browser-sync&#x22;).create();
        bs.watch(&#x22;*.html&#x22;).on(&#x22;change&#x22;, bs.reload);
        bs.watch(&#x22;*.js&#x22;).on(&#x22;change&#x22;, bs.reload);
        bs.watch(&#x22;*.css&#x22;).on(&#x22;change&#x22;, bs.reload);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.jdf.getProjectPath" id="apidoc.element.jdf.jdf.getProjectPath">
        function <span class="apidocSignatureSpan">jdf.jdf.</span>getProjectPath
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getProjectPath = function () {
    var currentDir = f.currentDir(),
        result = &#x27;&#x27;;
    if (jdf.config.projectPath != null) {
        result = jdf.config.projectPath;
    } else {
        result = path.basename(f.currentDir());
    }
    return result;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			var outputCss = &#x27;/&#x27; + jdf.config.cssDir+&#x27;/&#x27;+pkgName+&#x27;.css&#x27;;
			var outputJs = &#x27;/&#x27; + jdf.config.jsDir+&#x27;/&#x27;+pkgName+&#x27;.js&#x27;;

			var cssOutputDir = &#x27;/&#x27; + jdf.config.cssDir.replace(jdf.config.baseDir+&#x27;/&#x27;, &#x27;&#x27;) +&#x27;/&#x27;;
			var jsOutputDir = &#x27;/&#x27; + jdf.config.jsDir.replace(jdf.config.baseDir+&#x27;/&#x27;, &#x27;&#x27;) +&#x27;/&#x27;;
			if (isOutput) {
				if(jdf.config.cdn){
					outputCss = &#x27;/&#x27; +  jdf.<span class="apidocCodeKeywordSpan">getProjectPath</span>() + cssOutputDir+pkgName+&#x27;.
css&#x27;;
					outputCss = $.replaceSlash(outputCss);
					outputCss = jdf.config.cdn + outputCss;

					outputJs = &#x27;/&#x27; + jdf.getProjectPath() + jsOutputDir+pkgName+&#x27;.js&#x27;;
					outputJs = $.replaceSlash(outputJs);
					outputJs = jdf.config.cdn + outputJs;
				}else{
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.jdf.help" id="apidoc.element.jdf.jdf.help">
        function <span class="apidocSignatureSpan">jdf.jdf.</span>help
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">help = function () {
    var content = [];
    content = content.concat([
        &#x27;&#x27;,
        &#x27;  Usage: jdf &#x3c;Command&#x3e;&#x27;,
        &#x27;&#x27;,
        &#x27;  Command:&#x27;,
        &#x27;&#x27;,
        &#x27;    install      install init dir, demo&#x27;,
        //&#x27;  init         project directory init&#x27;,
        &#x27;    build        build project&#x27;,
        &#x27;      -open      auto open html/index.html&#x27;,
        &#x27;      -combo     combo debug for online/RD debug&#x27;,
        //&#x27;      -css       compile less/scss file in current dir&#x27;,
        // &#x27;      -plain     output project with plain&#x27;,
        // &#x27;&#x27;,
        //&#x27;    release      release project&#x27;,
        &#x27;&#x27;,
        &#x27;    output       output css/js/widget&#x27;,
        &#x27;      dirname    output your own custom dirname&#x27;,
        //&#x27;      -html      output css/js/widget/html&#x27;,
        &#x27;      -debug     output uncompressed js,css,images for test&#x27;,
        //&#x27;      -rjs      output project based requirejs&#x27;,
        //&#x27;      -backup    backup outputdir to tags dir&#x27;,
        //&#x27;      -path [p]  replace projectPath to specified path option&#x27;,
        &#x27;&#x27;,
        &#x27;    upload       upload css/js/widget dir to &#x22;serverDir&#x22;&#x27;,
        &#x27;      dirname    upload output your own custom dirname&#x27;,
        //&#x27;      -html      upload css/js/widget/html dir to &#x22;serverDir&#x22;&#x27;,
        &#x27;      -debug     upload uncompressed js,css,images for test&#x27;,
        &#x27;      -custom    upload a dir/file to server&#x27;,
        // &#x27;      -preview   upload html dir to remote &#x22;previewServerDir&#x22;&#x27;,
        //&#x27;      -nc        upload css/js dir to preview server dir use newcdn url&#x27;,
        //&#x27;      -nh        upload html dir to preview server dir use newcdn url&#x27;,
        //&#x27;      -list      upload file list from config.json to server&#x27;,
        &#x27;&#x27;,
        &#x27;    widget&#x27;,
        &#x27;      -all       preview all widget&#x27;,
        &#x27;      -list      get widget list from server&#x27;,
        &#x27;      -preview xxx  preview a widget&#x27;,
        &#x27;      -install xxx  install a widget to local&#x27;,
        &#x27;      -publish xxx  publish a widget to server&#x27;,
        &#x27;      -create xxx   create a widget to local&#x27;,
        //&#x27;    -w    watch upload output files to remote sever&#x27;,
        &#x27;&#x27;,
        &#x27;    server       debug for online/RD debug&#x27;,
        &#x27;    lint         file lint&#x27;,
        &#x27;    format       file formater&#x27;,
        &#x27; &#x27;,
        &#x27;  Extra commands:&#x27;,
        &#x27;&#x27;,
        &#x27;    compress     compress js/css (jdf compress input output)&#x27;,
        &#x27;    clean        clean cache folder&#x27;,
        &#x27;    -h           get help information&#x27;,
        &#x27;    -v           get the version number&#x27;,
        &#x27;&#x27;
    ]);
    console.log(content.join(&#x27;\n&#x27;));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    jdf.getConfig(function(configData) {
var cmd2 = argv[2];
jdf.currentDir = f.currentDir();
jdf.config.argv=argv;

if (argv.length &#x3c; 3 || cmd2 === &#x27;-h&#x27; || cmd2 === &#x27;--help&#x27;) {
    Log.send(&#x27;help&#x27;);
    jdf.<span class="apidocCodeKeywordSpan">help</span>();

} else if (cmd2 === &#x27;-v&#x27; || cmd2 === &#x27;--version&#x27;) {
    Log.send(&#x27;version&#x27;);
    jdf.version();

} else if (cmd2[0] === &#x27;-&#x27;) {
    Log.send(&#x27;help&#x27;);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.jdf.init" id="apidoc.element.jdf.jdf.init">
        function <span class="apidocSignatureSpan">jdf.jdf.</span>init
        <span class="apidocSignatureSpan">(argv)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">init = function (argv) {
    //设置全局时间戳
    jdf.config.suffix = $.getTimestamp();

    //读取配置文件
    jdf.getConfig(function(configData) {
        var cmd2 = argv[2];
        jdf.currentDir = f.currentDir();
        jdf.config.argv=argv;

        if (argv.length &#x3c; 3 || cmd2 === &#x27;-h&#x27; || cmd2 === &#x27;--help&#x27;) {
            Log.send(&#x27;help&#x27;);
            jdf.help();

        } else if (cmd2 === &#x27;-v&#x27; || cmd2 === &#x27;--version&#x27;) {
            Log.send(&#x27;version&#x27;);
            jdf.version();

        } else if (cmd2[0] === &#x27;-&#x27;) {
            Log.send(&#x27;help&#x27;);
            jdf.help();

        } else if (cmd2 === &#x27;b&#x27; || cmd2 === &#x27;build&#x27;) {
            Log.send(&#x27;build&#x27;);
            jdf.argvInit(&#x27;build&#x27;, argv);

        } else if (cmd2 === &#x27;r&#x27; || cmd2 === &#x27;release&#x27;) {
            Log.send(&#x27;release&#x27;);
            jdf.argvInit(&#x27;release&#x27;, argv);

        } else if (cmd2 === &#x27;o&#x27; || cmd2 === &#x27;output&#x27;) {
            Log.send(&#x27;output&#x27;);
            jdf.argvInit(&#x27;output&#x27;, argv);

        } else if (cmd2 === &#x27;u&#x27; || cmd2 === &#x27;upload&#x27;) {
            var FtpUpload = require(&#x27;./ftpUpload&#x27;);
            Log.send(&#x27;upload&#x27;);
            FtpUpload.init(argv, configData);

        } else if (cmd2 === &#x27;i&#x27; || cmd2 === &#x27;install&#x27;) {
            switch (argv[3]) {
                case &#x27;demo&#x27;:
                    Log.send(&#x27;install-demo&#x27;);
                    jdf.install(&#x27;demo&#x27;, argv[4]);
                    return;
                case &#x27;init&#x27;:
                    Log.send(&#x27;install-init&#x27;);
                    jdf.install(&#x27;init&#x27;, argv[4]);
                    return;
                default:
                    console.log(&#x27;You can &#x22;jdf install demo or &#x22;jdf install init&#x22;&#x27;);
            }

        } else if (cmd2 === &#x27;c&#x27; || cmd2 === &#x27;compress&#x27;) {
            var Compress = require(&#x27;./compress.js&#x27;);
            Log.send(&#x27;compress&#x27;);
            Compress.dir(argv[3], argv[4]);

            //widget
        } else if (cmd2 === &#x27;w&#x27; || cmd2 === &#x27;widget&#x27;) {
            var Widget = require(&#x22;./widget.js&#x22;);

            var cmd3 = argv[3],
                cmd4 = argv[4],
                cmd5 = argv[5];
            var force = cmd5 != &#x27;undefined&#x27; &#x26;&#x26; cmd5 == &#x27;-force&#x27; ? true : false

            if (cmd3 == &#x27;-all&#x27; || cmd3 == &#x27;-a&#x27;) {
                Log.send(&#x27;widget-all&#x27;);
                Widget.all(cmd4);
            }

            if (cmd3 == &#x27;-list&#x27; || cmd3 == &#x27;-l&#x27;) {
                Log.send(&#x27;widget-list&#x27;);
                Widget.list(cmd4);
            }

            var hasCmd4 = function() {
                if (cmd4) {
                    return true;
                } else {
                    console.log(&#x27;jdf tips [jdf.init] Please input widget name&#x27;);
                    return false;
                }
            }

            var widgetCmd = function() {
                var content = [];
                content = content.concat([
                    &#x27;&#x27;,
                    &#x27;  Command:&#x27;,
                    &#x27;&#x27;,
                    &#x27;    widget&#x27;,
                    &#x27;      -all     preview all widget&#x27;,
                    &#x27;      -list    get widget list from server&#x27;,
                    &#x27;      -preview xxx     preview a widget&#x27;,
                    &#x27;      -install xxx     install a widget to local&#x27;,
                    &#x27;      -publish xxx     publish a widget to server&#x27;,
                    &#x27;      -create  xxx     create a widget to local&#x27;,
                    &#x27;&#x27;
                ]);
                console.log(content.join(&#x27;\n&#x27;));
            }

            if (cmd3) {
                if (cmd3 == &#x27;-preview&#x27; || cmd3 == &#x27;-pre&#x27; &#x26;&#x26; hasCmd4()) {
                    Log.send(&#x27;widget-preview&#x27;);
                    Widget.preview(cmd4);

                } else if (cmd3 == &#x27;-install&#x27; || cmd3 == &#x27;-i&#x27; &#x26;&#x26; hasCmd4()) {
                    Log.send(&#x27;widget-install&#x27;);
                    Widget.install(cmd4, force);

                } else if (cmd3 == &#x27;-publish&#x27; || cmd3 == &#x27;-p&#x27; &#x26;&#x26; hasCmd4()) {
                    Log.send(&#x27;widget-publish&#x27;);
                    Widget.publish(cmd4, force);

                } else if ((cmd3 == &#x27;-create&#x27; || cmd3 == &#x27;-c&#x27;) &#x26;&#x26; hasCmd4()) {
                    Lo ...</pre></li>
    <li>example usage<pre class="apidocCodePre">...



var jdf = require(&#x27;./lib/jdf.js&#x27;);

module.exports = {
	init: function(argv) {
		jdf.<span class="apidocCodeKeywordSpan">init</span>(argv);
	}
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.jdf.install" id="apidoc.element.jdf.jdf.install">
        function <span class="apidocSignatureSpan">jdf.jdf.</span>install
        <span class="apidocSignatureSpan">(type, dir)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">install = function (type, dir) {
    jdf.bgMkdir();

<span class="apidocCodeCommentSpan">    /**
    widget模块安装走jdf widget -install widget/header
    console.log(&#x27;jdf downloading&#x27;);
    jdf.download(&#x27;jdj&#x27;, jdf.libDir);
    jdf.download(&#x27;jdm&#x27;, jdf.libDir);
    */
</span>    if (type == &#x27;demo&#x27;) {
        jdf.download(&#x27;demo&#x27;, jdf.currentDir, dir);
    } else if (type == &#x27;init&#x27;) {
        jdf.createStandardDir(dir);
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    Log.send(&#x27;upload&#x27;);
    FtpUpload.init(argv, configData);

} else if (cmd2 === &#x27;i&#x27; || cmd2 === &#x27;install&#x27;) {
    switch (argv[3]) {
        case &#x27;demo&#x27;:
            Log.send(&#x27;install-demo&#x27;);
            jdf.<span class="apidocCodeKeywordSpan">install</span>(&#x27;demo&#x27;, argv[4]);
            return;
        case &#x27;init&#x27;:
            Log.send(&#x27;install-init&#x27;);
            jdf.install(&#x27;init&#x27;, argv[4]);
            return;
        default:
            console.log(&#x27;You can &#x22;jdf install demo or &#x22;jdf install init&#x22;&#x27;);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.jdf.scan" id="apidoc.element.jdf.jdf.scan">
        function <span class="apidocSignatureSpan">jdf.jdf.</span>scan
        <span class="apidocSignatureSpan">(host, start, end, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">scan = function (host, start, end, callback) {
    var net = require(&#x27;net&#x27;);
    var count = end - start;
    var result = [];

    for (var i = start; i &#x3c;= end; i++) {
        var item = net.connect({
                host: host,
                port: i
            },
            function(i) {
                return function() {
                    result.push(i);
                    this.destroy();
                };
            }(i)
        );
 
        item.on(&#x27;error&#x27;, function(err) {
            if (err.errno == &#x27;ECONNREFUSED&#x27;) {
                this.destroy();
            }
        });
 
        item.on(&#x27;close&#x27;, function() {
            if (!count--) {
                callback(result);
            }
        });
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}

/**
 * @取localServerPort
 */
jdf.getLocalServerPort = function(callback){
var localServerPort = jdf.config.localServerPort;
jdf.<span class="apidocCodeKeywordSpan">scan</span>(&#x27;localhost&#x27;, localServerPort, localServerPort, function(result) {
    if(result.length){
        jdf.scan(&#x27;localhost&#x27;, 3000, 3050, function(result) {
            var r = result.length == 0 ? 3000 : $.arrayMax(result) + 1;
            callback(r);
        });
    }else{
        callback(localServerPort);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.jdf.server" id="apidoc.element.jdf.jdf.server">
        function <span class="apidocSignatureSpan">jdf.jdf.</span>server
        <span class="apidocSignatureSpan">(currentDir, autoOpenurl, comboDebug, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">server = function (currentDir, autoOpenurl, comboDebug, callback) {
    var Server = require(&#x27;./server.js&#x27;);
    // var FindPort = require(&#x27;./findPort&#x27;);
    var Colors = require(&#x27;colors&#x27;);

    jdf.getLocalServerPort(function(localServerPort){
        if(jdf.config.build.hasBrowserSync){
            //use &#x22;browser-sync&#x22; server
            //doc https://browsersync.io/docs/options
            var bs = require(&#x22;browser-sync&#x22;).create();
            bs.watch(&#x22;*.html&#x22;).on(&#x22;change&#x22;, bs.reload);
            bs.watch(&#x22;*.js&#x22;).on(&#x22;change&#x22;, bs.reload);
            bs.watch(&#x22;*.css&#x22;).on(&#x22;change&#x22;, bs.reload);
            bs.init({
                server: currentDir,
                port: localServerPort,
                ui: {
                    // port: 3001, //81 error
                    weinre: {
                        // port: 8080
                    }
                }
            });
            if (callback) callback(1);
        }else{
            var Compress = require(&#x27;./compress.js&#x27;);
            Server.init( currentDir, localServerPort, jdf.config.cdn, jdf.getProjectPath(), comboDebug, Compress.addJsDepends);

            if (typeof(autoOpenurl) != &#x27;undefined&#x27; &#x26;&#x26; autoOpenurl) {
                var homepage = &#x27;/&#x27; + jdf.config.htmlDir + &#x27;/index.html&#x27;;
                if (!f.exists(jdf.currentDir + homepage)) {
                    homepage = &#x27;&#x27;;
                }
                require(&#x22;./openurl.js&#x22;).open(&#x27;http://localhost:&#x27; + localServerPort);
            }
            console.log(&#x27;jdf server : running at &#x27;+ localServerPort);
            console.log(Colors.gray(&#x27;----------------------------------------&#x27;));
            console.log(&#x27;   Local: &#x27;+Colors.magenta(&#x27;http://localhost:&#x27; + localServerPort + &#x27;/&#x27;));
            var externalIp = &#x27;http://&#x27;+jdf.getIp()+&#x27;:&#x27; + localServerPort + &#x27;/&#x27;;
            console.log(&#x27;External: &#x27;+Colors.magenta(externalIp));
            console.log(Colors.gray(&#x27;----------------------------------------&#x27;));

            if(jdf.config.build.qrcode != false){
                require(&#x22;qrcode-terminal&#x22;).generate(externalIp, { small: false }, function(qrcode){
                    console.log(Colors.gray(qrcode));
                    console.log(Colors.gray(&#x27;----------------------------------------&#x27;));
                });
            }

            console.log(&#x27;Current files from: &#x27;+jdf.currentDir);
            console.log(&#x27;Serving files from: &#x27;+currentDir);
            if (callback) callback(1);
        }
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    //extra commands
    //server
} else if (cmd2 === &#x27;server&#x27;) {
    Log.send(&#x27;server&#x27;);
    if (argv[3]) {
        jdf.config.localServerPort = argv[3];
    };
    jdf.<span class="apidocCodeKeywordSpan">server</span>(f.currentDir())

    //file lint
} else if (cmd2 === &#x27;lint&#x27; || cmd2 === &#x27;l&#x27;) {
    var cmd3 = argv[3];
    var filename = (typeof(cmd3) == &#x27;undefined&#x27;) ? f.currentDir() : cmd3;
    Log.send(&#x27;file lint&#x27;);
    var FileLint = require(&#x27;./fileLint&#x27;);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.jdf.version" id="apidoc.element.jdf.jdf.version">
        function <span class="apidocSignatureSpan">jdf.jdf.</span>version
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">version = function () {
    var notifier = updateNotifier({
        pkg,
        updateCheckInterval: 0
    });

    // console.log(notifier);

    notifier.notify();

    if (notifier.update) {
        console.log(notifier.update);
    } else {
        console.log(pkg.version);
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

if (argv.length &#x3c; 3 || cmd2 === &#x27;-h&#x27; || cmd2 === &#x27;--help&#x27;) {
    Log.send(&#x27;help&#x27;);
    jdf.help();

} else if (cmd2 === &#x27;-v&#x27; || cmd2 === &#x27;--version&#x27;) {
    Log.send(&#x27;version&#x27;);
    jdf.<span class="apidocCodeKeywordSpan">version</span>();

} else if (cmd2[0] === &#x27;-&#x27;) {
    Log.send(&#x27;help&#x27;);
    jdf.help();

} else if (cmd2 === &#x27;b&#x27; || cmd2 === &#x27;build&#x27;) {
    Log.send(&#x27;build&#x27;);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.jdf.watch" id="apidoc.element.jdf.jdf.watch">
        function <span class="apidocSignatureSpan">jdf.jdf.</span>watch
        <span class="apidocSignatureSpan">(type, callback, data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">watch = function (type, callback, data) {
    var Node_watch = require(&#x27;node-watch&#x27;);
    var Livereload = require(&#x27;./livereloadServer&#x27;);

    if (!data) {
        //如果有另外一个进程那么livereload会直接关闭
        jdf.config.build.livereload = false;
        //console.log(&#x22;another jdf process running , jdf livereload closed&#x22;);
    }

    //livereload
    if (jdf.config.build.livereload) Livereload.init();

    var regStr = &#x27;\\.(vm|tpl|shtml|html|smarty|js|css|less|sass|scss|json|babel|&#x27; + $.imageFileType() + &#x27;)$&#x27;;
    var reg = new RegExp(regStr);

    //todo初始化时前后台文件夹同步
    Node_watch(jdf.currentDir, function(filename) {
        //文件过滤
        if (f.isFile(filename)) {
            if (!reg.test(filename)) return;
        }

        var target = jdf.bgCurrentDir + filename.replace(jdf.currentDir, &#x27;&#x27;);
        if (jdf.checkProjectDir(filename)) {
            if (f.exists(filename)) {
                f.copy(filename, target, regStr);
                //build
                jdf.buildMain(type);
                //livereload
                if (jdf.config.build.livereload) Livereload.reloadBrowser([target]);
                if (callback) callback(filename);
            } else {
                f.del(target, function() {
                    if (callback) callback(filename);
                });
            }
        }
    });

    if (callback) callback();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
            f.copy(jdf.bgCurrentDir, outputdir);

            console.log(&#x27;jdf build plain success!&#x27;);
        }else{
            console.log(&#x22;at precess:&#x3c;&#x3c;&#x22;+process.pid+&#x22;&#x3e;&#x3e;&#x22;);

            jdf.server(jdf.bgCurrentDir, autoOpenurl, comboDebug, function(data) {
                jdf.<span class="apidocCodeKeywordSpan">watch</span>(runType, callback, data);
            });
        }
    }
} else if (runType == &#x27;output&#x27;) {
    // jdf.bgMkdir();
    // var _bgdir=jdf.bgCurrentDir+&#x22;_&#x22;+Math.random();
    // f.renameFile(jdf.bgCurrentDir,_bgdir);
...</pre></li>
    </ul>






</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.jdf.livereloadServer" id="apidoc.module.jdf.livereloadServer">module jdf.livereloadServer</a></h1>


    <h2>
        <a href="#apidoc.element.jdf.livereloadServer.init" id="apidoc.element.jdf.livereloadServer.init">
        function <span class="apidocSignatureSpan">jdf.livereloadServer.</span>init
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">init = function (options) {
	var key, opts, value;
	if ( typeof(options) == &#x27;undefined&#x27; ) {
		var options = {};
	}
	opts = {
		apiVersion: &#x27;1.6&#x27;,
		//host: &#x27;0.0.0.0&#x27;,
		port: &#x27;35729&#x27;// 不能变
	};

	for (key in opts) {
		value = opts[key];
		if (options[key]) {
			opts[key] = options[value];
		}
	}

	this.conns = [];
	this.web = null;
	this.options = opts;

	console.log(&#x22;LiveReload is waiting for a browser to connect&#x22;);
	var connectTag = true;
	this.start(function(){
		if (connectTag) {
			console.log(&#x27;Browser connected LiveReload&#x27;);
		}
		connectTag = false;
	});
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...



var jdf = require(&#x27;./lib/jdf.js&#x27;);

module.exports = {
	init: function(argv) {
		jdf.<span class="apidocCodeKeywordSpan">init</span>(argv);
	}
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.livereloadServer.reloadBrowser" id="apidoc.element.jdf.livereloadServer.reloadBrowser">
        function <span class="apidocSignatureSpan">jdf.livereloadServer.</span>reloadBrowser
        <span class="apidocSignatureSpan">(paths)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">reloadBrowser = function (paths) {
	var conn, data, _i, _len, _results;
	if (paths == null) {
		paths = [];
	}
	//console.log(&#x22;Reloading browser: &#x22; + (paths.join(&#x27; &#x27;)));
	_results = [];
	for (_i = 0, _len = paths.length; _i &#x3c; _len; _i++) {
		path = paths[_i];
		data = {
			command: &#x27;reload&#x27;,
			path: path,
			liveCSS: true,
			liveImg: true
		};
		_results.push((function() {
			var _j, _len1, _ref, _results1;
			_ref = this.conns;
			_results1 = [];
			for (_j = 0, _len1 = _ref.length; _j &#x3c; _len1; _j++) {
				conn = _ref[_j];
				_results1.push(conn.send(JSON.stringify(data)));
			}
			return _results1;
		}).call(this));
	}
	return _results;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var target = jdf.bgCurrentDir + filename.replace(jdf.currentDir, &#x27;&#x27;);
if (jdf.checkProjectDir(filename)) {
    if (f.exists(filename)) {
        f.copy(filename, target, regStr);
        //build
        jdf.buildMain(type);
        //livereload
        if (jdf.config.build.livereload) Livereload.<span class="apidocCodeKeywordSpan">reloadBrowser</span>([target]);
        if (callback) callback(filename);
    } else {
        f.del(target, function() {
            if (callback) callback(filename);
        });
    }
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.livereloadServer.start" id="apidoc.element.jdf.livereloadServer.start">
        function <span class="apidocSignatureSpan">jdf.livereloadServer.</span>start
        <span class="apidocSignatureSpan">(callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">start = function (callback) {
	var conns, web, wss;
	//console.log(&#x22;LiveReload &#x22; + this.options.apiVersion + &#x22; is waiting for a browser to connect.&#x22;);
	conns = this.conns;

	web = http.createServer(function(request, response) {
		var body, exists, existsFuc, file, query, read;
		query = url.parse(request.url, true);
		existsFuc = fs.existsSync ? fs.existsSync: path.existsSync;
		file = &#x22;&#x22; + livereloadPath + query.pathname;
		exists = existsFuc(file);
		if (exists &#x26;&#x26; query.pathname !== &#x27;/&#x27;) {
			response.writeHead(200, {
				&#x27;Transfer-Encoding&#x27;: &#x27;chunked&#x27;,
				&#x27;Content-Type&#x27;: &#x27;application/x-javascript&#x27;
			});
			read = fs.createReadStream(file);
			return read.pipe(response);
		} else {
			body = &#x27;Not Found&#x27;;
			response.writeHead(404, {
				&#x27;Content-Length&#x27;: body.length,
				&#x27;Content-Type&#x27;: &#x27;text/plain&#x27;
			});
			return response.end(body);
		}
	});

	web.listen(this.options.port, this.options.host);
	this.web = web;

	wss = new WSServer({
		server: web,
		path: &#x27;/livereload&#x27;
	});
	
	wss.on(&#x27;connection&#x27;,function(ws) {
		if(callback) callback();
		//console.log(&#x27;Browser connected.&#x27;);
		conns.push(ws);

		ws.on(&#x27;message&#x27;, function(msg, flag) {
			var handshake, protocols;
			msg = JSON.parse(msg);
			if (msg.command === &#x27;hello&#x27;) {
				protocols = msg.protocols;
				protocols.push(&#x27;http://livereload.com/protocols/2.x-remote-control&#x27;);
				protocols.push(&#x27;http://livereload.com/protocols/official-7&#x27;);
				handshake = {
					&#x27;command&#x27;: &#x27;hello&#x27;,
					&#x27;protocols&#x27;: protocols,
					&#x27;serverName&#x27;: &#x27;livereload-node&#x27;
				};
				ws.send(JSON.stringify(handshake));
			}
			if (msg.command === &#x27;info&#x27; &#x26;&#x26; msg[&#x27;url&#x27;]) {
				//return console.log(&#x22;Browser URL: &#x22; + msg.url);
			}
		});
		
		ws.on(&#x27;close&#x27;,function() {
			conns.splice(conns.indexOf(ws, 1));
			//return console.log(&#x27;Browser disconnected.&#x27;);
		});
	});
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
};

Connector.prototype._scheduleReconnection = function() {
  if (!this._connectionDesired) {
    return;
  }
  if (!this._reconnectTimer.running) {
    this._reconnectTimer.<span class="apidocCodeKeywordSpan">start</span>(this._nextDelay);
    return this._nextDelay = Math.min(this.options.maxdelay, this._nextDelay * 2);
  }
};

Connector.prototype.sendCommand = function(command) {
  if (this.protocol == null) {
    return;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.livereloadServer.stop" id="apidoc.element.jdf.livereloadServer.stop">
        function <span class="apidocSignatureSpan">jdf.livereloadServer.</span>stop
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">stop = function () {
	return this.web.close(function() {
		if (this.web) {
			return console.log(&#x27;Shutdown the server.&#x27;);
		}
	});
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
this._uri = &#x22;ws://&#x22; + this.options.host + &#x22;:&#x22; + this.options.port + &#x22;/livereload&#x22;;
this._nextDelay = this.options.mindelay;
this._connectionDesired = false;
this.protocol = 0;
this.protocolParser = new Parser({
  connected: function(protocol) {
    _this.protocol = protocol;
    _this._handshakeTimeout.<span class="apidocCodeKeywordSpan">stop</span>();
    _this._nextDelay = _this.options.mindelay;
    _this._disconnectionReason = &#x27;broken&#x27;;
    return _this.handlers.connected(protocol);
  },
  error: function(e) {
    _this.handlers.error(e);
    return _this._closeOnError();
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.jdf.openurl" id="apidoc.module.jdf.openurl">module jdf.openurl</a></h1>


    <h2>
        <a href="#apidoc.element.jdf.openurl.open" id="apidoc.element.jdf.openurl.open">
        function <span class="apidocSignatureSpan">jdf.openurl.</span>open
        <span class="apidocSignatureSpan">(url, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function open(url, callback) {
    var child = spawn(command, [url]);
    var errorText = &#x22;&#x22;;
    child.stderr.setEncoding(&#x27;utf8&#x27;);
    child.stderr.on(&#x27;data&#x27;, function (data) {
        errorText += data;
    });
    child.stderr.on(&#x27;end&#x27;, function () {
        if (errorText.length &#x3e; 0) {
            var error = new Error(errorText);
            if (callback) {
                callback(error);
            } else {
                throw error;
            }
        } else if (callback) {
            callback(error);
        }
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
Server.init( currentDir, localServerPort, jdf.config.cdn, jdf.getProjectPath(), comboDebug, Compress.addJsDepends);

if (typeof(autoOpenurl) != &#x27;undefined&#x27; &#x26;&#x26; autoOpenurl) {
    var homepage = &#x27;/&#x27; + jdf.config.htmlDir + &#x27;/index.html&#x27;;
    if (!f.exists(jdf.currentDir + homepage)) {
        homepage = &#x27;&#x27;;
    }
    require(&#x22;./openurl.js&#x22;).<span class="apidocCodeKeywordSpan">open</span>(&#x27;http://localhost:&#x27; + localServerPort
);
}
console.log(&#x27;jdf server : running at &#x27;+ localServerPort);
console.log(Colors.gray(&#x27;----------------------------------------&#x27;));
console.log(&#x27;   Local: &#x27;+Colors.magenta(&#x27;http://localhost:&#x27; + localServerPort + &#x27;/&#x27;));
var externalIp = &#x27;http://&#x27;+jdf.getIp()+&#x27;:&#x27; + localServerPort + &#x27;/&#x27;;
console.log(&#x27;External: &#x27;+Colors.magenta(externalIp));
console.log(Colors.gray(&#x27;----------------------------------------&#x27;));
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.jdf.output" id="apidoc.module.jdf.output">module jdf.output</a></h1>


    <h2>
        <a href="#apidoc.element.jdf.output.init" id="apidoc.element.jdf.output.init">
        function <span class="apidocSignatureSpan">jdf.output.</span>init
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">init = function (options){
	// console.log(options);
	
	if(jdf.config.build.hasCmdLog) console.log(&#x27;jdf output ...&#x27;);	
	
	var type = options.type,
		list = options.list,
		isbackup = options.isbackup,
		isdebug = options.isdebug,
		callback = options.callback;

	var outputdirName = jdf.config.outputDirName;
	var outputComment = jdf.config.output.comment;
	var encoding = jdf.config.output.encoding;
	var excludeFiles = jdf.config.output.excludeFiles;
		excludeFiles = excludeFiles ? excludeFiles + &#x27;|.vm|.scss|.less|.psd&#x27; : &#x27;.vm|.scss|.less|.psd&#x27;;

	var weinre = jdf.config.build.weinre;
	var outputdir = outputdirName+&#x27;/&#x27;+ (options.projectPath || jdf.getProjectPath());
	var isbackup = typeof(isbackup) == &#x27;undefined&#x27; ? false : isbackup;
	
	//[notice]输出路径暂不可配置
	var cssDir = path.normalize( jdf.bgCurrentDir + &#x27;/&#x27; + jdf.config.cssDir );
	var imagesDir = path.normalize( jdf.bgCurrentDir + &#x27;/&#x27; + jdf.config.imagesDir );
	var jsDir =  path.normalize( jdf.bgCurrentDir + &#x27;/&#x27; + jdf.config.jsDir );
	var htmlDir = path.normalize( jdf.bgCurrentDir + &#x27;/&#x27; + jdf.config.htmlDir );
	var widgetDir = path.normalize( jdf.bgCurrentDir + &#x27;/&#x27; + jdf.config.widgetDir );

	var debugHtml = &#x27;&#x27;;
	if(weinre){
		fs.readdirSync(htmlDir).forEach(function(name){
			var pathname = path.join(htmlDir, name);
			if(f.isFile(pathname)){
				debugHtml += &#x27;&#x3c;li style=&#x22;padding-bottom:0.2em;&#x22;&#x3e;&#x3c;a target=&#x22;_blank&#x22; href=&#x22;&#x27;+mobileWeinre(pathname)+&#x27;&#x22;&#x3e;&#x27;+name+&#x27;&#x3c;/a&#x3e;&#x3c;/li&#x3e;&#x27;;
			}
		});

		debugHtml = &#x27;&#x3c;ul&#x3e;&#x27;+debugHtml+&#x27;&#x3c;/ul&#x3e;&#x27;;

		f.write(path.join(htmlDir, &#x27;_debug.html&#x27;), debugHtml);
	}

	var core = function() {
		var logText = &#x27;jdf output success!&#x27;;
		var copyDefaultDir = function(){
			//jdf.config.baseDir是一期目录规划的问题
			var cssOutputDir = outputdir + &#x27;/&#x27; + jdf.config.cssDir.replace(jdf.config.baseDir+&#x27;/&#x27;, &#x27;&#x27;);
			var imagesOutputDir = outputdir + &#x27;/&#x27; + jdf.config.imagesDir;
			if(jdf.config.baseDir != &#x27;&#x27;){
				imagesOutputDir = outputdir + &#x27;/&#x27; + jdf.config.imagesDir.replace(jdf.config.baseDir+&#x27;/&#x27;, &#x27;&#x27;);
			}
			var jsOutputDir = outputdir + &#x27;/&#x27; + jdf.config.jsDir.replace(jdf.config.baseDir+&#x27;/&#x27;, &#x27;&#x27;);

			//图片目录不位于css/i中
			if(jdf.config.imagesDir.split(jdf.config.cssDir).length  == 1 ){
				f.copy(imagesDir, imagesOutputDir);
			}
			
			f.copy(cssDir, cssOutputDir, &#x27;(css|&#x27;+$.imageFileType()+&#x27;)$&#x27;, (excludeFiles ? excludeFiles : &#x27;(less|scss)$&#x27;), null, null, null
, encoding);
			
			if(!jdf.config.build.es6Entry){
				f.copy(jsDir, jsOutputDir, (isdebug ? &#x27;(js|map)$&#x27; : &#x27;js$&#x27;), (excludeFiles ? excludeFiles : &#x27;babel$&#x27;), null, null, null, encoding
);
			}

			f.copy(htmlDir, outputdir+&#x27;/&#x27;+ (
				jdf.config.outputHtmlDir == null
				? jdf.config.htmlDir
				: jdf.config.outputHtmlDir
			), null, excludeFiles, null, null, null, encoding);

			// 输出widget todo 可配置
			var outputWidgetDir = outputdir+&#x27;/&#x27;+jdf.config.widgetDir;
			f.copy(widgetDir, outputWidgetDir,  &#x27;(js|css|&#x27;+$.imageFileType()+(isdebug ? &#x27;|map&#x27; : &#x27;&#x27;) + &#x27;)$&#x27;, (excludeFiles ? excludeFiles
 : &#x27;(less|scss|psd)$&#x27;), null, null, null, encoding);
			
			if(f.exists(widgetDir)){
				
				//将所有widget/images复制到html/images
				fs.readdirSync(widgetDir).forEach(function(dir){
					var source = widgetDir + &#x27;/&#x27; + dir;
					if(f.isDir(source) &#x26;&#x26; f.exists(source + &#x27;/images&#x27;) ){
						f.mkdir(jdf.config.htmlDir+&#x27;/images&#x27;);
						f.copy(source + &#x27;/images&#x27;, outputdir + &#x27;/&#x27; + jdf.config.htmlDir+ &#x27;/images&#x27;, null, null, null, null, null, encoding);
					};
				});

				//复制到widget的目标目录之后，再将空目录删除
				fs.readdirSync(outputWidgetDir).forEach(function(dir){
					var realpath = fs.realpathSync(outputWidgetDir + &#x27;/&#x27; + dir);
					var dirs = fs.readdirSync(realpath);
					var files = f.getdirlist(realpath);

					if(files.length == 0 &#x26;&#x26; dirs.length == 0){
						fs.rmdirSync(realpath);
					}
				});

				//combineWidgetCss下widget中的图片widgert/a/i/a.png输出至css/i/目录下
				if (jdf.config.output.combineWidgetCss){
					f.mkdir(imagesOutputDir);
					var imgList = f.getdirlist(widgetDir, $.imageFileType()+&#x27;$&#x27;);
					imgList.forEach(function(imgListItem){
						f.copy(imgListItem, imagesOutputDir+&#x27;/&#x27;+ path.basename(imgListItem), null, null, null, null, null, encoding); ...</pre></li>
    <li>example usage<pre class="apidocCodePre">...



var jdf = require(&#x27;./lib/jdf.js&#x27;);

module.exports = {
	init: function(argv) {
		jdf.<span class="apidocCodeKeywordSpan">init</span>(argv);
	}
};
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.jdf.server" id="apidoc.module.jdf.server">module jdf.server</a></h1>


    <h2>
        <a href="#apidoc.element.jdf.server.copyright" id="apidoc.element.jdf.server.copyright">
        function <span class="apidocSignatureSpan">jdf.server.</span>copyright
        <span class="apidocSignatureSpan">(port)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">copyright = function (port){
	var serverIp = server.getIp()+&#x27;:&#x27;+port;
	var copyright = &#x27;&#x3c;p&#x3e;&#x3c;strong style=&#x22;font-size:1.2em&#x22;&#x3e;jdf server &#x3c;/strong&#x3e;&#x27;+
		&#x27; &#x3c;strong&#x3e;IP&#x3c;/strong&#x3e; &#x3c;a href=&#x22;http://&#x27;+serverIp+&#x27;&#x22;&#x3e;&#x27;+serverIp+&#x27;&#x3c;/a&#x3e;   &#x27;+	
		//&#x27;&#x3c;span style=&#x22;font-size:0.8em&#x22;&#x3e;&#x27;+new Date()+&#x27;&#x3c;/span&#x3e;  &#x27;+
	&#x27;&#x3c;/p&#x3e;&#x27;;
	return copyright;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			realPath = realPath.replace(replacePath,&#x27;&#x27;);
		}

		var response404 = function (){
			response.writeHead(404, {
				&#x27;Content-Type&#x27;: &#x27;text/html&#x27;
			});
			response.write(&#x27;&#x3c;meta charset=UTF-8&#x3e;&#x3c;meta name=viewport content=&#x22;width=device-width,initial-scale=1,
maximum-scale=1,user-scalable=no&#x22;&#x3e;&#x3c;center&#x3e;&#x3c;h1&#x3e;404 Not Found&#x3c;/h1&#x3e;&#x3c;/center&#x3e;&#x3c
;hr&#x3e;&#x3c;center&#x3e;&#x27;+server.<span class="apidocCodeKeywordSpan">copyright</span>(PORT)+&#x27;&#x3c;/center&#x3e;&#x27
;);
			response.end();
		}

		fs.exists(realPath, function (exists) {
			var cdnUrl = cdn+pathname;
			if(!exists){
				response404();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.server.getDirList" id="apidoc.element.jdf.server.getDirList">
        function <span class="apidocSignatureSpan">jdf.server.</span>getDirList
        <span class="apidocSignatureSpan">(realPath, pathname, port)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getDirList = function (realPath, pathname, port){
	// console.log(realPath);
	var dirname = &#x27;/&#x27;;
	var html = &#x27;&#x3c;li style=&#x22;padding-bottom:5px;&#x22;&#x3e;&#x3c;a href=&#x22;../&#x22;&#x3e;../&#x3c;/a&#x3e;&#x3c;/li&#x3e;&#x27;;
	realPath = path.normalize(realPath);
	pathname += &#x27;/&#x27;;
	pathname = pathname.replace(/\/\//,&#x27;&#x27;);

	fs.readdirSync(realPath).forEach(function(name){
		if( !/.Ds_Store$/.test(name) ){
			// console.log(name);
			var url = pathname +&#x27;/&#x27;+name;
			url = url.replace(/\/\//g,&#x27;/&#x27;);
			url = encodeURI(url);
			dirname = path.dirname(url);
			if(f.isDir(&#x27;.&#x27;+url)){
				url = url + &#x27;/&#x27;;
				name = name + &#x27;/&#x27;;
			}

			html += &#x27;&#x3c;li style=&#x22;padding-bottom:0.2em;&#x22;&#x3e;&#x3c;a href=&#x22;&#x27;+url+&#x27;&#x22;&#x3e;&#x27;+name+&#x27;&#x3c;/a&#x3e;&#x3c;/li&#x3e;&#x27;;
		}
	})

	html = &#x27;&#x3c;ul&#x3e;&#x27; +html+ &#x27;&#x3c;/ul&#x3e;&#x27;;
	html = &#x27;&#x3c;!DOCTYPE html&#x3e;&#x3c;html&#x3e;&#x3c;head&#x3e;&#x3c;meta charset=UTF-8&#x3e;&#x3c;meta name=viewport content=&#x22;width=device-width,initial-scale=1,maximum-
scale=1,user-scalable=no&#x22;&#x3e;&#x3c;h1&#x3e;Index of &#x27;+dirname+&#x27;&#x3c;/h1&#x3e;&#x3c;hr/&#x3e;&#x27;+html+&#x27;&#x3c;hr/&#x3e; &#x27;+server.copyright(port);
	return html;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
							});
							response.end(err);
						} else {
							response.writeHead(200, {
								&#x27;Content-Type&#x27;: &#x22;text/html&#x22;
							});

							var html = server.<span class="apidocCodeKeywordSpan">getDirList</span>(realPath, pathname, PORT);
							response.end(html, &#x22;binary&#x22;);
						}
					});
				}

				if(f.isFile(realPath)){
					var ext = path.extname(realPath);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.server.getIp" id="apidoc.element.jdf.server.getIp">
        function <span class="apidocSignatureSpan">jdf.server.</span>getIp
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getIp = function (){
	var net = require(&#x27;os&#x27;).networkInterfaces();
    for(var key in net){
        if(net.hasOwnProperty(key)){
            var items = net[key];
            if(items &#x26;&#x26; items.length){
                for(var i = 0; i &#x3c; items.length; i++){
                    var ip = String(items[i].address).trim();
                    if(ip &#x26;&#x26; /^\d+(?:\.\d+){3}$/.test(ip) &#x26;&#x26; ip !== &#x27;127.0.0.1&#x27;){
                        return ip;
                    }
                }
            }
        }
    }
    return &#x27;127.0.0.1&#x27;;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        homepage = &#x27;&#x27;;
    }
    require(&#x22;./openurl.js&#x22;).open(&#x27;http://localhost:&#x27; + localServerPort);
}
console.log(&#x27;jdf server : running at &#x27;+ localServerPort);
console.log(Colors.gray(&#x27;----------------------------------------&#x27;));
console.log(&#x27;   Local: &#x27;+Colors.magenta(&#x27;http://localhost:&#x27; + localServerPort + &#x27;/&#x27;));
var externalIp = &#x27;http://&#x27;+jdf.<span class="apidocCodeKeywordSpan">getIp</span>()+&#x27;:&#x27; + localServerPort + &#
x27;/&#x27;;
console.log(&#x27;External: &#x27;+Colors.magenta(externalIp));
console.log(Colors.gray(&#x27;----------------------------------------&#x27;));

if(jdf.config.build.qrcode != false){
    require(&#x22;qrcode-terminal&#x22;).generate(externalIp, { small: false }, function(qrcode){
        console.log(Colors.gray(qrcode));
        console.log(Colors.gray(&#x27;----------------------------------------&#x27;));
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.server.init" id="apidoc.element.jdf.server.init">
        function <span class="apidocSignatureSpan">jdf.server.</span>init
        <span class="apidocSignatureSpan">(serverCurrentDir, port, cdn, replacePath, comboDebug, addJsDepends, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">init = function (serverCurrentDir, port, cdn, replacePath, comboDebug, addJsDepends, callback){

	if (typeof(port) != &#x27;undefined&#x27;) {
		PORT = port;
	}

	if (typeof(comboDebug) == &#x27;undefined&#x27;) {
		comboDebug = false;
	}

	var config = http.createServer(function (request, response) {
		var requestUrl = request.url;
		var isComboUrl = /\?\?/.test(requestUrl);
		var pathname = url.parse(requestUrl).pathname;

		if (typeof(serverCurrentDir) == &#x27;undefined&#x27;) {
			var realPath = fs.realpathSync(&#x27;.&#x27;) +&#x27;/&#x27;+ pathname;
		}else {
			var realPath = serverCurrentDir +&#x27;/&#x27;+ pathname;
		}
		realPath = decodeURI(realPath);

		var ext = path.extname(realPath);
		ext = ext ? ext.slice(1) : &#x27;unknown&#x27;;

		if(isComboUrl){
			<span class="apidocCodeCommentSpan">/**
				??a.js,b.js计算.js扩展名
				??a.css,b.css计算.css扩展名
			*/
</span>			var comboUrlTemp = requestUrl.split(&#x27;,&#x27;);
			ext = path.extname(comboUrlTemp[comboUrlTemp.length-1]);
			ext = ext ? ext.slice(1) : &#x27;unknown&#x27;;
		}

		if(typeof(replacePath) != &#x27;undefined&#x27; &#x26;&#x26; comboDebug){
			//替换掉路径中projectPath, 有风险吗?
			realPath = realPath.replace(replacePath,&#x27;&#x27;);
		}

		var response404 = function (){
			response.writeHead(404, {
				&#x27;Content-Type&#x27;: &#x27;text/html&#x27;
			});
			response.write(&#x27;&#x3c;meta charset=UTF-8&#x3e;&#x3c;meta name=viewport content=&#x22;width=device-width,initial-scale=1,maximum-scale=1,user-scalable
=no&#x22;&#x3e;&#x3c;center&#x3e;&#x3c;h1&#x3e;404 Not Found&#x3c;/h1&#x3e;&#x3c;/center&#x3e;&#x3c;hr&#x3e;&#x3c;center&#x3e;&#x27;+server.copyright(PORT)+&#x27;&#x3c;/center&#x3e;&#x27;);
			response.end();
		}

		fs.exists(realPath, function (exists) {
			var cdnUrl = cdn+pathname;
			if(!exists){
				response404();
				return;
			}
			if (isComboUrl) {
				//cdn检测同名文件
				//todo增加短路径支持 requestUrl
				cdnUrl = requestUrl;

				var contentType = mine[ext] || &#x22;text/plain&#x22;;
				var fileContent = &#x27;&#x27;;

				//以??先分隔为数组
				var comboUrl = requestUrl.split(&#x27;??&#x27;);
				var comboFile = [];

				if(comboUrl.length &#x3e; 0){
					//将头尾的斜杠去掉
					// comboUrl[0] = comboUrl[0].replace(/^\//, &#x27;&#x27;).replace(/\/$/, &#x27;&#x27;);

					if(comboUrl[1]){
						//以逗号将文件名称分隔为数组
						comboFile = comboUrl[1].split(&#x27;,&#x27;);
					}
				}

				comboFile.forEach(function(file){
					var fileDir = &#x27;&#x27;;
					var content = &#x27;&#x27;;

					//将头尾的斜杠去掉
					file = file.replace(/^\//, &#x27;&#x27;).replace(/\/$/, &#x27;&#x27;);
					if(comboUrl[0] !== &#x27;&#x27;){
						fileDir = comboUrl[0] + &#x27;/&#x27; + file;
					}else{
						fileDir = file;
					}

					var currentDir = serverCurrentDir + fileDir;
					if(f.exists(currentDir)){
						content = f.read(currentDir);
						if( typeof(addJsDepends) == &#x27;function&#x27; ){
							content = addJsDepends(currentDir);
						}

						//如果代码的末尾没有分号，则自动添加一个。以避免代码合并出现异常。
						if(!/[;\r\n]$/.test(content) &#x26;&#x26; ext == &#x27;js&#x27;){
							content += &#x27;;&#x27;;
						}
						fileContent += content;
					}else{
						fileDir = cdnUrl + fileDir;
						response404();
					}
				});

				response.writeHead(200, {
					&#x27;Content-Type&#x27;: contentType
				});
				response.write(fileContent);
				response.end();

			} else {
				if(f.isDir(realPath)){
					fs.readdir(realPath, function (err, file) {
						if (err) {
							response.writeHead(500, {
								&#x27;Content-Type&#x27;: mine.html
							});
							response.end(err);
						} else {
							response.writeHead(200, {
								&#x27;Content-Type&#x27;: &#x22;text/html&#x22;
							});

							var html = server.getDirList(realPath, pathname, PORT);
							response.end(html, &#x22;binary&#x22;);
						}
					});
				}

				if(f.isFile(realPath)){
					var ext = path.extname(realPath);
					ext = ext.replace(&#x27;.&#x27;, &#x27;&#x27;);
					var contentType = mine[ext] || &#x22;text/plain&#x22;;
					var content = fs.readFileSync(realPath);

    				response.writeHead(200, {
						&#x27;Content-Type&#x27;: contentType
					});

					response.end(content);
				}
			}
		});
	});
	
	config.listen(PORT, function(err){
		if(callback) callback(1);
	});

	config.on(&#x27;error&#x27;, function(err){
		if(callback) callback(0);
	});
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...



var jdf = require(&#x27;./lib/jdf.js&#x27;);

module.exports = {
	init: function(argv) {
		jdf.<span class="apidocCodeKeywordSpan">init</span>(argv);
	}
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.server.joinbuffers" id="apidoc.element.jdf.server.joinbuffers">
        function <span class="apidocSignatureSpan">jdf.server.</span>joinbuffers
        <span class="apidocSignatureSpan">(bufferStore)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">joinbuffers = function (bufferStore) {
    var length = bufferStore.reduce(function(previous, current) {
        return previous + current.length;
    }, 0);

    var data = new Buffer(length);
    var startPos = 0;
    bufferStore.forEach(function(buffer){
        buffer.copy(data, startPos);
        startPos += buffer.length;
    });
    return data;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.jdf.vm" id="apidoc.module.jdf.vm">module jdf.vm</a></h1>


    <h2>
        <a href="#apidoc.element.jdf.vm.parse" id="apidoc.element.jdf.vm.parse">
        function <span class="apidocSignatureSpan">jdf.vm.</span>parse
        <span class="apidocSignatureSpan">(str, dirname)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">parse = function (str, dirname){
	var dirname = typeof dirname == &#x27;undefined&#x27; ? &#x27;&#x27; : dirname;
	var arr = str.match(/^(&#x3c;!--){0}\s*#parse\([\&#x22;|\&#x27;](.*?)[\&#x22;|\&#x27;]\)(\s\n\r)*(--&#x3e;){0}/gmi);
	var res = {
		vm:[],
		tpl:[],
		js:[],
		css:[]
	};
	
	if (arr) {
		for (var i =0  ; i&#x3c;arr.length  ; i++ ){
			var temp = arr[i].match(/#parse\([\&#x22;|\&#x27;](.*?)[\&#x22;|\&#x27;]\)/);
			if(temp){
				var basename = temp[1];
				if (basename) {
					var source  = dirname + basename;
					source = path.normalize(source);

					var dirname1 = path.dirname(source);
					var dirlist1 = f.getdirlist(dirname1);
					
					dirlist1.forEach(function(item){
						var item = item.replace(jdf.currentDir, &#x27;&#x27;);
						item = item.replace(/\\/g,&#x27;/&#x27;);
						
						if($.is.vm(item)){
							res.vm.push(item);
						}

						if($.is.tpl(item)){
							res.tpl.push(item);
						}

						if($.is.css(item)||$.is.less(item)||$.is.sass(item)){
							res.css.push($.getCssExtname(item));
						}

						if($.is.js(item)){
							res.js.push(item);
						}
					});

					if (f.exists(source)) {
						var content = f.read(source);
						if (content) {
							//替换
							str = str.replace(temp[0], content);
						}
					}
				}
			}
		}
	}

	return {
		content:str,
		url:res
	};
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
						var fileUrlDirname = path.dirname(fileUrl)+&#x27;/&#x27;;
						var dataSourceContent={};
						var dataSourceUrl = fileUrlDirname+widgetName+$.is.dataSourceSuffix ;

						try {
							if (f.exists(dataSourceUrl)) {
								var temp = f.read(dataSourceUrl);
								if (temp &#x26;&#x26; temp != &#x27;&#x27;)  dataSourceContent = JSON.<span class="apidocCodeKeywordSpan">parse</span>(temp
);
							}
						} catch (e) {
							console.log(dataSourceUrl);
							console.log(e);
							return;
						}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.vm.rander" id="apidoc.element.jdf.vm.rander">
        function <span class="apidocSignatureSpan">jdf.vm.</span>rander
        <span class="apidocSignatureSpan">(vmSource, dataObj, dirname)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">rander = function (vmSource, dataObj, dirname){
	if (vmSource &#x26;&#x26; dataObj) {
		var vmTpm = vm.parse(vmSource, dirname);
		return {
			content:Velocity.render(vmTpm.content, dataObj),
			url:vmTpm.url
		};
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
						}

						var dataObj = $.merageObj( dataSourceContent, widgetDataObj);
						
						//vm处理
						try {
							if (dataObj &#x26;&#x26; vmContent &#x26;&#x26; jdf.config.output.vm){
								var vmRander =  Vm.<span class="apidocCodeKeywordSpan">rander</span>(vmContent, dataObj, fileUrlDirname);
								
								//vm继承js/css
								if(vmRander.url.js){
									vmRander.url.js.forEach(function(item){
										 jsCompileFn(item);
									})
								}
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.jdf.widget" id="apidoc.module.jdf.widget">module jdf.widget</a></h1>


    <h2>
        <a href="#apidoc.element.jdf.widget.all" id="apidoc.element.jdf.widget.all">
        function <span class="apidocSignatureSpan">jdf.widget.</span>all
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">all = function () {
    jdf.bgMkdir();

    var htmlDir = jdf.config.htmlDir;
    f.mkdir(htmlDir);

    var target = htmlDir + &#x27;/allwidget.html&#x27;;

    var widgetDir = f.currentDir() + &#x27;/&#x27; + jdf.config.widgetDir;
    if (!f.exists(widgetDir)) {
        console.log(&#x27;jdf error widget not exists&#x27;);
        return;
    }

    var core = function() {
        var widgetListHtml = &#x27;&#x27;;
        fs.readdirSync(widgetDir).forEach(function(item) {
            if (f.excludeFiles(item)) {
                widgetListHtml += &#x27;{%widget name=&#x22;&#x27; + item + &#x27;&#x22;%}\r\n&#x27;;
            }
        });

        var result = widget.templete(&#x27;\r\n&#x27; + widgetListHtml, jdf.getProjectPath() + &#x27; - all widget preview&#x27;);
        f.write(target, result);
    }

    core();
    jdf.argvInit(&#x27;build&#x27;, &#x27;-open&#x27;, function() {
        //todo watch
        //core();
        Openurl.open(&#x27;http://localhost:&#x27; + jdf.config.localServerPort + &#x27;/&#x27; + target);
        console.log(&#x27;jdf open you broswer to see it&#x27;);
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var cmd3 = argv[3],
    cmd4 = argv[4],
    cmd5 = argv[5];
var force = cmd5 != &#x27;undefined&#x27; &#x26;&#x26; cmd5 == &#x27;-force&#x27; ? true : false

if (cmd3 == &#x27;-all&#x27; || cmd3 == &#x27;-a&#x27;) {
    Log.send(&#x27;widget-all&#x27;);
    Widget.<span class="apidocCodeKeywordSpan">all</span>(cmd4);
}

if (cmd3 == &#x27;-list&#x27; || cmd3 == &#x27;-l&#x27;) {
    Log.send(&#x27;widget-list&#x27;);
    Widget.list(cmd4);
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.widget.create" id="apidoc.element.jdf.widget.create">
        function <span class="apidocSignatureSpan">jdf.widget.</span>create
        <span class="apidocSignatureSpan">(name)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">create = function (name) {
    var widgetDir = &#x27;widget/&#x27; + name;
    if (f.exists(widgetDir)) {
        console.log(&#x27;jdf warnning : widget [&#x27; + name + &#x27;] is exists&#x27;);
        return;
    }

    console.log(&#x27;jdf tips: if you create it, input &#x22;y&#x22; else input &#x22;n&#x22; &#x27;);
    var Prompt = require(&#x27;simple-prompt&#x27;);
    var questions = [{
        question: &#x27;vm&#x27;,
        required: true
    }, {
        question: &#x27;js&#x27;
    }, {
        question: &#x27;scss&#x27;
    }, {
        question: &#x27;json&#x27;
    }];
    var profile = new Prompt(questions);
    profile.create().then(function(error, answers) {
        if (error) {
            return;
        }
        var createFilesArray = [&#x27;component.json&#x27;];
        if (answers.vm == &#x27;y&#x27;) createFilesArray.push(name + &#x27;.vm&#x27;);
        if (answers.js == &#x27;y&#x27;) createFilesArray.push(name + &#x27;.js&#x27;);
        if (answers.scss == &#x27;y&#x27;) createFilesArray.push(name + &#x27;.scss&#x27;);
        if (answers.json == &#x27;y&#x27;) createFilesArray.push(name + &#x27;.json&#x27;);

        f.mkdir(widgetDir);
        //jdf.config.widget.createFiles
        createFilesArray.forEach(function(item) {
            f.write(widgetDir + &#x27;/&#x27; + item, &#x27;&#x27;);
        });

        //给compoent.json写入默认的内容
        var componentJson = &#x27;{\r\n&#x27; +
            &#x27;   &#x22;name&#x22;: &#x22;&#x27; + name + &#x27;&#x22;,\r\n&#x27; +
            &#x27;   &#x22;version&#x22;: &#x22;1.0.0&#x22;,\r\n&#x27; +
            &#x27;   &#x22;dependencies&#x22;: {}\r\n&#x27; +
            &#x27;}&#x27;;
        f.write(widgetDir + &#x27;/component.json&#x27;, componentJson);

        console.log(&#x27;jdf widget [&#x27; + name + &#x27;] create done&#x27;);
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

    } else if (cmd3 == &#x27;-publish&#x27; || cmd3 == &#x27;-p&#x27; &#x26;&#x26; hasCmd4()) {
        Log.send(&#x27;widget-publish&#x27;);
        Widget.publish(cmd4, force);

    } else if ((cmd3 == &#x27;-create&#x27; || cmd3 == &#x27;-c&#x27;) &#x26;&#x26; hasCmd4()) {
        Log.send(&#x27;widget-create&#x27;);
        Widget.<span class="apidocCodeKeywordSpan">create</span>(cmd4);

    }
}

if (!cmd3) {
    widgetCmd();
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.widget.hasWidget" id="apidoc.element.jdf.widget.hasWidget">
        function <span class="apidocSignatureSpan">jdf.widget.</span>hasWidget
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">hasWidget = function (path) {
    var reg = new RegExp(jdf.config.widgetDir, &#x27;gm&#x27;);
    return reg.test(path);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.widget.install" id="apidoc.element.jdf.widget.install">
        function <span class="apidocSignatureSpan">jdf.widget.</span>install
        <span class="apidocSignatureSpan">(name, force)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">install = function (name, force) {
    var force = typeof(force) == &#x27;undefined&#x27; ? false : force;
    var ftp = require(&#x27;./ftp.js&#x27;);

    ftp.tryConnect().done(function() {
        download(name, force);
    });

    function download(name, force) {

        var source = jdf.config.widgetServerDir + &#x27;/widget/&#x27; + name;
        var target = f.currentDir() + &#x27;/widget/&#x27; + name;
        var widgetname = name;

        ftp.listMain(source, function(data) {
            if (data != &#x27;error&#x27;) {
                var version = &#x27;&#x27;;
                data.forEach(function(item) {
                    version = item.name;
                })

                if (!parseInt(version)) {
                    version = &#x27;&#x27;;
                }

                var widgetNameVersion = widgetname + &#x27;/&#x27; + version;

                if (f.exists(target) &#x26;&#x26; !force) {
                    ftp.client.end();
                    console.log(&#x27;jdf warnning widget [&#x27; + widgetname + &#x27;] is exists in current project&#x27;);
                } else {

                    downloadMain(source + &#x27;/&#x27; + version, target, function(data) {
                        if (data == &#x27;error&#x27;) {
                            console.log(&#x27;jdf warnning widget [&#x27; + widgetNameVersion + &#x27;] is not exists on server &#x27;);
                        } else {
                            console.log(&#x27;jdf widget [&#x27; + widgetNameVersion + &#x27;] install done from server &#x27;);
                        }
                        f.readJSON(target + &#x27;/component.json&#x27;, function(data) {
                            for (name in data.dependencies) {
                                download(name, force);
                            }
                            ftp.client.end();
                        });
                    });
                }
            } else {
                console.log(&#x27;jdf error [widget.install] ftp error!&#x27;);
            }
        });
    }

    function downloadMain(source, target, callback, isEnd) {
        ftp.listMain(source, function(data) {
            if (data != &#x27;error&#x27;) {
                f.mkdir(target);
                var serverNum = 0,
                    localNum = 0;
                data.forEach(function(item) {
                    if (item.type == &#x27;file&#x27;) {
                        serverNum += 1;
                        var sourcePut = source + &#x27;/&#x27; + item.name;
                        var targetPut = target + &#x27;/&#x27; + item.name;

                        ftp.get(sourcePut, targetPut, function() {
                            localNum += 1;
                            if (serverNum == localNum) {
                                if (callback) callback();
                            }
                        });
                    }
                })
            } else {
                if (callback) callback(data);
            };
        });
    }

}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    Log.send(&#x27;upload&#x27;);
    FtpUpload.init(argv, configData);

} else if (cmd2 === &#x27;i&#x27; || cmd2 === &#x27;install&#x27;) {
    switch (argv[3]) {
        case &#x27;demo&#x27;:
            Log.send(&#x27;install-demo&#x27;);
            jdf.<span class="apidocCodeKeywordSpan">install</span>(&#x27;demo&#x27;, argv[4]);
            return;
        case &#x27;init&#x27;:
            Log.send(&#x27;install-init&#x27;);
            jdf.install(&#x27;init&#x27;, argv[4]);
            return;
        default:
            console.log(&#x27;You can &#x22;jdf install demo or &#x22;jdf install init&#x22;&#x27;);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.widget.list" id="apidoc.element.jdf.widget.list">
        function <span class="apidocSignatureSpan">jdf.widget.</span>list
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">list = function () {
    var publishDir = jdf.config.widgetServerDir + &#x27;/widget&#x27;;

    var ftp = require(&#x27;./ftp.js&#x27;);
    ftp.list(publishDir, function(data) {
        if (data) {
            console.log(&#x27;jdf widget list: &#x27;);
            console.log(&#x27;----------------&#x27;);
            data.forEach(function(item) {
                console.log(item.name);
            })
        }
        ftp.client.end();
    })
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

}

/**
 * @get server files list main
 */
ftp.listMain = function(source, callback) {
    ftp.client.<span class="apidocCodeKeywordSpan">list</span>(source, function(err, list) {
        if (err) {
console.log(&#x27;jdf error [ftp.list] - &#x27; + err);
ftp.client.end();
        } else {

if (list &#x26;&#x26; list.length &#x3e; 0) {
    var filesList = [];
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.widget.pathCheck" id="apidoc.element.jdf.widget.pathCheck">
        function <span class="apidocSignatureSpan">jdf.widget.</span>pathCheck
        <span class="apidocSignatureSpan">(name)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">pathCheck = function (name) {
    if (typeof(name) == &#x27;undefined&#x27;) return true;

<span class="apidocCodeCommentSpan">    /*
    if ( !/^widget\//.test(name) ) {
        console.log(&#x27;jdf error widget name format error&#x27;);
        return true;
    }*/
</span>
    if (!f.exists(&#x27;widget/&#x27; + name)) {
        console.log(&#x27;jdf error widget path is not exists&#x27;);
        return true;
    }

    return false;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @本地预览widget
 * @example  jdf widget -preview widget/header
 * @本地widget中tpl,css,js拼装后html文件放在当前widget中
 */
widget.preview = function(name) {
jdf.bgMkdir();

if (widget.<span class="apidocCodeKeywordSpan">pathCheck</span>(name)) {
    return;
}

var target = &#x27;widget/&#x27; + name;
var widgetname = name;

var core = function() {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.widget.preview" id="apidoc.element.jdf.widget.preview">
        function <span class="apidocSignatureSpan">jdf.widget.</span>preview
        <span class="apidocSignatureSpan">(name)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">preview = function (name) {
    jdf.bgMkdir();

    if (widget.pathCheck(name)) {
        return;
    }

    var target = &#x27;widget/&#x27; + name;
    var widgetname = name;

    var core = function() {
        var result = widget.templete(null, widgetname);
        fs.readdirSync(target).forEach(function(item) {
            if (item &#x26;&#x26; f.excludeFiles(item)) {
                var itemContent = f.read(target + &#x27;/&#x27; + item);

                if ($.is.tpl(item) || $.is.vm(item)) {
                    hasTpl = true;
                    itemContent = itemContent;
                    result = $.placeholder.insertBody(result, itemContent);
                }

                if ($.is.css(item)) {
                    result = $.placeholder.insertHead(result, $.placeholder.cssLink(item));
                }

                if ($.is.js(item)) {
                    result = $.placeholder.insertHead(result, $.placeholder.jsLink(item));
                }
            }
        });

        var indexUrl = target + &#x27;/&#x27; + widgetname + &#x27;.html&#x27;;
        f.write(indexUrl, result);
    }

    core();

    var localServerPort = jdf.config.localServerPort;
    FindPort(localServerPort, function(data) {
        if (!data) {
            console.log(&#x27;Port &#x27; + localServerPort + &#x27; is tack up&#x27;);
            localServerPort += 1000;
            jdf.config.localServerPort = localServerPort;
        }

        Server.init(target + &#x27;/&#x27;, jdf.config.localServerPort);
        Openurl.open(&#x27;http://localhost:&#x27; + jdf.config.localServerPort + &#x27;/&#x27; + widgetname + &#x27;.html&#x27;);
        console.log(&#x27;jdf open you broswer to see it&#x27;);

        //监听
        Node_watch(target, function(widgetname) {
            core();
        });
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
]);
console.log(content.join(&#x27;\n&#x27;));
            }

            if (cmd3) {
if (cmd3 == &#x27;-preview&#x27; || cmd3 == &#x27;-pre&#x27; &#x26;&#x26; hasCmd4()) {
    Log.send(&#x27;widget-preview&#x27;);
    Widget.<span class="apidocCodeKeywordSpan">preview</span>(cmd4);

} else if (cmd3 == &#x27;-install&#x27; || cmd3 == &#x27;-i&#x27; &#x26;&#x26; hasCmd4()) {
    Log.send(&#x27;widget-install&#x27;);
    Widget.install(cmd4, force);

} else if (cmd3 == &#x27;-publish&#x27; || cmd3 == &#x27;-p&#x27; &#x26;&#x26; hasCmd4()) {
    Log.send(&#x27;widget-publish&#x27;);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.widget.publish" id="apidoc.element.jdf.widget.publish">
        function <span class="apidocSignatureSpan">jdf.widget.</span>publish
        <span class="apidocSignatureSpan">(name, force)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">publish = function (name, force) {
    var publishDir = jdf.config.widgetServerDir + &#x27;/widget&#x27;;

    var force = typeof(force) == &#x27;undefined&#x27; ? false : force;
    if (widget.pathCheck(name)) {
        return;
    }

    var cUrl = &#x27;widget/&#x27; + name + &#x27;/&#x27; + &#x27;component.json&#x27;;
    f.readJSON(cUrl, function(data) {
        if (data) {
            var cName = data.name;
            var cVersion = data.version;
            var ftp = require(&#x27;./ftp.js&#x27;);
            var target = publishDir + &#x27;/&#x27; + name + &#x27;/&#x27; + cVersion;
            ftp.mkdir(publishDir + &#x27;/&#x27; + name);

            ftp.list(target, function(data) {
                if (data == &#x27;error&#x27; || force) {
                    ftp.mkdir(publishDir + &#x27;/&#x27; + name + &#x27;/&#x27;);
                    ftp.mkdir(target);

                    ftp.uploadMain(&#x27;widget/&#x27; + name, target, null, null, null, null, null, function(err) {
                        console.log(&#x27;jdf widget &#x22;&#x27; + &#x27;&#x27; + name + &#x27;/&#x27; + cVersion + &#x27;&#x22; publish done!&#x27;);
                    });
                } else {
                    console.log(&#x27;jdf warnning &#x22;&#x27; + name + &#x27;/&#x27; + cVersion + &#x27;&#x22; is exists in server&#x27;);
                }
            });
        }
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

    } else if (cmd3 == &#x27;-install&#x27; || cmd3 == &#x27;-i&#x27; &#x26;&#x26; hasCmd4()) {
        Log.send(&#x27;widget-install&#x27;);
        Widget.install(cmd4, force);

    } else if (cmd3 == &#x27;-publish&#x27; || cmd3 == &#x27;-p&#x27; &#x26;&#x26; hasCmd4()) {
        Log.send(&#x27;widget-publish&#x27;);
        Widget.<span class="apidocCodeKeywordSpan">publish</span>(cmd4, force);

    } else if ((cmd3 == &#x27;-create&#x27; || cmd3 == &#x27;-c&#x27;) &#x26;&#x26; hasCmd4()) {
        Log.send(&#x27;widget-create&#x27;);
        Widget.create(cmd4);

    }
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.widget.search" id="apidoc.element.jdf.widget.search">
        function <span class="apidocSignatureSpan">jdf.widget.</span>search
        <span class="apidocSignatureSpan">(name)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">search = function (name) {

}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
*/

exports = module.exports = function(source, target, host, argv, callbak){
    var tasks = [];

    source.forEach(function(sourceItem){
var i = sourceItem.replace(jdf.currentDir+&#x27;/&#x27;+jdf.config.outputDirName,&#x27;&#x27;);
if(i.<span class="apidocCodeKeywordSpan">search</span>(&#x22;\\\\&#x22;) != -1){
    i = sourceItem.replace(jdf.currentDir+&#x27;\\&#x27;+jdf.config.outputDirName,&#x27;&#x27;);
}

//只取文件里面的文件
if(argv[3] == &#x27;-custom&#x27; || argv[3] == &#x27;-c&#x27;){
    i = i.replace(argv[4], &#x27;&#x27;)
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.jdf.widget.templete" id="apidoc.element.jdf.widget.templete">
        function <span class="apidocSignatureSpan">jdf.widget.</span>templete
        <span class="apidocSignatureSpan">(str, title)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">templete = function (str, title) {
    if (typeof(str) == &#x27;undefined&#x27; || !str) {
        var str = &#x27;&#x27;;
    }

    var css = &#x27;&#x27;;
    jdf.config.widget.css.forEach(function(item) {
        css += &#x27;&#x3c;link rel=&#x22;stylesheet&#x22; type=&#x22;text/css&#x22; href=&#x22;&#x27; + item + &#x27;&#x22; media=&#x22;all&#x22; /&#x3e;\r\n&#x27;;
    })

    var js = &#x27;&#x27;;
    jdf.config.widget.js.forEach(function(item) {
        js += &#x27;&#x3c;script type=&#x22;text/javascript&#x22; src=&#x22;&#x27; + item + &#x27;&#x22;&#x3e;&#x3c;/script&#x3e;\r\n&#x27;;
    })

    return &#x27;&#x3c;!DOCTYPE html&#x3e;&#x27; + &#x27;\r\n&#x27; +
        &#x27;&#x3c;html&#x3e;&#x27; + &#x27;\r\n&#x27; +
        &#x27;&#x3c;head&#x3e;&#x27; + &#x27;\r\n&#x27; +
        &#x27;&#x3c;meta charset=&#x22;utf-8&#x22; /&#x3e;&#x27; + &#x27;\r\n&#x27; +
        &#x27;&#x3c;title&#x3e;&#x27; + title + &#x27;&#x3c;/title&#x3e;&#x27; + &#x27;\r\n&#x27; + css + js +
        &#x27;&#x3c;/head&#x3e;&#x27; + &#x27;\r\n&#x27; +
        &#x27;&#x3c;body&#x3e;&#x27; + &#x27;\r\n&#x27; + str + &#x27;\r\n&#x27; +
        &#x27;&#x3c;/body&#x3e;&#x27; + &#x27;\r\n&#x27; +
        &#x27;&#x3c;/html&#x3e;&#x27;;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    var widgetListHtml = &#x27;&#x27;;
    fs.readdirSync(widgetDir).forEach(function(item) {
        if (f.excludeFiles(item)) {
            widgetListHtml += &#x27;{%widget name=&#x22;&#x27; + item + &#x27;&#x22;%}\r\n&#x27;;
        }
    });

    var result = widget.<span class="apidocCodeKeywordSpan">templete</span>(&#x27;\r\n&#x27; + widgetListHtml, jdf.getProjectPath
() + &#x27; - all widget preview&#x27;);
    f.write(target, result);
}

core();
jdf.argvInit(&#x27;build&#x27;, &#x27;-open&#x27;, function() {
    //todo watch
    //core();
...</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
